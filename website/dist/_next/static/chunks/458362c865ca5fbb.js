(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,64495,(e,t,r)=>{var i,s;s=i||(i={}),function(t){var r="object"==typeof globalThis?globalThis:e.g,i=n(s);function n(e,t){return function(r,i){Object.defineProperty(e,r,{configurable:!0,writable:!0,value:i}),t&&t(r,i)}}void 0!==r.Reflect&&(i=n(r.Reflect,i)),t(i,r),void 0===r.Reflect&&(r.Reflect=s)}(function(e,t){var r,i=Object.prototype.hasOwnProperty,s="function"==typeof Symbol,n=s&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",o=s&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",a="function"==typeof Object.create,l=({__proto__:[]})instanceof Array,c=!a&&!l,u={create:a?function(){return R(Object.create(null))}:l?function(){return R({__proto__:null})}:function(){return R({})},has:c?function(e,t){return i.call(e,t)}:function(e,t){return t in e},get:c?function(e,t){return i.call(e,t)?e[t]:void 0}:function(e,t){return e[t]}},p=Object.getPrototypeOf(Function),d="function"==typeof Map&&"function"==typeof Map.prototype.entries?Map:function(){var e={},t=[],r=function(){function e(e,t,r){this._index=0,this._keys=e,this._values=t,this._selector=r}return e.prototype["@@iterator"]=function(){return this},e.prototype[o]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var r=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();function i(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(i.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),i.prototype.has=function(e){return this._find(e,!1)>=0},i.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},i.prototype.set=function(e,t){var r=this._find(e,!0);return this._values[r]=t,this},i.prototype.delete=function(t){var r=this._find(t,!1);if(r>=0){for(var i=this._keys.length,s=r+1;s<i;s++)this._keys[s-1]=this._keys[s],this._values[s-1]=this._values[s];return this._keys.length--,this._values.length--,E(t,this._cacheKey)&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},i.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},i.prototype.keys=function(){return new r(this._keys,this._values,s)},i.prototype.values=function(){return new r(this._keys,this._values,n)},i.prototype.entries=function(){return new r(this._keys,this._values,a)},i.prototype["@@iterator"]=function(){return this.entries()},i.prototype[o]=function(){return this.entries()},i.prototype._find=function(e,t){if(!E(this._cacheKey,e)){this._cacheIndex=-1;for(var r=0;r<this._keys.length;r++)if(E(this._keys[r],e)){this._cacheIndex=r;break}}return this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},i;function s(e,t){return e}function n(e,t){return t}function a(e,t){return[e,t]}}(),h="function"==typeof Set&&"function"==typeof Set.prototype.entries?Set:function(){function e(){this._map=new d}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.keys()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[o]=function(){return this.keys()},e}(),f="function"==typeof WeakMap?WeakMap:function(){var e=u.create(),t=s();function r(){this._key=s()}return r.prototype.has=function(e){var t=n(e,!1);return void 0!==t&&u.has(t,this._key)},r.prototype.get=function(e){var t=n(e,!1);return void 0!==t?u.get(t,this._key):void 0},r.prototype.set=function(e,t){return n(e,!0)[this._key]=t,this},r.prototype.delete=function(e){var t=n(e,!1);return void 0!==t&&delete t[this._key]},r.prototype.clear=function(){this._key=s()},r;function s(){var t;do t="@@WeakMap@@"+function(){var e=function(e){if("function"==typeof Uint8Array){var t=new Uint8Array(16);return"undefined"!=typeof crypto?crypto.getRandomValues(t):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(t):o(t,16),t}return o(Array(16),16)}(0);e[6]=79&e[6]|64,e[8]=191&e[8]|128;for(var t="",r=0;r<16;++r){var i=e[r];(4===r||6===r||8===r)&&(t+="-"),i<16&&(t+="0"),t+=i.toString(16).toLowerCase()}return t}();while(u.has(e,t))return e[t]=!0,t}function n(e,r){if(!i.call(e,t)){if(!r)return;Object.defineProperty(e,t,{value:u.create()})}return e[t]}function o(e,t){for(var r=0;r<t;++r)e[r]=255*Math.random()|0;return e}}(),y=s?Symbol.for("@reflect-metadata:registry"):void 0,g=(!_(y)&&C(t.Reflect)&&Object.isExtensible(t.Reflect)&&(r=t.Reflect[y]),_(r)&&(r=function(){_(y)||void 0===t.Reflect||y in t.Reflect||"function"!=typeof t.Reflect.defineMetadata||(r=(e=t.Reflect).defineMetadata,i=e.hasOwnMetadata,s=e.getOwnMetadata,n=e.getOwnMetadataKeys,o=e.deleteMetadata,a=new f,l={isProviderFor:function(e,t){var r=a.get(e);return!!(!_(r)&&r.has(t))||!!n(e,t).length&&(_(r)&&(r=new h,a.set(e,r)),r.add(t),!0)},OrdinaryDefineOwnMetadata:r,OrdinaryHasOwnMetadata:i,OrdinaryGetOwnMetadata:s,OrdinaryOwnMetadataKeys:n,OrdinaryDeleteMetadata:o});var e,r,i,s,n,o,a,l,c,u,p,g=new f,m={registerProvider:function(e){if(!Object.isExtensible(m))throw Error("Cannot add provider to a frozen registry.");switch(!0){case l===e:break;case _(c):c=e;break;case c===e:break;case _(u):u=e;break;case u===e:break;default:void 0===p&&(p=new h),p.add(e)}},getProvider:v,setProvider:function(e,t,r){if(!function(e){if(_(e))throw TypeError();return c===e||u===e||!_(p)&&p.has(e)}(r))throw Error("Metadata provider not registered.");var i=v(e,t);if(i!==r){if(!_(i))return!1;var s=g.get(e);_(s)&&(s=new d,g.set(e,s)),s.set(t,r)}return!0}};return m;function v(e,t){var r,i=g.get(e);return _(i)||(r=i.get(t)),_(r)&&(r=function(e,t){if(!_(c)){if(c.isProviderFor(e,t))return c;if(!_(u)){if(u.isProviderFor(e,t))return c;if(!_(p))for(var r=I(p);;){var i=T(r);if(!i)return;var s=i.value;if(s.isProviderFor(e,t))return P(r),s}}}if(!_(l)&&l.isProviderFor(e,t))return l}(e,t),_(r)||(_(i)&&(i=new d,g.set(e,i)),i.set(t,r))),r}}()),!_(y)&&C(t.Reflect)&&Object.isExtensible(t.Reflect)&&Object.defineProperty(t.Reflect,y,{enumerable:!1,configurable:!1,writable:!1,value:r}),r),m=function(e){var t=new f,r={isProviderFor:function(e,r){var i=t.get(e);return!_(i)&&i.has(r)},OrdinaryDefineOwnMetadata:function(e,t,r,s){i(r,s,!0).set(e,t)},OrdinaryHasOwnMetadata:function(e,t,r){var s=i(t,r,!1);return!_(s)&&!!s.has(e)},OrdinaryGetOwnMetadata:function(e,t,r){var s=i(t,r,!1);if(!_(s))return s.get(e)},OrdinaryOwnMetadataKeys:function(e,t){var r=[],s=i(e,t,!1);if(_(s))return r;for(var n=I(s.keys()),o=0;;){var a=T(n);if(!a)return r.length=o,r;var l=a.value;try{r[o]=l}catch(e){try{P(n)}finally{throw e}}o++}},OrdinaryDeleteMetadata:function(e,r,s){var n=i(r,s,!1);if(_(n)||!n.delete(e))return!1;if(0===n.size){var o=t.get(r);_(o)||(o.delete(s),0===o.size&&t.delete(o))}return!0}};return g.registerProvider(r),r;function i(i,s,n){var o=t.get(i),a=!1;if(_(o)){if(!n)return;o=new d,t.set(i,o),a=!0}var l=o.get(s);if(_(l)){if(!n)return;if(l=new d,o.set(s,l),!e.setProvider(i,s,r))throw o.delete(s),a&&t.delete(i),Error("Wrong provider for target.")}return l}}(g);function v(e,t,r){var i=U(t,r,!1);return!_(i)&&!!i.OrdinaryHasOwnMetadata(e,t,r)}function b(e,t,r){var i=U(t,r,!1);if(!_(i))return i.OrdinaryGetOwnMetadata(e,t,r)}function x(e,t,r,i){U(r,i,!0).OrdinaryDefineOwnMetadata(e,t,r,i)}function S(e,t){var r=U(e,t,!1);return r?r.OrdinaryOwnMetadataKeys(e,t):[]}function w(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function _(e){return void 0===e}function A(e){return null===e}function C(e){return"object"==typeof e?null!==e:"function"==typeof e}e("decorate",function(e,t,r,i){if(_(r)){if(!B(e)||!j(t))throw TypeError();for(var s=e,n=t,o=s.length-1;o>=0;--o){var a=(0,s[o])(n);if(!_(a)&&!A(a)){if(!j(a))throw TypeError();n=a}}return n}if(!B(e)||!C(t)||!C(i)&&!_(i)&&!A(i))throw TypeError();return A(i)&&(i=void 0),function(e,t,r,i){for(var s=e.length-1;s>=0;--s){var n=(0,e[s])(t,r,i);if(!_(n)&&!A(n)){if(!C(n))throw TypeError();i=n}}return i}(e,t,r=k(r),i)}),e("metadata",function(e,t){return function(r,i){if(!C(r)||!_(i)&&!function(e){switch(w(e)){case 3:case 4:return!0;default:return!1}}(i))throw TypeError();x(e,t,r,i)}}),e("defineMetadata",function(e,t,r,i){if(!C(r))throw TypeError();return _(i)||(i=k(i)),x(e,t,r,i)}),e("hasMetadata",function(e,t,r){if(!C(t))throw TypeError();return _(r)||(r=k(r)),function e(t,r,i){if(v(t,r,i))return!0;var s=D(r);return!A(s)&&e(t,s,i)}(e,t,r)}),e("hasOwnMetadata",function(e,t,r){if(!C(t))throw TypeError();return _(r)||(r=k(r)),v(e,t,r)}),e("getMetadata",function(e,t,r){if(!C(t))throw TypeError();return _(r)||(r=k(r)),function e(t,r,i){if(v(t,r,i))return b(t,r,i);var s=D(r);if(!A(s))return e(t,s,i)}(e,t,r)}),e("getOwnMetadata",function(e,t,r){if(!C(t))throw TypeError();return _(r)||(r=k(r)),b(e,t,r)}),e("getMetadataKeys",function(e,t){if(!C(e))throw TypeError();return _(t)||(t=k(t)),function e(t,r){var i=S(t,r),s=D(t);if(null===s)return i;var n=e(s,r);if(n.length<=0)return i;if(i.length<=0)return n;for(var o=new h,a=[],l=0;l<i.length;l++){var c=i[l],u=o.has(c);u||(o.add(c),a.push(c))}for(var p=0;p<n.length;p++){var c=n[p],u=o.has(c);u||(o.add(c),a.push(c))}return a}(e,t)}),e("getOwnMetadataKeys",function(e,t){if(!C(e))throw TypeError();return _(t)||(t=k(t)),S(e,t)}),e("deleteMetadata",function(e,t,r){if(!C(t)||(_(r)||(r=k(r)),!C(t)))throw TypeError();_(r)||(r=k(r));var i=U(t,r,!1);return!_(i)&&i.OrdinaryDeleteMetadata(e,t,r)});function k(e){var t=function(e,t){switch(w(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var r="string",i=O(e,n);if(void 0!==i){var s=i.call(e,r);if(C(s))throw TypeError();return s}return function(e,t){if("string"===t){var r=e.toString;if(N(r)){var i=r.call(e);if(!C(i))return i}var s=e.valueOf;if(N(s)){var i=s.call(e);if(!C(i))return i}}else{var s=e.valueOf;if(N(s)){var i=s.call(e);if(!C(i))return i}var n=e.toString;if(N(n)){var i=n.call(e);if(!C(i))return i}}throw TypeError()}(e,r)}(e,0);return"symbol"==typeof t?t:""+t}function B(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function N(e){return"function"==typeof e}function j(e){return"function"==typeof e}function E(e,t){return e===t||e!=e&&t!=t}function O(e,t){var r=e[t];if(null!=r){if(!N(r))throw TypeError();return r}}function I(e){var t=O(e,o);if(!N(t))throw TypeError();var r=t.call(e);if(!C(r))throw TypeError();return r}function T(e){var t=e.next();return!t.done&&t}function P(e){var t=e.return;t&&t.call(e)}function D(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===p||t!==p)return t;var r=e.prototype,i=r&&Object.getPrototypeOf(r);if(null==i||i===Object.prototype)return t;var s=i.constructor;return"function"!=typeof s||s===e?t:s}function U(e,t,r){var i=g.getProvider(e,t);if(!_(i))return i;if(r){if(g.setProvider(e,t,m))return m;throw Error("Illegal state.")}}function R(e){return e.__=void 0,delete e.__,e}})},92662,(e,t,r)=>{"use strict";var i=e.i(67034);class s{static isArrayBuffer(e){return"[object ArrayBuffer]"===Object.prototype.toString.call(e)}static toArrayBuffer(e){return this.isArrayBuffer(e)?e:e.byteLength===e.buffer.byteLength||0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:this.toUint8Array(e.buffer).slice(e.byteOffset,e.byteOffset+e.byteLength).buffer}static toUint8Array(e){return this.toView(e,Uint8Array)}static toView(e,t){if(e.constructor===t)return e;if(this.isArrayBuffer(e))return new t(e);if(this.isArrayBufferView(e))return new t(e.buffer,e.byteOffset,e.byteLength);throw TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(e){return this.isArrayBufferView(e)||this.isArrayBuffer(e)}static isArrayBufferView(e){return ArrayBuffer.isView(e)||e&&this.isArrayBuffer(e.buffer)}static isEqual(e,t){let r=s.toUint8Array(e),i=s.toUint8Array(t);if(r.length!==i.byteLength)return!1;for(let e=0;e<r.length;e++)if(r[e]!==i[e])return!1;return!0}static concat(...e){let t;t=!Array.isArray(e[0])||e[1]instanceof Function?Array.isArray(e[0])&&e[1]instanceof Function?e[0]:e[e.length-1]instanceof Function?e.slice(0,e.length-1):e:e[0];let r=0;for(let e of t)r+=e.byteLength;let i=new Uint8Array(r),s=0;for(let e of t){let t=this.toUint8Array(e);i.set(t,s),s+=t.length}return e[e.length-1]instanceof Function?this.toView(i,e[e.length-1]):i.buffer}}let n="string",o=/^[0-9a-f\s]+$/i,a=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,l=/^[a-zA-Z0-9-_]+$/;class c{static fromString(e){let t=unescape(encodeURIComponent(e)),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r.buffer}static toString(e){let t=s.toUint8Array(e),r="";for(let e=0;e<t.length;e++)r+=String.fromCharCode(t[e]);return decodeURIComponent(escape(r))}}class u{static toString(e,t=!1){let r=s.toArrayBuffer(e),i=new DataView(r),n="";for(let e=0;e<r.byteLength;e+=2)n+=String.fromCharCode(i.getUint16(e,t));return n}static fromString(e,t=!1){let r=new ArrayBuffer(2*e.length),i=new DataView(r);for(let r=0;r<e.length;r++)i.setUint16(2*r,e.charCodeAt(r),t);return r}}class p{static isHex(e){return typeof e===n&&o.test(e)}static isBase64(e){return typeof e===n&&a.test(e)}static isBase64Url(e){return typeof e===n&&l.test(e)}static ToString(e,t="utf8"){let r=s.toUint8Array(e);switch(t.toLowerCase()){case"utf8":return this.ToUtf8String(r);case"binary":return this.ToBinary(r);case"hex":return this.ToHex(r);case"base64":return this.ToBase64(r);case"base64url":return this.ToBase64Url(r);case"utf16le":return u.toString(r,!0);case"utf16":case"utf16be":return u.toString(r);default:throw Error(`Unknown type of encoding '${t}'`)}}static FromString(e,t="utf8"){if(!e)return new ArrayBuffer(0);switch(t.toLowerCase()){case"utf8":return this.FromUtf8String(e);case"binary":return this.FromBinary(e);case"hex":return this.FromHex(e);case"base64":return this.FromBase64(e);case"base64url":return this.FromBase64Url(e);case"utf16le":return u.fromString(e,!0);case"utf16":case"utf16be":return u.fromString(e);default:throw Error(`Unknown type of encoding '${t}'`)}}static ToBase64(e){let t=s.toUint8Array(e);return"undefined"!=typeof btoa?btoa(this.ToString(t,"binary")):i.Buffer.from(t).toString("base64")}static FromBase64(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!p.isBase64(t))throw TypeError("Argument 'base64Text' is not Base64 encoded");return"undefined"!=typeof atob?this.FromBinary(atob(t)):new Uint8Array(i.Buffer.from(t,"base64")).buffer}static FromBase64Url(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!p.isBase64Url(t))throw TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(t.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(e){return this.ToBase64(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(e,t=p.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.FromBinary(e);case"utf8":return c.fromString(e);case"utf16":case"utf16be":return u.fromString(e);case"utf16le":case"usc2":return u.fromString(e,!0);default:throw Error(`Unknown type of encoding '${t}'`)}}static ToUtf8String(e,t=p.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.ToBinary(e);case"utf8":return c.toString(e);case"utf16":case"utf16be":return u.toString(e);case"utf16le":case"usc2":return u.toString(e,!0);default:throw Error(`Unknown type of encoding '${t}'`)}}static FromBinary(e){let t=e.length,r=new Uint8Array(t);for(let i=0;i<t;i++)r[i]=e.charCodeAt(i);return r.buffer}static ToBinary(e){let t=s.toUint8Array(e),r="";for(let e=0;e<t.length;e++)r+=String.fromCharCode(t[e]);return r}static ToHex(e){let t=s.toUint8Array(e),r="",i=t.length;for(let e=0;e<i;e++){let i=t[e];i<16&&(r+="0"),r+=i.toString(16)}return r}static FromHex(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!p.isHex(t))throw TypeError("Argument 'hexString' is not HEX encoded");t.length%2&&(t=`0${t}`);let r=new Uint8Array(t.length/2);for(let e=0;e<t.length;e+=2){let i=t.slice(e,e+2);r[e/2]=parseInt(i,16)}return r.buffer}static ToUtf16String(e,t=!1){return u.toString(e,t)}static FromUtf16String(e,t=!1){return u.fromString(e,t)}static Base64Padding(e){let t=4-e.length%4;if(t<4)for(let r=0;r<t;r++)e+="=";return e}static formatString(e){return(null==e?void 0:e.replace(/[\n\r\t ]/g,""))||""}}p.DEFAULT_UTF8_ENCODING="utf8",r.BufferSourceConverter=s,r.Convert=p,r.assign=function(e){let t=arguments[0];for(let e=1;e<arguments.length;e++){let r=arguments[e];for(let e in r)t[e]=r[e]}return t},r.combine=function(...e){let t=new Uint8Array(e.map(e=>e.byteLength).reduce((e,t)=>e+t)),r=0;return e.map(e=>new Uint8Array(e)).forEach(e=>{for(let i of e)t[r++]=i}),t.buffer},r.isEqual=function(e,t){if(!(e&&t)||e.byteLength!==t.byteLength)return!1;let r=new Uint8Array(e),i=new Uint8Array(t);for(let t=0;t<e.byteLength;t++)if(r[t]!==i[t])return!1;return!0}},88598,e=>{"use strict";let t,r;var i,s,n,o,a,l,c,u,p,d,h,f,y,g,m,v,b,x,S,w,_,A,C,k,B,N,j,E,O,I,T,P,D,U,R,V,L,M,H,F,$,z,K,W,q,G,J,Y,Z,X,Q,ee,et,er,ei,es,en,eo,ea,el,ec,eu,ep,ed,eh,ef,ey,eg,em,ev,eb,ex,eS,ew,e_,eA,eC,ek,eB,eN,ej,eE,eO,eI,eT,eP,eD,eU,eR,eV=e.i(43476),eL=e.i(83086),eM=e.i(79223),eH=e.i(71645),eF=e.i(78631),e$=e.i(40160),ez=e.i(74886),eK=e.i(43531),eW=e.i(75254);let eq=(0,eW.default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),eG=(0,eW.default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);var eJ=e.i(82458),eJ=eJ;let eY=(0,eW.default)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),eZ=(0,eW.default)("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]),eX=(0,eW.default)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),eQ=(0,eW.default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),e0=(0,eW.default)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var e1=e.i(67881),e2=e.i(23750),e4=e.i(10708),e8=e.i(62870),e5=e.i(27341),e6=e.i(70065),e3=e.i(94179),e9=e.i(69035),e7=e.i(81140),te=e.i(20783),tt=e.i(10772),tr=e.i(69340),ti=e.i(26330),ts=e.i(65491),tn=e.i(74606),to=e.i(96626);function ta(e){var t;let r,i=(t=e,(r=eH.forwardRef((e,t)=>{let{children:r,...i}=e;if(eH.isValidElement(r)){var s;let e,n,o=(s=r,(n=(e=Object.getOwnPropertyDescriptor(s.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?s.ref:(n=(e=Object.getOwnPropertyDescriptor(s,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?s.props.ref:s.props.ref||s.ref),a=function(e,t){let r={...t};for(let i in t){let s=e[i],n=t[i];/^on[A-Z]/.test(i)?s&&n?r[i]=(...e)=>{let t=n(...e);return s(...e),t}:s&&(r[i]=s):"style"===i?r[i]={...s,...n}:"className"===i&&(r[i]=[s,n].filter(Boolean).join(" "))}return{...e,...r}}(i,r.props);return r.type!==eH.Fragment&&(a.ref=t?(0,te.composeRefs)(t,o):o),eH.cloneElement(r,a)}return eH.Children.count(r)>1?eH.Children.only(null):null})).displayName=`${t}.SlotClone`,r),s=eH.forwardRef((e,t)=>{let{children:r,...s}=e,n=eH.Children.toArray(r),o=n.find(tc);if(o){let e=o.props.children,r=n.map(t=>t!==o?t:eH.Children.count(e)>1?eH.Children.only(null):eH.isValidElement(e)?e.props.children:null);return(0,eV.jsx)(i,{...s,ref:t,children:eH.isValidElement(e)?eH.cloneElement(e,void 0,r):null})}return(0,eV.jsx)(i,{...s,ref:t,children:r})});return s.displayName=`${e}.Slot`,s}e.i(74080);var tl=Symbol("radix.slottable");function tc(e){return eH.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===tl}var tu=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=ta(`Primitive.${t}`),i=eH.forwardRef((e,i)=>{let{asChild:s,...n}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,eV.jsx)(s?r:t,{...n,ref:i})});return i.displayName=`Primitive.${t}`,{...e,[t]:i}},{}),tp=e.i(3536),td=e.i(85369),th=e.i(86312),tf="Dialog",[ty,tg]=function(e,t=[]){let r=[],i=()=>{let t=r.map(e=>eH.createContext(e));return function(r){let i=r?.[e]||t;return eH.useMemo(()=>({[`__scope${e}`]:{...r,[e]:i}}),[r,i])}};return i.scopeName=e,[function(t,i){let s=eH.createContext(i),n=r.length;r=[...r,i];let o=t=>{let{scope:r,children:i,...o}=t,a=r?.[e]?.[n]||s,l=eH.useMemo(()=>o,Object.values(o));return(0,eV.jsx)(a.Provider,{value:l,children:i})};return o.displayName=t+"Provider",[o,function(r,o){let a=o?.[e]?.[n]||s,l=eH.useContext(a);if(l)return l;if(void 0!==i)return i;throw Error(`\`${r}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let i=r.reduce((t,{useScope:r,scopeName:i})=>{let s=r(e)[`__scope${i}`];return{...t,...s}},{});return eH.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return r.scopeName=t.scopeName,r}(i,...t)]}(tf),[tm,tv]=ty(tf),tb=e=>{let{__scopeDialog:t,children:r,open:i,defaultOpen:s,onOpenChange:n,modal:o=!0}=e,a=eH.useRef(null),l=eH.useRef(null),[c,u]=(0,tr.useControllableState)({prop:i,defaultProp:s??!1,onChange:n,caller:tf});return(0,eV.jsx)(tm,{scope:t,triggerRef:a,contentRef:l,contentId:(0,tt.useId)(),titleId:(0,tt.useId)(),descriptionId:(0,tt.useId)(),open:c,onOpenChange:u,onOpenToggle:eH.useCallback(()=>u(e=>!e),[u]),modal:o,children:r})};tb.displayName=tf;var tx="DialogTrigger";eH.forwardRef((e,t)=>{let{__scopeDialog:r,...i}=e,s=tv(tx,r),n=(0,te.useComposedRefs)(t,s.triggerRef);return(0,eV.jsx)(tu.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":tM(s.open),...i,ref:n,onClick:(0,e7.composeEventHandlers)(e.onClick,s.onOpenToggle)})}).displayName=tx;var tS="DialogPortal",[tw,t_]=ty(tS,{forceMount:void 0}),tA=e=>{let{__scopeDialog:t,forceMount:r,children:i,container:s}=e,n=tv(tS,t);return(0,eV.jsx)(tw,{scope:t,forceMount:r,children:eH.Children.map(i,e=>(0,eV.jsx)(to.Presence,{present:r||n.open,children:(0,eV.jsx)(tn.Portal,{asChild:!0,container:s,children:e})}))})};tA.displayName=tS;var tC="DialogOverlay",tk=eH.forwardRef((e,t)=>{let r=t_(tC,e.__scopeDialog),{forceMount:i=r.forceMount,...s}=e,n=tv(tC,e.__scopeDialog);return n.modal?(0,eV.jsx)(to.Presence,{present:i||n.open,children:(0,eV.jsx)(tN,{...s,ref:t})}):null});tk.displayName=tC;var tB=ta("DialogOverlay.RemoveScroll"),tN=eH.forwardRef((e,t)=>{let{__scopeDialog:r,...i}=e,s=tv(tC,r);return(0,eV.jsx)(td.RemoveScroll,{as:tB,allowPinchZoom:!0,shards:[s.contentRef],children:(0,eV.jsx)(tu.div,{"data-state":tM(s.open),...i,ref:t,style:{pointerEvents:"auto",...i.style}})})}),tj="DialogContent",tE=eH.forwardRef((e,t)=>{let r=t_(tj,e.__scopeDialog),{forceMount:i=r.forceMount,...s}=e,n=tv(tj,e.__scopeDialog);return(0,eV.jsx)(to.Presence,{present:i||n.open,children:n.modal?(0,eV.jsx)(tO,{...s,ref:t}):(0,eV.jsx)(tI,{...s,ref:t})})});tE.displayName=tj;var tO=eH.forwardRef((e,t)=>{let r=tv(tj,e.__scopeDialog),i=eH.useRef(null),s=(0,te.useComposedRefs)(t,r.contentRef,i);return eH.useEffect(()=>{let e=i.current;if(e)return(0,th.hideOthers)(e)},[]),(0,eV.jsx)(tT,{...e,ref:s,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:(0,e7.composeEventHandlers)(e.onCloseAutoFocus,e=>{e.preventDefault(),r.triggerRef.current?.focus()}),onPointerDownOutside:(0,e7.composeEventHandlers)(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,r=0===t.button&&!0===t.ctrlKey;(2===t.button||r)&&e.preventDefault()}),onFocusOutside:(0,e7.composeEventHandlers)(e.onFocusOutside,e=>e.preventDefault())})}),tI=eH.forwardRef((e,t)=>{let r=tv(tj,e.__scopeDialog),i=eH.useRef(!1),s=eH.useRef(!1);return(0,eV.jsx)(tT,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{e.onCloseAutoFocus?.(t),t.defaultPrevented||(i.current||r.triggerRef.current?.focus(),t.preventDefault()),i.current=!1,s.current=!1},onInteractOutside:t=>{e.onInteractOutside?.(t),t.defaultPrevented||(i.current=!0,"pointerdown"===t.detail.originalEvent.type&&(s.current=!0));let n=t.target;r.triggerRef.current?.contains(n)&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&s.current&&t.preventDefault()}})}),tT=eH.forwardRef((e,t)=>{let{__scopeDialog:r,trapFocus:i,onOpenAutoFocus:s,onCloseAutoFocus:n,...o}=e,a=tv(tj,r),l=eH.useRef(null),c=(0,te.useComposedRefs)(t,l);return(0,tp.useFocusGuards)(),(0,eV.jsxs)(eV.Fragment,{children:[(0,eV.jsx)(ts.FocusScope,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:s,onUnmountAutoFocus:n,children:(0,eV.jsx)(ti.DismissableLayer,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":tM(a.open),...o,ref:c,onDismiss:()=>a.onOpenChange(!1)})}),(0,eV.jsxs)(eV.Fragment,{children:[(0,eV.jsx)(tz,{titleId:a.titleId}),(0,eV.jsx)(tK,{contentRef:l,descriptionId:a.descriptionId})]})]})}),tP="DialogTitle",tD=eH.forwardRef((e,t)=>{let{__scopeDialog:r,...i}=e,s=tv(tP,r);return(0,eV.jsx)(tu.h2,{id:s.titleId,...i,ref:t})});tD.displayName=tP;var tU="DialogDescription",tR=eH.forwardRef((e,t)=>{let{__scopeDialog:r,...i}=e,s=tv(tU,r);return(0,eV.jsx)(tu.p,{id:s.descriptionId,...i,ref:t})});tR.displayName=tU;var tV="DialogClose",tL=eH.forwardRef((e,t)=>{let{__scopeDialog:r,...i}=e,s=tv(tV,r);return(0,eV.jsx)(tu.button,{type:"button",...i,ref:t,onClick:(0,e7.composeEventHandlers)(e.onClick,()=>s.onOpenChange(!1))})});function tM(e){return e?"open":"closed"}tL.displayName=tV;var tH="DialogTitleWarning",[tF,t$]=(i={contentName:tj,titleName:tP,docsSlug:"dialog"},t=eH.createContext(i),(r=e=>{let{children:r,...i}=e,s=eH.useMemo(()=>i,Object.values(i));return(0,eV.jsx)(t.Provider,{value:s,children:r})}).displayName=tH+"Provider",[r,function(e){let r=eH.useContext(t);if(r)return r;if(void 0!==i)return i;throw Error(`\`${e}\` must be used within \`${tH}\``)}]),tz=({titleId:e})=>{let t=t$(tH),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return eH.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},tK=({contentRef:e,descriptionId:t})=>{let r=t$("DialogDescriptionWarning"),i=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${r.contentName}}.`;return eH.useEffect(()=>{let r=e.current?.getAttribute("aria-describedby");t&&r&&(document.getElementById(t)||console.warn(i))},[i,e,t]),null},tW=e.i(41947),tW=tW,tq=e.i(47163);function tG({...e}){return(0,eV.jsx)(tb,{"data-slot":"dialog",...e})}function tJ({...e}){return(0,eV.jsx)(tA,{"data-slot":"dialog-portal",...e})}function tY({className:e,...t}){return(0,eV.jsx)(tk,{"data-slot":"dialog-overlay",className:(0,tq.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function tZ({className:e,children:t,showCloseButton:r=!0,...i}){return(0,eV.jsxs)(tJ,{"data-slot":"dialog-portal",children:[(0,eV.jsx)(tY,{}),(0,eV.jsxs)(tE,{"data-slot":"dialog-content",className:(0,tq.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...i,children:[t,r&&(0,eV.jsxs)(tL,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,eV.jsx)(tW.default,{}),(0,eV.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function tX({className:e,...t}){return(0,eV.jsx)("div",{"data-slot":"dialog-header",className:(0,tq.cn)("flex flex-col gap-2 text-center sm:text-left",e),...t})}function tQ({className:e,...t}){return(0,eV.jsx)(tD,{"data-slot":"dialog-title",className:(0,tq.cn)("text-lg leading-none font-semibold",e),...t})}function t0({className:e,...t}){return(0,eV.jsx)(tR,{"data-slot":"dialog-description",className:(0,tq.cn)("text-muted-foreground text-sm",e),...t})}var t1=e.i(46696);let t2={commonName:"",organization:"",organizationalUnit:"",country:"",state:"",locality:"",email:""},t4={algorithm:"RSA",rsaKeySize:"2048",ecdsaCurve:"P-256",signingAlgorithm:"SHA-256"},t8={days:365,customStartDate:"",customEndDate:"",useCustomDates:!1},t5={digitalSignature:!0,keyEncipherment:!0,dataEncipherment:!1,keyAgreement:!1,keyCertSign:!1,crlSign:!1},t6={serverAuth:!0,clientAuth:!1,codeSigning:!1,emailProtection:!1},t3={isCA:!1,pathLengthConstraint:null},t9={certFormat:"pem",keyFormat:"pkcs8",keyPassphrase:"",includeChain:!1},t7={webServer:{label:"Web Server",description:"TLS server authentication"},rootCA:{label:"Root CA",description:"Certificate Authority"},clientCert:{label:"Client Certificate",description:"TLS client authentication"},wildcard:{label:"Wildcard",description:"*.domain.com wildcard certificate"},custom:{label:"Custom",description:"Configure all options manually"}},re=[{code:"US",name:"United States"},{code:"GB",name:"United Kingdom"},{code:"DE",name:"Germany"},{code:"FR",name:"France"},{code:"CA",name:"Canada"},{code:"AU",name:"Australia"},{code:"JP",name:"Japan"},{code:"CN",name:"China"},{code:"IN",name:"India"},{code:"BR",name:"Brazil"},{code:"NL",name:"Netherlands"},{code:"SE",name:"Sweden"},{code:"CH",name:"Switzerland"},{code:"SG",name:"Singapore"},{code:"KR",name:"South Korea"}],rt={webServer:{keyUsage:{digitalSignature:!0,keyEncipherment:!0,dataEncipherment:!1,keyAgreement:!1,keyCertSign:!1,crlSign:!1},extKeyUsage:{serverAuth:!0,clientAuth:!1,codeSigning:!1,emailProtection:!1},caSettings:{isCA:!1,pathLengthConstraint:null},validityDays:365,rsaKeySize:"2048"},rootCA:{keyUsage:{digitalSignature:!0,keyEncipherment:!1,dataEncipherment:!1,keyAgreement:!1,keyCertSign:!0,crlSign:!0},extKeyUsage:{serverAuth:!1,clientAuth:!1,codeSigning:!1,emailProtection:!1},caSettings:{isCA:!0,pathLengthConstraint:null},validityDays:3650,rsaKeySize:"4096"},clientCert:{keyUsage:{digitalSignature:!0,keyEncipherment:!0,dataEncipherment:!1,keyAgreement:!1,keyCertSign:!1,crlSign:!1},extKeyUsage:{serverAuth:!1,clientAuth:!0,codeSigning:!1,emailProtection:!0},caSettings:{isCA:!1,pathLengthConstraint:null},validityDays:365,rsaKeySize:"2048"},wildcard:{keyUsage:{digitalSignature:!0,keyEncipherment:!0,dataEncipherment:!1,keyAgreement:!1,keyCertSign:!1,crlSign:!1},extKeyUsage:{serverAuth:!0,clientAuth:!1,codeSigning:!1,emailProtection:!1},caSettings:{isCA:!1,pathLengthConstraint:null},validityDays:365},custom:{keyUsage:{digitalSignature:!1,keyEncipherment:!1,dataEncipherment:!1,keyAgreement:!1,keyCertSign:!1,crlSign:!1},extKeyUsage:{serverAuth:!1,clientAuth:!1,codeSigning:!1,emailProtection:!1},caSettings:{isCA:!1,pathLengthConstraint:null},validityDays:365}};function rr(e){return e.replace(/\\/g,"\\\\").replace(/,/g,"\\,").replace(/\+/g,"\\+").replace(/"/g,'\\"').replace(/</g,"\\<").replace(/>/g,"\\>").replace(/;/g,"\\;")}function ri(e){return"ECDSA"===e.algorithm?{name:"ECDSA",namedCurve:e.ecdsaCurve}:{name:"RSASSA-PKCS1-v1_5",modulusLength:parseInt(e.rsaKeySize),publicExponent:new Uint8Array([1,0,1]),hash:e.signingAlgorithm}}function rs(e){let t=new Uint8Array(e),r="";for(let e=0;e<t.byteLength;e++)r+=String.fromCharCode(t[e]);return btoa(r)}function rn(e,t){let r=e.match(/.{1,64}/g)||[];return`-----BEGIN ${t}-----
${r.join("\n")}
-----END ${t}-----`}function ro(e){return!!e&&"string"==typeof e&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function ra(e){var t,r;return e.commonName&&e.commonName.trim()?(t=e.commonName)&&"string"==typeof t&&t.trim().length>0&&t.length<=64?e.email&&!ro(e.email)?{valid:!1,error:"Invalid email address format"}:e.country&&!(!(r=e.country)||/^[A-Z]{2}$/.test(r))?{valid:!1,error:"Country code must be exactly 2 uppercase letters (e.g., US, GB)"}:{valid:!0}:{valid:!1,error:"Common Name must be between 1-64 characters"}:{valid:!1,error:"Common Name (CN) is required"}}function rl(e){for(let t of e){let e=function(e){if(!e.value||!e.value.trim())return{valid:!1,error:"SAN value cannot be empty"};switch(e.type){case"ip":var t,r;if(r=t=e.value,!(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(r)||function(e){if(!e||"string"!=typeof e)return!1;if("::"===e||"::1"===e)return!0;if(!/^[a-fA-F0-9:]+$/.test(e))return!1;let t=e.split("::");if(t.length>2)return!1;let r=t[0]?t[0].split(":"):[],i=t[1]?t[1].split(":"):[];for(let e of[...r,...i].filter(e=>""!==e))if(e.length>4)return!1;return 1===t.length?8===r.length:r.length+i.length<=7}(t)))return{valid:!1,error:`Invalid IP address: ${e.value}`};break;case"email":if(!ro(e.value))return{valid:!1,error:`Invalid email in SAN: ${e.value}`};break;case"dns":if(!function(e){if(!e||"string"!=typeof e)return!1;if("localhost"===e)return!0;if(e.includes("..")||e.startsWith(".")||e.includes("_"))return!1;let t=e;e.startsWith("*.")&&(t=e.substring(2));let r=t.split(".");if(r.length<2)return!1;for(let e of r)if(!e||e.startsWith("-")||e.endsWith("-")||!/^[a-zA-Z0-9-]+$/.test(e))return!1;return!0}(e.value))return{valid:!1,error:`Invalid DNS domain in SAN: ${e.value}`}}return{valid:!0}}(t);if(!e.valid)return e}return{valid:!0}}function rc(e){if(e.useCustomDates){if(!e.customStartDate||!e.customEndDate)return{valid:!1,error:"Both start and end dates are required when using custom dates"};let t=new Date(e.customStartDate),r=new Date(e.customEndDate);if(isNaN(t.getTime()))return{valid:!1,error:"Invalid start date format"};if(isNaN(r.getTime()))return{valid:!1,error:"Invalid end date format"};if(r<=t)return{valid:!1,error:"End date must be after start date"}}else{if(!e.days||e.days<1)return{valid:!1,error:"Validity must be at least 1 day"};if(e.days>7300)return{valid:!1,error:"Validity cannot exceed 7300 days (20 years)"}}return{valid:!0}}e.i(64495);var ru=e.i(92662);function rp(e,t){let r=0;if(1===e.length)return e[0];for(let i=e.length-1;i>=0;i--)r+=e[e.length-1-i]*Math.pow(2,t*i);return r}function rd(e,t,r=-1){let i=e,s=0,n=Math.pow(2,t);for(let o=1;o<8;o++){if(e<n){let e;if(r<0)e=new ArrayBuffer(o),s=o;else{if(r<o)return new ArrayBuffer(0);e=new ArrayBuffer(r),s=r}let n=new Uint8Array(e);for(let e=o-1;e>=0;e--){let r=Math.pow(2,e*t);n[s-e-1]=Math.floor(i/r),i-=n[s-e-1]*r}return e}n*=Math.pow(2,t)}return new ArrayBuffer(0)}function rh(...e){let t=0,r=0;for(let r of e)t+=r.length;let i=new Uint8Array(new ArrayBuffer(t));for(let t of e)i.set(t,r),r+=t.length;return i}function rf(){let e=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){let t=255===e[0]&&128&e[1],r=0===e[0]&&(128&e[1])==0;(t||r)&&this.warnings.push("Needlessly long format")}let t=new Uint8Array(new ArrayBuffer(this.valueHex.byteLength));for(let e=0;e<this.valueHex.byteLength;e++)t[e]=0;t[0]=128&e[0];let r=rp(t,8),i=new Uint8Array(new ArrayBuffer(this.valueHex.byteLength));for(let t=0;t<this.valueHex.byteLength;t++)i[t]=e[t];return i[0]&=127,rp(i,8)-r}function ry(e,t){let r=e.toString(10);if(t<r.length)return"";let i=t-r.length,s=Array(i);for(let e=0;e<i;e++)s[e]="0";return s.join("").concat(r)}function rg(){if("undefined"==typeof BigInt)throw Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function rm(e){let t=0,r=0;for(let r=0;r<e.length;r++)t+=e[r].byteLength;let i=new Uint8Array(t);for(let t=0;t<e.length;t++){let s=e[t];i.set(new Uint8Array(s),r),r+=s.byteLength}return i.buffer}function rv(e,t,r,i){return t instanceof Uint8Array?t.byteLength?r<0?(e.error="Wrong parameter: inputOffset less than zero",!1):i<0?(e.error="Wrong parameter: inputLength less than zero",!1):!(t.byteLength-r-i<0)||(e.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1):(e.error="Wrong parameter: inputBuffer has zero length",!1):(e.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}class rb{constructor(){this.items=[]}write(e){this.items.push(e)}final(){return rm(this.items)}}let rx=[new Uint8Array([1])],rS="0123456789",rw="name",r_="valueHexView",rA=new ArrayBuffer(0),rC=new Uint8Array(0),rk="EndOfContent",rB="OCTET STRING",rN="BIT STRING";function rj(e){var t;return(t=class extends e{get valueHex(){return this.valueHexView.slice().buffer}set valueHex(e){this.valueHexView=new Uint8Array(e)}constructor(...e){var t;super(...e);const r=e[0]||{};this.isHexOnly=null!=(t=r.isHexOnly)&&t,this.valueHexView=r.valueHex?ru.BufferSourceConverter.toUint8Array(r.valueHex):rC}fromBER(e,t,r){let i=e instanceof ArrayBuffer?new Uint8Array(e):e;if(!rv(this,i,t,r))return -1;let s=t+r;return(this.valueHexView=i.subarray(t,s),this.valueHexView.length)?(this.blockLength=r,s):(this.warnings.push("Zero buffer length"),t)}toBER(e=!1){return this.isHexOnly?e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",rA)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:ru.Convert.ToHex(this.valueHexView)}}}).NAME="hexBlock",t}class rE{static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(e){this.valueBeforeDecodeView=new Uint8Array(e)}constructor({blockLength:e=0,error:t="",warnings:r=[],valueBeforeDecode:i=rC}={}){this.blockLength=e,this.error=t,this.warnings=r,this.valueBeforeDecodeView=ru.BufferSourceConverter.toUint8Array(i)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:ru.Convert.ToHex(this.valueBeforeDecodeView)}}}rE.NAME="baseBlock";class rO extends rE{fromBER(e,t,r){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(e,t){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}rO.NAME="valueBlock";class rI extends rj(rE){constructor({idBlock:e={}}={}){var t,r,i,s;super(),e?(this.isHexOnly=null!=(t=e.isHexOnly)&&t,this.valueHexView=e.valueHex?ru.BufferSourceConverter.toUint8Array(e.valueHex):rC,this.tagClass=null!=(r=e.tagClass)?r:-1,this.tagNumber=null!=(i=e.tagNumber)?i:-1,this.isConstructed=null!=(s=e.isConstructed)&&s):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(e=!1){let t=0;switch(this.tagClass){case 1:t|=0;break;case 2:t|=64;break;case 3:t|=128;break;case 4:t|=192;break;default:return this.error="Unknown tag class",rA}if(this.isConstructed&&(t|=32),this.tagNumber<31&&!this.isHexOnly){let r=new Uint8Array(1);if(!e){let e=this.tagNumber;e&=31,t|=e,r[0]=t}return r.buffer}if(!this.isHexOnly){let r=rd(this.tagNumber,7),i=new Uint8Array(r),s=r.byteLength,n=new Uint8Array(s+1);if(n[0]=31|t,!e){for(let e=0;e<s-1;e++)n[e+1]=128|i[e];n[s]=i[s-1]}return n.buffer}let r=new Uint8Array(this.valueHexView.byteLength+1);if(r[0]=31|t,!e){let e=this.valueHexView;for(let t=0;t<e.length-1;t++)r[t+1]=128|e[t];r[this.valueHexView.byteLength]=e[e.length-1]}return r.buffer}fromBER(e,t,r){let i=ru.BufferSourceConverter.toUint8Array(e);if(!rv(this,i,t,r))return -1;let s=i.subarray(t,t+r);if(0===s.length)return this.error="Zero buffer length",-1;switch(192&s[0]){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=(32&s[0])==32,this.isHexOnly=!1;let n=31&s[0];if(31!==n)this.tagNumber=n,this.blockLength=1;else{let e=1,t=this.valueHexView=new Uint8Array(255),r=255;for(;128&s[e];){if(t[e-1]=127&s[e],++e>=s.length)return this.error="End of input reached before message was fully decoded",-1;if(e===r){let e=new Uint8Array(r+=255);for(let r=0;r<t.length;r++)e[r]=t[r];t=this.valueHexView=new Uint8Array(r)}}this.blockLength=e+1,t[e-1]=127&s[e];let i=new Uint8Array(e);for(let r=0;r<e;r++)i[r]=t[r];(t=this.valueHexView=new Uint8Array(e)).set(i),this.blockLength<=9?this.tagNumber=rp(t,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}}rI.NAME="identificationBlock";class rT extends rE{constructor({lenBlock:e={}}={}){var t,r,i;super(),this.isIndefiniteForm=null!=(t=e.isIndefiniteForm)&&t,this.longFormUsed=null!=(r=e.longFormUsed)&&r,this.length=null!=(i=e.length)?i:0}fromBER(e,t,r){let i=ru.BufferSourceConverter.toUint8Array(e);if(!rv(this,i,t,r))return -1;let s=i.subarray(t,t+r);if(0===s.length)return this.error="Zero buffer length",-1;if(255===s[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===s[0],this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(128&s[0]),!1===this.longFormUsed)return this.length=s[0],this.blockLength=1,t+this.blockLength;let n=127&s[0];if(n>8)return this.error="Too big integer",-1;if(n+1>s.length)return this.error="End of input reached before message was fully decoded",-1;let o=t+1,a=i.subarray(o,o+n);return 0===a[n-1]&&this.warnings.push("Needlessly long encoded length"),this.length=rp(a,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=n+1,t+this.blockLength}toBER(e=!1){let t,r;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),!1===e&&((r=new Uint8Array(t))[0]=128),t;if(this.longFormUsed){let i=rd(this.length,8);if(i.byteLength>127)return this.error="Too big length",rA;if(t=new ArrayBuffer(i.byteLength+1),e)return t;let s=new Uint8Array(i);(r=new Uint8Array(t))[0]=128|i.byteLength;for(let e=0;e<i.byteLength;e++)r[e+1]=s[e];return t}return t=new ArrayBuffer(1),!1===e&&((r=new Uint8Array(t))[0]=this.length),t}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}}rT.NAME="lengthBlock";let rP={};class rD extends rE{constructor({name:e="",optional:t=!1,primitiveSchema:r,...i}={},s){super(i),this.name=e,this.optional=t,r&&(this.primitiveSchema=r),this.idBlock=new rI(i),this.lenBlock=new rT(i),this.valueBlock=s?new s(i):new rO(i)}fromBER(e,t,r){let i=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return -1===i?this.error=this.valueBlock.error:(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength)),i}toBER(e,t){let r=t||new rb;t||function e(t){var r;if(t instanceof rP.Constructed)for(let r of t.valueBlock.value)e(r)&&(t.lenBlock.isIndefiniteForm=!0);return!!(null==(r=t.lenBlock)?void 0:r.isIndefiniteForm)}(this);let i=this.idBlock.toBER(e);if(r.write(i),this.lenBlock.isIndefiniteForm)r.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(e,r),r.write(new ArrayBuffer(2));else{let t=this.valueBlock.toBER(e);this.lenBlock.length=t.byteLength;let i=this.lenBlock.toBER(e);r.write(i),r.write(t)}return t?rA:r.final()}toJSON(){let e={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}toString(e="ascii"){return"ascii"===e?this.onAsciiEncoding():ru.Convert.ToHex(this.toBER())}onAsciiEncoding(){let e=this.constructor.NAME,t=ru.Convert.ToHex(this.valueBlock.valueBeforeDecodeView);return`${e} : ${t}`}isEqual(e){if(this===e)return!0;if(!(e instanceof this.constructor))return!1;let t=this.toBER(),r=e.toBER();if(t.byteLength!==r.byteLength)return!1;let i=new Uint8Array(t),s=new Uint8Array(r);for(let e=0;e<i.length;e++)if(i[e]!==s[e])return!1;return!0}}rD.NAME="BaseBlock";class rU extends rD{getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}constructor({value:e="",...t}={},r){super(t,r),e&&this.fromString(e)}fromBER(e,t,r){let i=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return -1===i?this.error=this.valueBlock.error:(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength)),i}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}}rU.NAME="BaseStringBlock";class rR extends rj(rO){constructor({isHexOnly:e=!0,...t}={}){super(t),this.isHexOnly=e}}rR.NAME="PrimitiveValueBlock";class rV extends rD{constructor(e={}){super(e,rR),this.idBlock.isConstructed=!1}}function rL(e,t=0,r=e.length){let i=t,s=new rD({},rO),n=new rE;if(!rv(n,e,t,r))return s.error=n.error,{offset:-1,result:s};if(!e.subarray(t,t+r).length)return s.error="Zero buffer length",{offset:-1,result:s};let o=s.idBlock.fromBER(e,t,r);if(s.idBlock.warnings.length&&s.warnings.concat(s.idBlock.warnings),-1===o)return s.error=s.idBlock.error,{offset:-1,result:s};if(t=o,r-=s.idBlock.blockLength,o=s.lenBlock.fromBER(e,t,r),s.lenBlock.warnings.length&&s.warnings.concat(s.lenBlock.warnings),-1===o)return s.error=s.lenBlock.error,{offset:-1,result:s};if(t=o,r-=s.lenBlock.blockLength,!s.idBlock.isConstructed&&s.lenBlock.isIndefiniteForm)return s.error="Indefinite length form used for primitive encoding form",{offset:-1,result:s};let a=rD;if(1===s.idBlock.tagClass){if(s.idBlock.tagNumber>=37&&!1===s.idBlock.isHexOnly)return s.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:s};switch(s.idBlock.tagNumber){case 0:if(s.idBlock.isConstructed&&s.lenBlock.length>0)return s.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:s};a=rP.EndOfContent;break;case 1:a=rP.Boolean;break;case 2:a=rP.Integer;break;case 3:a=rP.BitString;break;case 4:a=rP.OctetString;break;case 5:a=rP.Null;break;case 6:a=rP.ObjectIdentifier;break;case 10:a=rP.Enumerated;break;case 12:a=rP.Utf8String;break;case 13:a=rP.RelativeObjectIdentifier;break;case 14:a=rP.TIME;break;case 15:return s.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:s};case 16:a=rP.Sequence;break;case 17:a=rP.Set;break;case 18:a=rP.NumericString;break;case 19:a=rP.PrintableString;break;case 20:a=rP.TeletexString;break;case 21:a=rP.VideotexString;break;case 22:a=rP.IA5String;break;case 23:a=rP.UTCTime;break;case 24:a=rP.GeneralizedTime;break;case 25:a=rP.GraphicString;break;case 26:a=rP.VisibleString;break;case 27:a=rP.GeneralString;break;case 28:a=rP.UniversalString;break;case 29:a=rP.CharacterString;break;case 30:a=rP.BmpString;break;case 31:a=rP.DATE;break;case 32:a=rP.TimeOfDay;break;case 33:a=rP.DateTime;break;case 34:a=rP.Duration;break;default:{let e=s.idBlock.isConstructed?new rP.Constructed:new rP.Primitive;e.idBlock=s.idBlock,e.lenBlock=s.lenBlock,e.warnings=s.warnings,s=e}}}else a=s.idBlock.isConstructed?rP.Constructed:rP.Primitive;return o=(s=function(e,t){if(e instanceof t)return e;let r=new t;return r.idBlock=e.idBlock,r.lenBlock=e.lenBlock,r.warnings=e.warnings,r.valueBeforeDecodeView=e.valueBeforeDecodeView,r}(s,a)).fromBER(e,t,s.lenBlock.isIndefiniteForm?r:s.lenBlock.length),s.valueBeforeDecodeView=e.subarray(i,i+s.blockLength),{offset:o,result:s}}function rM(e){if(!e.byteLength){let e=new rD({},rO);return e.error="Input buffer has zero length",{offset:-1,result:e}}return rL(ru.BufferSourceConverter.toUint8Array(e).slice(),0,e.byteLength)}rP.Primitive=rV,rV.NAME="PRIMITIVE";class rH extends rO{constructor({value:e=[],isIndefiniteForm:t=!1,...r}={}){super(r),this.value=e,this.isIndefiniteForm=t}fromBER(e,t,r){var i,s;let n=ru.BufferSourceConverter.toUint8Array(e);if(!rv(this,n,t,r))return -1;if(this.valueBeforeDecodeView=n.subarray(t,t+r),0===this.valueBeforeDecodeView.length)return this.warnings.push("Zero buffer length"),t;let o=t;for(;i=this.isIndefiniteForm,s=r,(i?1:s)>0;){let e=rL(n,o,r);if(-1===e.offset)return this.error=e.result.error,this.warnings.concat(e.result.warnings),-1;if(o=e.offset,this.blockLength+=e.result.blockLength,r-=e.result.blockLength,this.value.push(e.result),this.isIndefiniteForm&&e.result.constructor.NAME===rk)break}return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===rk?this.value.pop():this.warnings.push("No EndOfContent block encoded")),o}toBER(e,t){let r=t||new rb;for(let t=0;t<this.value.length;t++)this.value[t].toBER(e,r);return t?rA:r.final()}toJSON(){let e={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(let t of this.value)e.value.push(t.toJSON());return e}}rH.NAME="ConstructedValueBlock";class rF extends rD{constructor(e={}){super(e,rH),this.idBlock.isConstructed=!0}fromBER(e,t,r){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;let i=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return -1===i?this.error=this.valueBlock.error:(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength)),i}onAsciiEncoding(){let e=[];for(let t of this.valueBlock.value)e.push(t.toString("ascii").split("\n").map(e=>`  ${e}`).join("\n"));let t=3===this.idBlock.tagClass?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return e.length?`${t} :
${e.join("\n")}`:`${t} :`}}rP.Constructed=rF,rF.NAME="CONSTRUCTED";class r$ extends rO{fromBER(e,t,r){return t}toBER(e){return rA}}r$.override="EndOfContentValueBlock";class rz extends rD{constructor(e={}){super(e,r$),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}rP.EndOfContent=rz,rz.NAME=rk;class rK extends rD{constructor(e={}){super(e,rO),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(e,t,r){return(this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=r,t+r>e.byteLength)?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):t+r}toBER(e,t){let r=new ArrayBuffer(2);if(!e){let e=new Uint8Array(r);e[0]=5,e[1]=0}return t&&t.write(r),r}onAsciiEncoding(){return`${this.constructor.NAME}`}}rP.Null=rK,rK.NAME="NULL";class rW extends rj(rO){get value(){for(let e of this.valueHexView)if(e>0)return!0;return!1}set value(e){this.valueHexView[0]=255*!!e}constructor({value:e,...t}={}){super(t),t.valueHex?this.valueHexView=ru.BufferSourceConverter.toUint8Array(t.valueHex):this.valueHexView=new Uint8Array(1),e&&(this.value=e)}fromBER(e,t,r){let i=ru.BufferSourceConverter.toUint8Array(e);return rv(this,i,t,r)?(this.valueHexView=i.subarray(t,t+r),r>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,rf.call(this),this.blockLength=r,t+r):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}}rW.NAME="BooleanValueBlock";class rq extends rD{getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}constructor(e={}){super(e,rW),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}}rP.Boolean=rq,rq.NAME="BOOLEAN";class rG extends rj(rH){constructor({isConstructed:e=!1,...t}={}){super(t),this.isConstructed=e}fromBER(e,t,r){let i=0;if(this.isConstructed){if(this.isHexOnly=!1,-1===(i=rH.prototype.fromBER.call(this,e,t,r)))return i;for(let e=0;e<this.value.length;e++){let t=this.value[e].constructor.NAME;if(t===rk)if(!this.isIndefiniteForm)return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1;else break;if(t!==rB)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,i=super.fromBER(e,t,r),this.blockLength=r;return i}toBER(e,t){return this.isConstructed?rH.prototype.toBER.call(this,e,t):e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}}rG.NAME="OctetStringValueBlock";class rJ extends rD{constructor({idBlock:e={},lenBlock:t={},...r}={}){var i;null!=r.isConstructed||(r.isConstructed=!!(null==(i=r.value)?void 0:i.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},rG),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(e,t,r){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===r)return 0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),t;if(!this.valueBlock.isConstructed){let i=(e instanceof ArrayBuffer?new Uint8Array(e):e).subarray(t,t+r);try{if(i.byteLength){let e=rL(i,0,i.byteLength);-1!==e.offset&&e.offset===r&&(this.valueBlock.value=[e.result])}}catch{}}return super.fromBER(e,t,r)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return rF.prototype.onAsciiEncoding.call(this);let e=this.constructor.NAME,t=ru.Convert.ToHex(this.valueBlock.valueHexView);return`${e} : ${t}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;let e=[];for(let t of this.valueBlock.value)t instanceof S&&e.push(t.valueBlock.valueHexView);return ru.BufferSourceConverter.concat(e)}}rP.OctetString=S=rJ,rJ.NAME=rB;class rY extends rj(rH){constructor({unusedBits:e=0,isConstructed:t=!1,...r}={}){super(r),this.unusedBits=e,this.isConstructed=t,this.blockLength=this.valueHexView.byteLength}fromBER(e,t,r){if(!r)return t;let i=-1;if(this.isConstructed){if(-1===(i=rH.prototype.fromBER.call(this,e,t,r)))return i;for(let e of this.value){let t=e.constructor.NAME;if(t===rk)if(!this.isIndefiniteForm)return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1;else break;if(t!==rN)return this.error="BIT STRING may consists of BIT STRINGs only",-1;let r=e.valueBlock;if(this.unusedBits>0&&r.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=r.unusedBits}return i}let s=ru.BufferSourceConverter.toUint8Array(e);if(!rv(this,s,t,r))return -1;let n=s.subarray(t,t+r);if(this.unusedBits=n[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){let e=n.subarray(1);try{if(e.byteLength){let t=rL(e,0,e.byteLength);-1!==t.offset&&t.offset===r-1&&(this.value=[t.result])}}catch{}}return this.valueHexView=n.subarray(1),this.blockLength=n.length,t+r}toBER(e,t){if(this.isConstructed)return rH.prototype.toBER.call(this,e,t);if(e)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return rA;let r=new Uint8Array(this.valueHexView.length+1);return r[0]=this.unusedBits,r.set(this.valueHexView,1),r.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}}rY.NAME="BitStringValueBlock";class rZ extends rD{constructor({idBlock:e={},lenBlock:t={},...r}={}){var i;null!=r.isConstructed||(r.isConstructed=!!(null==(i=r.value)?void 0:i.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},rY),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(e,t,r){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(e,t,r)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return rF.prototype.onAsciiEncoding.call(this);{let e=[];for(let t of this.valueBlock.valueHexView)e.push(t.toString(2).padStart(8,"0"));let t=e.join(""),r=this.constructor.NAME,i=t.substring(0,t.length-this.valueBlock.unusedBits);return`${r} : ${i}`}}}function rX(e){if(e>=rx.length)for(let t=rx.length;t<=e;t++){let e=new Uint8Array([0]),r=rx[t-1].slice(0);for(let t=r.length-1;t>=0;t--){let i=new Uint8Array([(r[t]<<1)+e[0]]);e[0]=i[0]/10,r[t]=i[0]%10}e[0]>0&&(r=rh(e,r)),rx.push(r)}return rx[e]}rP.BitString=rZ,rZ.NAME=rN;class rQ extends rj(rO){setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=rf.call(this)))}constructor({value:e,...t}={}){super(t),this._valueDec=0,t.valueHex&&this.setValueHex(),void 0!==e&&(this.valueDec=e)}set valueDec(e){this._valueDec=e,this.isHexOnly=!1,this.valueHexView=new Uint8Array(function(e){let t=e<0?-1*e:e,r=128;for(let i=1;i<8;i++){if(t<=r){if(e<0){let e=rd(r-t,8,i),s=new Uint8Array(e);return s[0]|=128,e}let s=rd(t,8,i),n=new Uint8Array(s);if(128&n[0]){let e=s.slice(0),t=new Uint8Array(e);n=new Uint8Array(s=new ArrayBuffer(s.byteLength+1));for(let r=0;r<e.byteLength;r++)n[r+1]=t[r];n[0]=0}return s}r*=256}return new ArrayBuffer(0)}(e))}get valueDec(){return this._valueDec}fromDER(e,t,r,i=0){let s=this.fromBER(e,t,r);if(-1===s)return s;let n=this.valueHexView;return 0===n[0]&&(128&n[1])!=0?this.valueHexView=n.subarray(1):0!==i&&n.length<i&&(i-n.length>1&&(i=n.length+1),this.valueHexView=n.subarray(i-n.length)),s}toDER(e=!1){let t=this.valueHexView;switch(!0){case(128&t[0])!=0:{let e=new Uint8Array(this.valueHexView.length+1);e[0]=0,e.set(t,1),this.valueHexView=e}break;case 0===t[0]&&(128&t[1])==0:this.valueHexView=this.valueHexView.subarray(1)}return this.toBER(e)}fromBER(e,t,r){let i=super.fromBER(e,t,r);return -1===i||this.setValueHex(),i}toBER(e){return e?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){let e,t=8*this.valueHexView.length-1,r=new Uint8Array(8*this.valueHexView.length/3),i=0,s=this.valueHexView,n="",o=!1;for(let o=s.byteLength-1;o>=0;o--){e=s[o];for(let s=0;s<8;s++)(1&e)==1&&(i===t?(r=function(e,t){let r,i=0,s=new Uint8Array(e),n=new Uint8Array(t),o=s.slice(0),a=o.length-1,l=n.slice(0),c=l.length-1,u=0;for(let e=c;e>=0;e--,u++)!0==(r=o[a-u]-l[c-u]-i)<0?(i=1,o[a-u]=r+10):(i=0,o[a-u]=r);if(i>0)for(let e=a-c+1;e>=0;e--,u++)if((r=o[a-u]-i)<0)i=1,o[a-u]=r+10;else{i=0,o[a-u]=r;break}return o.slice()}(rX(i),r),n="-"):r=function(e,t){let r=new Uint8Array([0]),i=new Uint8Array(e),s=new Uint8Array(t),n=i.slice(0),o=n.length-1,a=s.slice(0),l=a.length-1,c=0,u=l<o?o:l,p=0;for(let e=u;e>=0;e--,p++)c=!0==p<a.length?n[o-p]+a[l-p]+r[0]:n[o-p]+r[0],r[0]=c/10,!0==p>=n.length?n=rh(new Uint8Array([c%10]),n):n[o-p]=c%10;return r[0]>0&&(n=rh(r,n)),n}(r,rX(i))),i++,e>>=1}for(let e=0;e<r.length;e++)r[e]&&(o=!0),o&&(n+=rS.charAt(r[e]));return!1===o&&(n+=rS.charAt(0)),n}}rQ.NAME="IntegerValueBlock",Object.defineProperty(rQ.prototype,"valueHex",{set:function(e){this.valueHexView=new Uint8Array(e),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});class r0 extends rD{constructor(e={}){super(e,rQ),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return rg(),BigInt(this.valueBlock.toString())}static fromBigInt(e){rg();let t=BigInt(e),r=new rb,i=t.toString(16).replace(/^-/,""),s=new Uint8Array(ru.Convert.FromHex(i));if(t<0){let e=new Uint8Array(s.length+(128&s[0]?1:0));e[0]|=128;let i=BigInt(`0x${ru.Convert.ToHex(e)}`)+t,n=ru.BufferSourceConverter.toUint8Array(ru.Convert.FromHex(i.toString(16)));n[0]|=128,r.write(n)}else 128&s[0]&&r.write(new Uint8Array([0])),r.write(s);return new w({valueHex:r.final()})}convertToDER(){let e=new w({valueHex:this.valueBlock.valueHexView});return e.valueBlock.toDER(),e}convertFromDER(){return new w({valueHex:0===this.valueBlock.valueHexView[0]?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}}rP.Integer=w=r0,r0.NAME="INTEGER";class r1 extends r0{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}rP.Enumerated=r1,r1.NAME="ENUMERATED";class r2 extends rj(rO){constructor({valueDec:e=-1,isFirstSid:t=!1,...r}={}){super(r),this.valueDec=e,this.isFirstSid=t}fromBER(e,t,r){if(!r)return t;let i=ru.BufferSourceConverter.toUint8Array(e);if(!rv(this,i,t,r))return -1;let s=i.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let e=0;e<r&&(this.valueHexView[e]=127&s[e],this.blockLength++,(128&s[e])!=0);e++);let n=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength;e++)n[e]=this.valueHexView[e];return(this.valueHexView=n,(128&s[this.blockLength-1])!=0)?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=rp(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}set valueBigInt(e){rg();let t=BigInt(e).toString(2);for(;t.length%7;)t="0"+t;let r=new Uint8Array(t.length/7);for(let e=0;e<r.length;e++)r[e]=parseInt(t.slice(7*e,7*e+7),2)+128*(e+1<r.length);this.fromBER(r.buffer,0,r.length)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);let t=this.valueHexView,r=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength-1;e++)r[e]=128|t[e];return r[this.blockLength-1]=t[this.blockLength-1],r.buffer}let t=rd(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",rA;let r=new Uint8Array(t.byteLength);if(!e){let e=new Uint8Array(t),i=t.byteLength-1;for(let t=0;t<i;t++)r[t]=128|e[t];r[i]=e[i]}return r}toString(){let e="";if(this.isHexOnly)e=ru.Convert.ToHex(this.valueHexView);else if(this.isFirstSid){let t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}}r2.NAME="sidBlock";class r4 extends rO{constructor({value:e="",...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let i=t;for(;r>0;){let t=new r2;if(-1===(i=t.fromBER(e,i,r))){this.blockLength=0,this.error=t.error;break}0===this.value.length&&(t.isFirstSid=!0),this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return i}toBER(e){let t=[];for(let r=0;r<this.value.length;r++){let i=this.value[r].toBER(e);if(0===i.byteLength)return this.error=this.value[r].error,rA;t.push(i)}return rm(t)}fromString(e){this.value=[];let t=0,r=0,i="",s=!1;do if(i=-1===(r=e.indexOf(".",t))?e.substring(t):e.substring(t,r),t=r+1,s){let e=this.value[0],t=0;switch(e.valueDec){case 0:break;case 1:t=40;break;case 2:t=80;break;default:this.value=[];return}let r=parseInt(i,10);if(isNaN(r))return;e.valueDec=r+t,s=!1}else{let e=new r2;if(i>Number.MAX_SAFE_INTEGER)rg(),e.valueBigInt=BigInt(i);else if(e.valueDec=parseInt(i,10),isNaN(e.valueDec))return;this.value.length||(e.isFirstSid=!0,s=!0),this.value.push(e)}while(-1!==r)}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let i=this.value[r].toString();0!==r&&(e=`${e}.`),t?(i=`{${i}}`,this.value[r].isFirstSid?e=`2.{${i} - 80}`:e+=i):e+=i}return e}toJSON(){let e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}r4.NAME="ObjectIdentifierValueBlock";class r8 extends rD{getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}constructor(e={}){super(e,r4),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}rP.ObjectIdentifier=r8,r8.NAME="OBJECT IDENTIFIER";class r5 extends rj(rE){constructor({valueDec:e=0,...t}={}){super(t),this.valueDec=e}fromBER(e,t,r){if(0===r)return t;let i=ru.BufferSourceConverter.toUint8Array(e);if(!rv(this,i,t,r))return -1;let s=i.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let e=0;e<r&&(this.valueHexView[e]=127&s[e],this.blockLength++,(128&s[e])!=0);e++);let n=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength;e++)n[e]=this.valueHexView[e];return(this.valueHexView=n,(128&s[this.blockLength-1])!=0)?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=rp(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);let t=this.valueHexView,r=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength-1;e++)r[e]=128|t[e];return r[this.blockLength-1]=t[this.blockLength-1],r.buffer}let t=rd(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",rA;let r=new Uint8Array(t.byteLength);if(!e){let e=new Uint8Array(t),i=t.byteLength-1;for(let t=0;t<i;t++)r[t]=128|e[t];r[i]=e[i]}return r.buffer}toString(){return this.isHexOnly?ru.Convert.ToHex(this.valueHexView):this.valueDec.toString()}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}}r5.NAME="relativeSidBlock";class r6 extends rO{constructor({value:e="",...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let i=t;for(;r>0;){let t=new r5;if(-1===(i=t.fromBER(e,i,r))){this.blockLength=0,this.error=t.error;break}this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return i}toBER(e,t){let r=[];for(let t=0;t<this.value.length;t++){let i=this.value[t].toBER(e);if(0===i.byteLength)return this.error=this.value[t].error,rA;r.push(i)}return rm(r)}fromString(e){this.value=[];let t=0,r=0,i="";do{i=-1===(r=e.indexOf(".",t))?e.substring(t):e.substring(t,r),t=r+1;let s=new r5;if(s.valueDec=parseInt(i,10),isNaN(s.valueDec))break;this.value.push(s)}while(-1!==r)return!0}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let i=this.value[r].toString();0!==r&&(e=`${e}.`),t?e+=i=`{${i}}`:e+=i}return e}toJSON(){let e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}r6.NAME="RelativeObjectIdentifierValueBlock";class r3 extends rD{getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}constructor(e={}){super(e,r6),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}rP.RelativeObjectIdentifier=r3,r3.NAME="RelativeObjectIdentifier";class r9 extends rF{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}rP.Sequence=r9,r9.NAME="SEQUENCE";class r7 extends rF{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}}rP.Set=r7,r7.NAME="SET";class ie extends rj(rO){constructor({...e}={}){super(e),this.isHexOnly=!0,this.value=""}toJSON(){return{...super.toJSON(),value:this.value}}}ie.NAME="StringValueBlock";class it extends ie{}it.NAME="SimpleStringValueBlock";class ir extends rU{constructor({...e}={}){super(e,it)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,ru.BufferSourceConverter.toUint8Array(e))}fromString(e){let t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(t);for(let i=0;i<t;i++)r[i]=e.charCodeAt(i);this.valueBlock.value=e}}ir.NAME="SIMPLE STRING";class ii extends ir{fromBuffer(e){this.valueBlock.valueHexView=ru.BufferSourceConverter.toUint8Array(e);try{this.valueBlock.value=ru.Convert.ToUtf8String(e)}catch(t){this.warnings.push(`Error during "decodeURIComponent": ${t}, using raw string`),this.valueBlock.value=ru.Convert.ToBinary(e)}}fromString(e){this.valueBlock.valueHexView=new Uint8Array(ru.Convert.FromUtf8String(e)),this.valueBlock.value=e}}ii.NAME="Utf8StringValueBlock";class is extends ii{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}rP.Utf8String=is,is.NAME="UTF8String";class io extends ir{fromBuffer(e){this.valueBlock.value=ru.Convert.ToUtf16String(e),this.valueBlock.valueHexView=ru.BufferSourceConverter.toUint8Array(e)}fromString(e){this.valueBlock.value=e,this.valueBlock.valueHexView=new Uint8Array(ru.Convert.FromUtf16String(e))}}io.NAME="BmpStringValueBlock";class ia extends io{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}rP.BmpString=ia,ia.NAME="BMPString";class il extends ir{fromBuffer(e){let t=ArrayBuffer.isView(e)?e.slice().buffer:e.slice(0),r=new Uint8Array(t);for(let e=0;e<r.length;e+=4)r[e]=r[e+3],r[e+1]=r[e+2],r[e+2]=0,r[e+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}fromString(e){let t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(4*t);for(let i=0;i<t;i++){let t=new Uint8Array(rd(e.charCodeAt(i),8));if(t.length>4)continue;let s=4-t.length;for(let e=t.length-1;e>=0;e--)r[4*i+e+s]=t[e]}this.valueBlock.value=e}}il.NAME="UniversalStringValueBlock";class ic extends il{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}rP.UniversalString=ic,ic.NAME="UniversalString";class iu extends ir{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}rP.NumericString=iu,iu.NAME="NumericString";class ip extends ir{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}rP.PrintableString=ip,ip.NAME="PrintableString";class id extends ir{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}rP.TeletexString=id,id.NAME="TeletexString";class ih extends ir{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}rP.VideotexString=ih,ih.NAME="VideotexString";class iy extends ir{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}rP.IA5String=iy,iy.NAME="IA5String";class ig extends ir{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}rP.GraphicString=ig,ig.NAME="GraphicString";class im extends ir{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}rP.VisibleString=im,im.NAME="VisibleString";class iv extends ir{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}rP.GeneralString=iv,iv.NAME="GeneralString";class ib extends ir{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}rP.CharacterString=ib,ib.NAME="CharacterString";class ix extends im{constructor({value:e,valueDate:t,...r}={}){if(super(r),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,e){this.fromString(e),this.valueBlock.valueHexView=new Uint8Array(e.length);for(let t=0;t<e.length;t++)this.valueBlock.valueHexView[t]=e.charCodeAt(t)}t&&(this.fromDate(t),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,ru.BufferSourceConverter.toUint8Array(e)))}toBuffer(){let e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(e){let t=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/ig.exec(e);if(null===t){this.error="Wrong input string for conversion";return}let r=parseInt(t[1],10);r>=50?this.year=1900+r:this.year=2e3+r,this.month=parseInt(t[2],10),this.day=parseInt(t[3],10),this.hour=parseInt(t[4],10),this.minute=parseInt(t[5],10),this.second=parseInt(t[6],10)}toString(e="iso"){if("iso"===e){let e=Array(7);return e[0]=ry(this.year<2e3?this.year-1900:this.year-2e3,2),e[1]=ry(this.month,2),e[2]=ry(this.day,2),e[3]=ry(this.hour,2),e[4]=ry(this.minute,2),e[5]=ry(this.second,2),e[6]="Z",e.join("")}return super.toString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}}rP.UTCTime=ix,ix.NAME="UTCTime";class iS extends ix{constructor(e={}){super(e),null!=this.millisecond||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(e){super.fromDate(e),this.millisecond=e.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(e){let t,r=!1,i="",s="",n=0,o=0,a=0;if("Z"===e[e.length-1])i=e.substring(0,e.length-1),r=!0;else{if(isNaN(new Number(e[e.length-1]).valueOf()))throw Error("Wrong input string for conversion");i=e}if(r){if(-1!==i.indexOf("+")||-1!==i.indexOf("-"))throw Error("Wrong input string for conversion")}else{let e=1,t=i.indexOf("+"),r="";if(-1===t&&(t=i.indexOf("-"),e=-1),-1!==t){if(r=i.substring(t+1),i=i.substring(0,t),2!==r.length&&4!==r.length)throw Error("Wrong input string for conversion");let s=parseInt(r.substring(0,2),10);if(isNaN(s.valueOf()))throw Error("Wrong input string for conversion");if(o=e*s,4===r.length){if(isNaN((s=parseInt(r.substring(2,4),10)).valueOf()))throw Error("Wrong input string for conversion");a=e*s}}}let l=i.indexOf(".");if(-1===l&&(l=i.indexOf(",")),-1!==l){let e=new Number(`0${i.substring(l)}`);if(isNaN(e.valueOf()))throw Error("Wrong input string for conversion");n=e.valueOf(),s=i.substring(0,l)}else s=i;switch(!0){case 8===s.length:if(t=/(\d{4})(\d{2})(\d{2})/ig,-1!==l)throw Error("Wrong input string for conversion");break;case 10===s.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})/ig,-1!==l){let e=60*n;this.minute=Math.floor(e),e=60*(e-this.minute),this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 12===s.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/ig,-1!==l){let e=60*n;this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 14===s.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/ig,-1!==l){let e=1e3*n;this.millisecond=Math.floor(e)}break;default:throw Error("Wrong input string for conversion")}let c=t.exec(s);if(null===c)throw Error("Wrong input string for conversion");for(let e=1;e<c.length;e++)switch(e){case 1:this.year=parseInt(c[e],10);break;case 2:this.month=parseInt(c[e],10);break;case 3:this.day=parseInt(c[e],10);break;case 4:this.hour=parseInt(c[e],10)+o;break;case 5:this.minute=parseInt(c[e],10)+a;break;case 6:this.second=parseInt(c[e],10);break;default:throw Error("Wrong input string for conversion")}if(!1===r){let e=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=e.getUTCFullYear(),this.month=e.getUTCMonth(),this.day=e.getUTCDay(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds(),this.millisecond=e.getUTCMilliseconds()}}toString(e="iso"){if("iso"===e){let e=[];return e.push(ry(this.year,4)),e.push(ry(this.month,2)),e.push(ry(this.day,2)),e.push(ry(this.hour,2)),e.push(ry(this.minute,2)),e.push(ry(this.second,2)),0!==this.millisecond&&(e.push("."),e.push(ry(this.millisecond,3))),e.push("Z"),e.join("")}return super.toString(e)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}}rP.GeneralizedTime=iS,iS.NAME="GeneralizedTime";class iw extends is{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}rP.DATE=iw,iw.NAME="DATE";class i_ extends is{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}rP.TimeOfDay=i_,i_.NAME="TimeOfDay";class iA extends is{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}rP.DateTime=iA,iA.NAME="DateTime";class iC extends is{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}rP.Duration=iC,iC.NAME="Duration";class ik extends is{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}rP.TIME=ik,ik.NAME="TIME";class iB{constructor({name:e="",optional:t=!1}={}){this.name=e,this.optional=t}}class iN extends iB{constructor({value:e=[],...t}={}){super(t),this.value=e}}class ij extends iB{constructor({value:e=new iB,local:t=!1,...r}={}){super(r),this.value=e,this.local=t}}class iE{get data(){return this.dataView.slice().buffer}set data(e){this.dataView=ru.BufferSourceConverter.toUint8Array(e)}constructor({data:e=rC}={}){this.dataView=ru.BufferSourceConverter.toUint8Array(e)}fromBER(e,t,r){let i=t+r;return this.dataView=ru.BufferSourceConverter.toUint8Array(e).subarray(t,i),i}toBER(e){return this.dataView.slice().buffer}}function iO(e,t,r){if(r instanceof iN){for(let i of r.value)if(iO(e,t,i).verified)return{verified:!0,result:e};{let e={verified:!1,result:{error:"Wrong values for Choice type"}};return r.hasOwnProperty(rw)&&(e.name=r.name),e}}if(r instanceof iB)return r.hasOwnProperty(rw)&&(e[r.name]=t),{verified:!0,result:e};if(e instanceof Object==!1)return{verified:!1,result:{error:"Wrong root object"}};if(t instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(r instanceof Object==!1||"idBlock"in r==!1||"fromBER"in r.idBlock==!1||"toBER"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};let i=r.idBlock.toBER(!1);if(0===i.byteLength)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(-1===r.idBlock.fromBER(i,0,i.byteLength))return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(!1===r.idBlock.hasOwnProperty("tagClass"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagClass!==t.idBlock.tagClass)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty("tagNumber"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagNumber!==t.idBlock.tagNumber)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty("isConstructed"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isConstructed!==t.idBlock.isConstructed)return{verified:!1,result:e};if(!("isHexOnly"in r.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isHexOnly!==t.idBlock.isHexOnly)return{verified:!1,result:e};if(r.idBlock.isHexOnly){if(r_ in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};let i=r.idBlock.valueHexView,s=t.idBlock.valueHexView;if(i.length!==s.length)return{verified:!1,result:e};for(let t=0;t<i.length;t++)if(i[t]!==s[1])return{verified:!1,result:e}}if(r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&(e[r.name]=t)),r instanceof rP.Constructed){let i=0,s={verified:!1,result:{error:"Unknown error"}},n=r.valueBlock.value.length;if(n>0&&r.valueBlock.value[0]instanceof ij&&(n=t.valueBlock.value.length),0===n)return{verified:!0,result:e};if(0===t.valueBlock.value.length&&0!==r.valueBlock.value.length){let t=!0;for(let e=0;e<r.valueBlock.value.length;e++)t=t&&(r.valueBlock.value[e].optional||!1);return t?{verified:!0,result:e}:(r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&delete e[r.name]),e.error="Inconsistent object length",{verified:!1,result:e})}for(let o=0;o<n;o++)if(o-i>=t.valueBlock.value.length){if(!1===r.valueBlock.value[o].optional){let t={verified:!1,result:e};return e.error="Inconsistent length between ASN.1 data and schema",r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&(delete e[r.name],t.name=r.name)),t}}else if(r.valueBlock.value[0]instanceof ij){if(!1===(s=iO(e,t.valueBlock.value[o],r.valueBlock.value[0].value)).verified)if(!r.valueBlock.value[0].optional)return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&delete e[r.name]),s;else i++;if(rw in r.valueBlock.value[0]&&r.valueBlock.value[0].name.length>0){let i={};void 0===(i="local"in r.valueBlock.value[0]&&r.valueBlock.value[0].local?t:e)[r.valueBlock.value[0].name]&&(i[r.valueBlock.value[0].name]=[]),i[r.valueBlock.value[0].name].push(t.valueBlock.value[o])}}else if(!1===(s=iO(e,t.valueBlock.value[o-i],r.valueBlock.value[o])).verified)if(!r.valueBlock.value[o].optional)return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&delete e[r.name]),s;else i++;if(!1===s.verified){let t={verified:!1,result:e};return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&(delete e[r.name],t.name=r.name)),t}return{verified:!0,result:e}}if(r.primitiveSchema&&r_ in t.valueBlock){let i=rL(t.valueBlock.valueHexView);if(-1===i.offset){let t={verified:!1,result:i.result};return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&(delete e[r.name],t.name=r.name)),t}return iO(e,i.result,r.primitiveSchema)}return{verified:!0,result:e}}function iI(e,t){if(t instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema type"}};let r=rL(ru.BufferSourceConverter.toUint8Array(e));return -1===r.offset?{verified:!1,result:r.result}:iO(r.result,r.result,t)}e.s(["Any",()=>iB,"BaseBlock",()=>rD,"BaseStringBlock",()=>rU,"BitString",()=>rZ,"BmpString",()=>ia,"Boolean",()=>rq,"CharacterString",()=>ib,"Choice",()=>iN,"Constructed",()=>rF,"DATE",()=>iw,"DateTime",()=>iA,"Duration",()=>iC,"EndOfContent",()=>rz,"Enumerated",()=>r1,"GeneralString",()=>iv,"GeneralizedTime",()=>iS,"GraphicString",()=>ig,"HexBlock",()=>rj,"IA5String",()=>iy,"Integer",()=>r0,"Null",()=>rK,"NumericString",()=>iu,"ObjectIdentifier",()=>r8,"OctetString",()=>rJ,"Primitive",()=>rV,"PrintableString",()=>ip,"RawData",()=>iE,"RelativeObjectIdentifier",()=>r3,"Repeated",()=>ij,"Sequence",()=>r9,"Set",()=>r7,"TIME",()=>ik,"TeletexString",()=>id,"TimeOfDay",()=>i_,"UTCTime",()=>ix,"UniversalString",()=>ic,"Utf8String",()=>is,"ValueBlock",()=>rO,"VideotexString",()=>ih,"ViewWriter",()=>rb,"VisibleString",()=>im,"compareSchema",()=>iO,"fromBER",()=>rM,"verifySchema",()=>iI],60922),(s=_||(_={}))[s.Sequence=0]="Sequence",s[s.Set=1]="Set",s[s.Choice=2]="Choice",(n=A||(A={}))[n.Any=1]="Any",n[n.Boolean=2]="Boolean",n[n.OctetString=3]="OctetString",n[n.BitString=4]="BitString",n[n.Integer=5]="Integer",n[n.Enumerated=6]="Enumerated",n[n.ObjectIdentifier=7]="ObjectIdentifier",n[n.Utf8String=8]="Utf8String",n[n.BmpString=9]="BmpString",n[n.UniversalString=10]="UniversalString",n[n.NumericString=11]="NumericString",n[n.PrintableString=12]="PrintableString",n[n.TeletexString=13]="TeletexString",n[n.VideotexString=14]="VideotexString",n[n.IA5String=15]="IA5String",n[n.GraphicString=16]="GraphicString",n[n.VisibleString=17]="VisibleString",n[n.GeneralString=18]="GeneralString",n[n.CharacterString=19]="CharacterString",n[n.UTCTime=20]="UTCTime",n[n.GeneralizedTime=21]="GeneralizedTime",n[n.DATE=22]="DATE",n[n.TimeOfDay=23]="TimeOfDay",n[n.DateTime=24]="DateTime",n[n.Duration=25]="Duration",n[n.TIME=26]="TIME",n[n.Null=27]="Null";class iT{constructor(e,t=0){if(this.unusedBits=0,this.value=new ArrayBuffer(0),e)if("number"==typeof e)this.fromNumber(e);else if(ru.BufferSourceConverter.isBufferSource(e))this.unusedBits=t,this.value=ru.BufferSourceConverter.toArrayBuffer(e);else throw TypeError("Unsupported type of 'params' argument for BitString")}fromASN(e){if(!(e instanceof rZ))throw TypeError("Argument 'asn' is not instance of ASN.1 BitString");return this.unusedBits=e.valueBlock.unusedBits,this.value=e.valueBlock.valueHex,this}toASN(){return new rZ({unusedBits:this.unusedBits,valueHex:this.value})}toSchema(e){return new rZ({name:e})}toNumber(){let e="";for(let t of new Uint8Array(this.value))e+=t.toString(2).padStart(8,"0");return e=e.split("").reverse().join(""),this.unusedBits&&(e=e.slice(this.unusedBits).padStart(this.unusedBits,"0")),parseInt(e,2)}fromNumber(e){let t=e.toString(2),r=t.length+7>>3;this.unusedBits=(r<<3)-t.length;let i=new Uint8Array(r);t=t.padStart(r<<3,"0").split("").reverse().join("");let s=0;for(;s<r;)i[s]=parseInt(t.slice(s<<3,(s<<3)+8),2),s++;this.value=i.buffer}}class iP{get byteLength(){return this.buffer.byteLength}get byteOffset(){return 0}constructor(e){"number"==typeof e?this.buffer=new ArrayBuffer(e):ru.BufferSourceConverter.isBufferSource(e)?this.buffer=ru.BufferSourceConverter.toArrayBuffer(e):Array.isArray(e)?this.buffer=new Uint8Array(e):this.buffer=new ArrayBuffer(0)}fromASN(e){if(!(e instanceof rJ))throw TypeError("Argument 'asn' is not instance of ASN.1 OctetString");return this.buffer=e.valueBlock.valueHex,this}toASN(){return new rJ({valueHex:this.buffer})}toSchema(e){return new rJ({name:e})}}let iD={fromASN:e=>e instanceof rK?null:e.valueBeforeDecodeView,toASN:e=>{if(null===e)return new rK;let t=rM(e);if(t.result.error)throw Error(t.result.error);return t.result}},iU={fromASN:e=>e.valueBlock.valueHexView.byteLength>=4?e.valueBlock.toString():e.valueBlock.valueDec,toASN:e=>new r0({value:+e})},iR={fromASN:e=>e.valueBlock.valueDec,toASN:e=>new r1({value:e})},iV={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new r0({valueHex:e})},iL={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new rZ({valueHex:e})},iM={fromASN:e=>e.valueBlock.toString(),toASN:e=>new r8({value:e})},iH={fromASN:e=>e.valueBlock.value,toASN:e=>new rq({value:e})},iF={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new rJ({valueHex:e})};function i$(e){return{fromASN:e=>e.valueBlock.value,toASN:t=>new e({value:t})}}let iz=i$(is),iK=i$(ia),iW=i$(ic),iq=i$(iu),iG=i$(ip),iJ=i$(id),iY=i$(ih),iZ=i$(iy),iX=i$(ig),iQ=i$(im),i0=i$(iv),i1=i$(ib),i2={fromASN:e=>e.toDate(),toASN:e=>new ix({valueDate:e})},i4={fromASN:e=>e.toDate(),toASN:e=>new iS({valueDate:e})},i8={fromASN:()=>null,toASN:()=>new rK};function i5(e){switch(e){case A.Any:return iD;case A.BitString:return iL;case A.BmpString:return iK;case A.Boolean:return iH;case A.CharacterString:return i1;case A.Enumerated:return iR;case A.GeneralString:return i0;case A.GeneralizedTime:return i4;case A.GraphicString:return iX;case A.IA5String:return iZ;case A.Integer:return iU;case A.Null:return i8;case A.NumericString:return iq;case A.ObjectIdentifier:return iM;case A.OctetString:return iF;case A.PrintableString:return iG;case A.TeletexString:return iJ;case A.UTCTime:return i2;case A.UniversalString:return iW;case A.Utf8String:return iz;case A.VideotexString:return iY;case A.VisibleString:return iQ;default:return null}}var i6=e.i(60922);function i3(e){return"function"==typeof e&&e.prototype?!!e.prototype.toASN&&!!e.prototype.fromASN||i3(e.prototype):!!(e&&"object"==typeof e&&"toASN"in e&&"fromASN"in e)}let i9=new class{constructor(){this.items=new WeakMap}has(e){return this.items.has(e)}get(e,t=!1){let r=this.items.get(e);if(!r)throw Error(`Cannot get schema for '${e.prototype.constructor.name}' target`);if(t&&!r.schema)throw Error(`Schema '${e.prototype.constructor.name}' doesn't contain ASN.1 schema. Call 'AsnSchemaStorage.cache'.`);return r}cache(e){let t=this.get(e);t.schema||(t.schema=this.create(e,!0))}createDefault(e){let t={type:_.Sequence,items:{}},r=this.findParentSchema(e);return r&&(Object.assign(t,r),t.items=Object.assign({},t.items,r.items)),t}create(e,t){let r=this.items.get(e)||this.createDefault(e),i=[];for(let e in r.items){let s,n=r.items[e],o=t?e:"";if("number"==typeof n.type){let e=A[n.type],t=i6[e];if(!t)throw Error(`Cannot get ASN1 class by name '${e}'`);s=new t({name:o})}else i3(n.type)?s=new n.type().toSchema(o):n.optional?this.get(n.type).type===_.Choice?s=new i6.Any({name:o}):(s=this.create(n.type,!1)).name=o:s=new i6.Any({name:o});let a=!!n.optional||void 0!==n.defaultValue;if(n.repeated&&(s.name="",s=new("set"===n.repeated?i6.Set:i6.Sequence)({name:"",value:[new i6.Repeated({name:o,value:s})]})),null!==n.context&&void 0!==n.context)if(n.implicit)if("number"==typeof n.type||i3(n.type)){let e=n.repeated?i6.Constructed:i6.Primitive;i.push(new e({name:o,optional:a,idBlock:{tagClass:3,tagNumber:n.context}}))}else{this.cache(n.type);let e=!!n.repeated,t=e?s:this.get(n.type,!0).schema;t="valueBlock"in t?t.valueBlock.value:t.value,i.push(new i6.Constructed({name:e?"":o,optional:a,idBlock:{tagClass:3,tagNumber:n.context},value:t}))}else i.push(new i6.Constructed({optional:a,idBlock:{tagClass:3,tagNumber:n.context},value:[s]}));else s.optional=a,i.push(s)}switch(r.type){case _.Sequence:return new i6.Sequence({value:i,name:""});case _.Set:return new i6.Set({value:i,name:""});case _.Choice:return new i6.Choice({value:i,name:""});default:throw Error("Unsupported ASN1 type in use")}}set(e,t){return this.items.set(e,t),this}findParentSchema(e){let t=Object.getPrototypeOf(e);return t?this.items.get(t)||this.findParentSchema(t):null}},i7=e=>t=>{let r;i9.has(t)?r=i9.get(t):(r=i9.createDefault(t),i9.set(t,r)),Object.assign(r,e)},se=e=>(t,r)=>{let i;i9.has(t.constructor)?i=i9.get(t.constructor):(i=i9.createDefault(t.constructor),i9.set(t.constructor,i));let s=Object.assign({},e);if("number"==typeof s.type&&!s.converter){let i=i5(e.type);if(!i)throw Error(`Cannot get default converter for property '${r}' of ${t.constructor.name}`);s.converter=i}s.raw=e.raw,i.items[r]=s};class st extends Error{constructor(){super(...arguments),this.schemas=[]}}class sr{static parse(e,t){let r=i6.fromBER(e);if(r.result.error)throw Error(r.result.error);return this.fromASN(r.result,t)}static fromASN(e,t){try{if(i3(t))return new t().fromASN(e);let r=i9.get(t);i9.cache(t);let i=r.schema,s=this.handleChoiceTypes(e,r,t,i);if(null==s?void 0:s.result)return s.result;(null==s?void 0:s.targetSchema)&&(i=s.targetSchema);let n=this.handleSequenceTypes(e,r,t,i),o=new t;if(function e(t){var r;if(t){let i=Object.getPrototypeOf(t);return(null==(r=null==i?void 0:i.prototype)?void 0:r.constructor)===Array||e(i)}return!1}(t))return this.handleArrayTypes(e,r,t);return this.processSchemaItems(r,n,o),o}catch(e){throw e instanceof st&&e.schemas.push(t.name),e}}static handleChoiceTypes(e,t,r,i){if(e.constructor===i6.Constructed&&t.type===_.Choice&&3===e.idBlock.tagClass)for(let i in t.items){let s=t.items[i];if(s.context===e.idBlock.tagNumber&&s.implicit&&"function"==typeof s.type&&i9.has(s.type)){let t=i9.get(s.type);if(t&&t.type===_.Sequence){let t=new i6.Sequence;if("value"in e.valueBlock&&Array.isArray(e.valueBlock.value)&&"value"in t.valueBlock){t.valueBlock.value=e.valueBlock.value;let n=this.fromASN(t,s.type),o=new r;return o[i]=n,{result:o}}}}}else if(e.constructor===i6.Constructed&&t.type!==_.Choice){let r=new i6.Constructed({idBlock:{tagClass:3,tagNumber:e.idBlock.tagNumber},value:t.schema.valueBlock.value});for(let r in t.items)delete e[r];return{targetSchema:r}}return null}static handleSequenceTypes(e,t,r,i){if(t.type===_.Sequence){let t=i6.compareSchema({},e,i);if(!t.verified)throw new st(`Data does not match to ${r.name} ASN1 schema.${t.result.error?` ${t.result.error}`:""}`);return t}{let t=i6.compareSchema({},e,i);if(!t.verified)throw new st(`Data does not match to ${r.name} ASN1 schema.${t.result.error?` ${t.result.error}`:""}`);return t}}static processRepeatedField(e,t,r){let i=e.slice(t);if(1===i.length&&"Sequence"===i[0].constructor.name){let e=i[0];e.valueBlock&&e.valueBlock.value&&Array.isArray(e.valueBlock.value)&&(i=e.valueBlock.value)}if("number"!=typeof r.type)return i.filter(e=>e&&e.valueBlock).map(e=>{try{return this.fromASN(e,r.type)}catch{return}}).filter(e=>void 0!==e);{let e=i5(r.type);if(!e)throw Error(`No converter for ASN.1 type ${r.type}`);return i.filter(e=>e&&e.valueBlock).map(t=>{try{return e.fromASN(t)}catch{return}}).filter(e=>void 0!==e)}}static processPrimitiveField(e,t){let r=i5(t.type);if(!r)throw Error(`No converter for ASN.1 type ${t.type}`);return r.fromASN(e)}static isOptionalChoiceField(e){return e.optional&&"function"==typeof e.type&&i9.has(e.type)&&i9.get(e.type).type===_.Choice}static processOptionalChoiceField(e,t){try{let r=this.fromASN(e,t.type);return{processed:!0,value:r}}catch(e){if(e instanceof st&&/Wrong values for Choice type/.test(e.message))return{processed:!1};throw e}}static handleArrayTypes(e,t,r){if(!("value"in e.valueBlock&&Array.isArray(e.valueBlock.value)))throw Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");let i=t.itemType;if("number"!=typeof i)return r.from(e.valueBlock.value,e=>this.fromASN(e,i));{let t=i5(i);if(!t)throw Error(`Cannot get default converter for array item of ${r.name} ASN1 schema`);return r.from(e.valueBlock.value,e=>t.fromASN(e))}}static processSchemaItems(e,t,r){for(let i in e.items){let s,n=t.result[i];if(!n)continue;let o=e.items[i],a=o.type;(s="number"==typeof a||i3(a)?this.processPrimitiveSchemaItem(n,o,a):this.processComplexSchemaItem(n,o,a))&&"object"==typeof s&&"value"in s&&"raw"in s?(r[i]=s.value,r[`${i}Raw`]=s.raw):r[i]=s}}static processPrimitiveSchemaItem(e,t,r){var i;let s=null!=(i=t.converter)?i:i3(r)?new r:null;if(!s)throw Error("Converter is empty");return t.repeated?this.processRepeatedPrimitiveItem(e,t,s):this.processSinglePrimitiveItem(e,t,r,s)}static processRepeatedPrimitiveItem(e,t,r){if(!t.implicit)return Array.from(e,e=>r.fromASN(e));{let i=new("sequence"===t.repeated?i6.Sequence:i6.Set);i.valueBlock=e.valueBlock;let s=i6.fromBER(i.toBER(!1));if(-1===s.offset)throw Error(`Cannot parse the child item. ${s.result.error}`);if(!("value"in s.result.valueBlock&&Array.isArray(s.result.valueBlock.value)))throw Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");return Array.from(s.result.valueBlock.value,e=>r.fromASN(e))}}static processSinglePrimitiveItem(e,t,r,i){let s=e;if(t.implicit){let e;if(i3(r))e=new r().toSchema("");else{let t=A[r],i=i6[t];if(!i)throw Error(`Cannot get '${t}' class from asn1js module`);e=new i}e.valueBlock=s.valueBlock,s=i6.fromBER(e.toBER(!1)).result}return i.fromASN(s)}static processComplexSchemaItem(e,t,r){if(t.repeated){if(!Array.isArray(e))throw Error("Cannot get list of items from the ASN.1 parsed value. ASN.1 value should be iterable.");return Array.from(e,e=>this.fromASN(e,r))}{let i=this.handleImplicitTagging(e,t,r);if(this.isOptionalChoiceField(t))try{return this.fromASN(i,r)}catch(e){if(e instanceof st&&/Wrong values for Choice type/.test(e.message))return;throw e}{let s=this.fromASN(i,r);return t.raw?{value:s,raw:e.valueBeforeDecodeView}:s}}}static handleImplicitTagging(e,t,r){if(t.implicit&&"number"==typeof t.context){let t=i9.get(r);if(t.type===_.Sequence){let t=new i6.Sequence;if("value"in e.valueBlock&&Array.isArray(e.valueBlock.value)&&"value"in t.valueBlock)return t.valueBlock.value=e.valueBlock.value,t}else if(t.type===_.Set){let t=new i6.Set;if("value"in e.valueBlock&&Array.isArray(e.valueBlock.value)&&"value"in t.valueBlock)return t.valueBlock.value=e.valueBlock.value,t}}return e}}class si{static serialize(e){return e instanceof rD?e.toBER(!1):this.toASN(e).toBER(!1)}static toASN(e){let t;if(e&&"object"==typeof e&&i3(e))return e.toASN();if(!(e&&"object"==typeof e))throw TypeError("Parameter 1 should be type of Object.");let r=e.constructor,i=i9.get(r);i9.cache(r);let s=[];if(i.itemType){if(!Array.isArray(e))throw TypeError("Parameter 1 should be type of Array.");if("number"==typeof i.itemType){let t=i5(i.itemType);if(!t)throw Error(`Cannot get default converter for array item of ${r.name} ASN1 schema`);s=e.map(e=>t.toASN(e))}else s=e.map(e=>this.toAsnItem({type:i.itemType},"[]",r,e))}else for(let t in i.items){let n=i.items[t],o=e[t];if(void 0===o||n.defaultValue===o||"object"==typeof n.defaultValue&&"object"==typeof o&&function(e,t){if(!(e&&t)||e.byteLength!==t.byteLength)return!1;let r=new Uint8Array(e),i=new Uint8Array(t);for(let t=0;t<e.byteLength;t++)if(r[t]!==i[t])return!1;return!0}(this.serialize(n.defaultValue),this.serialize(o)))continue;let a=si.toAsnItem(n,t,r,o);if("number"==typeof n.context)if(n.implicit)if(!n.repeated&&("number"==typeof n.type||i3(n.type))){let e={};e.valueHex=a instanceof rK?a.valueBeforeDecodeView:a.valueBlock.toBER(),s.push(new rV({optional:n.optional,idBlock:{tagClass:3,tagNumber:n.context},...e}))}else s.push(new rF({optional:n.optional,idBlock:{tagClass:3,tagNumber:n.context},value:a.valueBlock.value}));else s.push(new rF({optional:n.optional,idBlock:{tagClass:3,tagNumber:n.context},value:[a]}));else n.repeated?s=s.concat(a):s.push(a)}switch(i.type){case _.Sequence:t=new r9({value:s});break;case _.Set:t=new r7({value:s});break;case _.Choice:if(!s[0])throw Error(`Schema '${r.name}' has wrong data. Choice cannot be empty.`);t=s[0]}return t}static toAsnItem(e,t,r,i){let s;if("number"==typeof e.type){let n=e.converter;if(!n)throw Error(`Property '${t}' doesn't have converter for type ${A[e.type]} in schema '${r.name}'`);if(e.repeated){if(!Array.isArray(i))throw TypeError("Parameter 'objProp' should be type of Array.");let t=Array.from(i,e=>n.toASN(e));s=new("sequence"===e.repeated?r9:r7)({value:t})}else s=n.toASN(i)}else if(e.repeated){if(!Array.isArray(i))throw TypeError("Parameter 'objProp' should be type of Array.");let t=Array.from(i,e=>this.toASN(e));s=new("sequence"===e.repeated?r9:r7)({value:t})}else s=this.toASN(i);return s}}class ss extends Array{constructor(e=[]){if("number"==typeof e)super(e);else for(const t of(super(),e))this.push(t)}}class sn{static serialize(e){return si.serialize(e)}static parse(e,t){return sr.parse(e,t)}static toString(e){let t=rM(ru.BufferSourceConverter.isBufferSource(e)?ru.BufferSourceConverter.toArrayBuffer(e):sn.serialize(e));if(-1===t.offset)throw Error(`Cannot decode ASN.1 data. ${t.result.error}`);return t.result.toString()}}var so=e.i(90571);class sa{static isIPv4(e){return/^(\d{1,3}\.){3}\d{1,3}$/.test(e)}static parseIPv4(e){let t=e.split(".");if(4!==t.length)throw Error("Invalid IPv4 address");return t.map(e=>{let t=parseInt(e,10);if(isNaN(t)||t<0||t>255)throw Error("Invalid IPv4 address part");return t})}static parseIPv6(e){let t=this.expandIPv6(e).split(":");if(8!==t.length)throw Error("Invalid IPv6 address");return t.reduce((e,t)=>{let r=parseInt(t,16);if(isNaN(r)||r<0||r>65535)throw Error("Invalid IPv6 address part");return e.push(r>>8&255),e.push(255&r),e},[])}static expandIPv6(e){if(!e.includes("::"))return e;let t=e.split("::");if(t.length>2)throw Error("Invalid IPv6 address");let r=t[0]?t[0].split(":"):[],i=t[1]?t[1].split(":"):[],s=8-(r.length+i.length);if(s<0)throw Error("Invalid IPv6 address");return[...r,...Array(s).fill("0"),...i].join(":")}static formatIPv6(e){let t=[];for(let r=0;r<16;r+=2)t.push((e[r]<<8|e[r+1]).toString(16));return this.compressIPv6(t.join(":"))}static compressIPv6(e){let t=e.split(":"),r=-1,i=0,s=-1,n=0;for(let e=0;e<t.length;e++)"0"===t[e]?(-1===s&&(s=e),n++):(n>i&&(r=s,i=n),s=-1,n=0);if(n>i&&(r=s,i=n),i>1){let e=t.slice(0,r).join(":"),s=t.slice(r+i).join(":");return`${e}::${s}`}return e}static parseCIDR(e){let[t,r]=e.split("/"),i=parseInt(r,10);if(this.isIPv4(t)){if(i<0||i>32)throw Error("Invalid IPv4 prefix length");return[this.parseIPv4(t),i]}if(i<0||i>128)throw Error("Invalid IPv6 prefix length");return[this.parseIPv6(t),i]}static decodeIP(e){if(64===e.length&&0===parseInt(e,16))return"::/0";if(16!==e.length)return e;let t=parseInt(e.slice(8),16).toString(2).split("").reduce((e,t)=>e+ +t,0),r=e.slice(0,8).replace(/(.{2})/g,e=>`${parseInt(e,16)}.`);return r=r.slice(0,-1),`${r}/${t}`}static toString(e){let t=new Uint8Array(e);if(4===t.length)return Array.from(t).join(".");if(16===t.length)return this.formatIPv6(t);if(8===t.length||32===t.length){let e=t.length/2,r=t.slice(0,e),i=t.slice(e);if(t.every(e=>0===e))return 8===t.length?"0.0.0.0/0":"::/0";let s=i.reduce((e,t)=>e+(t.toString(2).match(/1/g)||[]).length,0);if(8===t.length){let e=Array.from(r).join(".");return`${e}/${s}`}{let e=this.formatIPv6(r);return`${e}/${s}`}}return this.decodeIP(ru.Convert.ToHex(e))}static fromString(e){if(e.includes("/")){let[t,r]=this.parseCIDR(e),i=new Uint8Array(t.length),s=r;for(let e=0;e<i.length;e++)s>=8?(i[e]=255,s-=8):s>0&&(i[e]=255<<8-s,s=0);let n=new Uint8Array(2*t.length);return n.set(t,0),n.set(i,t.length),n.buffer}return new Uint8Array(this.isIPv4(e)?this.parseIPv4(e):this.parseIPv6(e)).buffer}}let sl=class{constructor(e={}){Object.assign(this,e)}toString(){return this.bmpString||this.printableString||this.teletexString||this.universalString||this.utf8String||""}};(0,so.__decorate)([se({type:A.TeletexString})],sl.prototype,"teletexString",void 0),(0,so.__decorate)([se({type:A.PrintableString})],sl.prototype,"printableString",void 0),(0,so.__decorate)([se({type:A.UniversalString})],sl.prototype,"universalString",void 0),(0,so.__decorate)([se({type:A.Utf8String})],sl.prototype,"utf8String",void 0),(0,so.__decorate)([se({type:A.BmpString})],sl.prototype,"bmpString",void 0),sl=(0,so.__decorate)([i7({type:_.Choice})],sl);let sc=class extends sl{constructor(e={}){super(e),Object.assign(this,e)}toString(){return this.ia5String||(this.anyValue?ru.Convert.ToHex(this.anyValue):super.toString())}};(0,so.__decorate)([se({type:A.IA5String})],sc.prototype,"ia5String",void 0),(0,so.__decorate)([se({type:A.Any})],sc.prototype,"anyValue",void 0),sc=(0,so.__decorate)([i7({type:_.Choice})],sc);class su{constructor(e={}){this.type="",this.value=new sc,Object.assign(this,e)}}(0,so.__decorate)([se({type:A.ObjectIdentifier})],su.prototype,"type",void 0),(0,so.__decorate)([se({type:sc})],su.prototype,"value",void 0);let sp=C=class extends ss{constructor(e){super(e),Object.setPrototypeOf(this,C.prototype)}};sp=C=(0,so.__decorate)([i7({type:_.Set,itemType:su})],sp);let sd=k=class extends ss{constructor(e){super(e),Object.setPrototypeOf(this,k.prototype)}};sd=k=(0,so.__decorate)([i7({type:_.Sequence,itemType:sp})],sd);let sh=B=class extends sd{constructor(e){super(e),Object.setPrototypeOf(this,B.prototype)}};sh=B=(0,so.__decorate)([i7({type:_.Sequence})],sh);class sf{constructor(e={}){this.typeId="",this.value=new ArrayBuffer(0),Object.assign(this,e)}}(0,so.__decorate)([se({type:A.ObjectIdentifier})],sf.prototype,"typeId",void 0),(0,so.__decorate)([se({type:A.Any,context:0})],sf.prototype,"value",void 0);class sy{constructor(e={}){this.partyName=new sl,Object.assign(this,e)}}(0,so.__decorate)([se({type:sl,optional:!0,context:0,implicit:!0})],sy.prototype,"nameAssigner",void 0),(0,so.__decorate)([se({type:sl,context:1,implicit:!0})],sy.prototype,"partyName",void 0);let sg=class{constructor(e={}){Object.assign(this,e)}};(0,so.__decorate)([se({type:sf,context:0,implicit:!0})],sg.prototype,"otherName",void 0),(0,so.__decorate)([se({type:A.IA5String,context:1,implicit:!0})],sg.prototype,"rfc822Name",void 0),(0,so.__decorate)([se({type:A.IA5String,context:2,implicit:!0})],sg.prototype,"dNSName",void 0),(0,so.__decorate)([se({type:A.Any,context:3,implicit:!0})],sg.prototype,"x400Address",void 0),(0,so.__decorate)([se({type:sh,context:4,implicit:!1})],sg.prototype,"directoryName",void 0),(0,so.__decorate)([se({type:sy,context:5})],sg.prototype,"ediPartyName",void 0),(0,so.__decorate)([se({type:A.IA5String,context:6,implicit:!0})],sg.prototype,"uniformResourceIdentifier",void 0),(0,so.__decorate)([se({type:A.OctetString,context:7,implicit:!0,converter:{fromASN:e=>sa.toString(iF.fromASN(e)),toASN:e=>iF.toASN(sa.fromString(e))}})],sg.prototype,"iPAddress",void 0),(0,so.__decorate)([se({type:A.ObjectIdentifier,context:8,implicit:!0})],sg.prototype,"registeredID",void 0),sg=(0,so.__decorate)([i7({type:_.Choice})],sg);let sm="1.3.6.1.5.5.7",sv=`${sm}.1`,sb=`${sm}.3`,sx=`${sm}.48`,sS=`${sx}.1`,sw=`${sx}.2`,s_=`${sx}.3`,sA=`${sx}.5`,sC="2.5.29",sk=`${sv}.1`;class sB{constructor(e={}){this.accessMethod="",this.accessLocation=new sg,Object.assign(this,e)}}(0,so.__decorate)([se({type:A.ObjectIdentifier})],sB.prototype,"accessMethod",void 0),(0,so.__decorate)([se({type:sg})],sB.prototype,"accessLocation",void 0);let sN=N=class extends ss{constructor(e){super(e),Object.setPrototypeOf(this,N.prototype)}};sN=N=(0,so.__decorate)([i7({type:_.Sequence,itemType:sB})],sN);let sj=`${sC}.35`;class sE extends iP{}class sO{constructor(e={}){e&&Object.assign(this,e)}}(0,so.__decorate)([se({type:sE,context:0,optional:!0,implicit:!0})],sO.prototype,"keyIdentifier",void 0),(0,so.__decorate)([se({type:sg,context:1,optional:!0,implicit:!0,repeated:"sequence"})],sO.prototype,"authorityCertIssuer",void 0),(0,so.__decorate)([se({type:A.Integer,context:2,optional:!0,implicit:!0,converter:iV})],sO.prototype,"authorityCertSerialNumber",void 0);let sI=`${sC}.19`;class sT{constructor(e={}){this.cA=!1,Object.assign(this,e)}}(0,so.__decorate)([se({type:A.Boolean,defaultValue:!1})],sT.prototype,"cA",void 0),(0,so.__decorate)([se({type:A.Integer,optional:!0})],sT.prototype,"pathLenConstraint",void 0);let sP=j=class extends ss{constructor(e){super(e),Object.setPrototypeOf(this,j.prototype)}};sP=j=(0,so.__decorate)([i7({type:_.Sequence,itemType:sg})],sP);let sD=E=class extends sP{constructor(e){super(e),Object.setPrototypeOf(this,E.prototype)}};sD=E=(0,so.__decorate)([i7({type:_.Sequence})],sD);let sU=`${sC}.32`,sR=class{constructor(e={}){Object.assign(this,e)}toString(){return this.ia5String||this.visibleString||this.bmpString||this.utf8String||""}};(0,so.__decorate)([se({type:A.IA5String})],sR.prototype,"ia5String",void 0),(0,so.__decorate)([se({type:A.VisibleString})],sR.prototype,"visibleString",void 0),(0,so.__decorate)([se({type:A.BmpString})],sR.prototype,"bmpString",void 0),(0,so.__decorate)([se({type:A.Utf8String})],sR.prototype,"utf8String",void 0),sR=(0,so.__decorate)([i7({type:_.Choice})],sR);class sV{constructor(e={}){this.organization=new sR,this.noticeNumbers=[],Object.assign(this,e)}}(0,so.__decorate)([se({type:sR})],sV.prototype,"organization",void 0),(0,so.__decorate)([se({type:A.Integer,repeated:"sequence"})],sV.prototype,"noticeNumbers",void 0);class sL{constructor(e={}){Object.assign(this,e)}}(0,so.__decorate)([se({type:sV,optional:!0})],sL.prototype,"noticeRef",void 0),(0,so.__decorate)([se({type:sR,optional:!0})],sL.prototype,"explicitText",void 0);let sM=class{constructor(e={}){Object.assign(this,e)}};(0,so.__decorate)([se({type:A.IA5String})],sM.prototype,"cPSuri",void 0),(0,so.__decorate)([se({type:sL})],sM.prototype,"userNotice",void 0),sM=(0,so.__decorate)([i7({type:_.Choice})],sM);class sH{constructor(e={}){this.policyQualifierId="",this.qualifier=new ArrayBuffer(0),Object.assign(this,e)}}(0,so.__decorate)([se({type:A.ObjectIdentifier})],sH.prototype,"policyQualifierId",void 0),(0,so.__decorate)([se({type:A.Any})],sH.prototype,"qualifier",void 0);class sF{constructor(e={}){this.policyIdentifier="",Object.assign(this,e)}}(0,so.__decorate)([se({type:A.ObjectIdentifier})],sF.prototype,"policyIdentifier",void 0),(0,so.__decorate)([se({type:sH,repeated:"sequence",optional:!0})],sF.prototype,"policyQualifiers",void 0);let s$=O=class extends ss{constructor(e){super(e),Object.setPrototypeOf(this,O.prototype)}};s$=O=(0,so.__decorate)([i7({type:_.Sequence,itemType:sF})],s$);let sz=class{constructor(e=0){this.value=e}};(0,so.__decorate)([se({type:A.Integer})],sz.prototype,"value",void 0),sz=(0,so.__decorate)([i7({type:_.Choice})],sz);let sK=class extends sz{};sK=(0,so.__decorate)([i7({type:_.Choice})],sK);let sW=`${sC}.31`;(o=T||(T={}))[o.unused=1]="unused",o[o.keyCompromise=2]="keyCompromise",o[o.cACompromise=4]="cACompromise",o[o.affiliationChanged=8]="affiliationChanged",o[o.superseded=16]="superseded",o[o.cessationOfOperation=32]="cessationOfOperation",o[o.certificateHold=64]="certificateHold",o[o.privilegeWithdrawn=128]="privilegeWithdrawn",o[o.aACompromise=256]="aACompromise";class sq extends iT{toJSON(){let e=[],t=this.toNumber();return t&T.aACompromise&&e.push("aACompromise"),t&T.affiliationChanged&&e.push("affiliationChanged"),t&T.cACompromise&&e.push("cACompromise"),t&T.certificateHold&&e.push("certificateHold"),t&T.cessationOfOperation&&e.push("cessationOfOperation"),t&T.keyCompromise&&e.push("keyCompromise"),t&T.privilegeWithdrawn&&e.push("privilegeWithdrawn"),t&T.superseded&&e.push("superseded"),t&T.unused&&e.push("unused"),e}toString(){return`[${this.toJSON().join(", ")}]`}}let sG=class{constructor(e={}){Object.assign(this,e)}};(0,so.__decorate)([se({type:sg,context:0,repeated:"sequence",implicit:!0})],sG.prototype,"fullName",void 0),(0,so.__decorate)([se({type:sp,context:1,implicit:!0})],sG.prototype,"nameRelativeToCRLIssuer",void 0),sG=(0,so.__decorate)([i7({type:_.Choice})],sG);class sJ{constructor(e={}){Object.assign(this,e)}}(0,so.__decorate)([se({type:sG,context:0,optional:!0})],sJ.prototype,"distributionPoint",void 0),(0,so.__decorate)([se({type:sq,context:1,optional:!0,implicit:!0})],sJ.prototype,"reasons",void 0),(0,so.__decorate)([se({type:sg,context:2,optional:!0,repeated:"sequence",implicit:!0})],sJ.prototype,"cRLIssuer",void 0);let sY=I=class extends ss{constructor(e){super(e),Object.setPrototypeOf(this,I.prototype)}};sY=I=(0,so.__decorate)([i7({type:_.Sequence,itemType:sJ})],sY);let sZ=P=class extends sY{constructor(e){super(e),Object.setPrototypeOf(this,P.prototype)}};sZ=P=(0,so.__decorate)([i7({type:_.Sequence,itemType:sJ})],sZ);class sX{constructor(e={}){this.onlyContainsUserCerts=sX.ONLY,this.onlyContainsCACerts=sX.ONLY,this.indirectCRL=sX.ONLY,this.onlyContainsAttributeCerts=sX.ONLY,Object.assign(this,e)}}sX.ONLY=!1,(0,so.__decorate)([se({type:sG,context:0,optional:!0})],sX.prototype,"distributionPoint",void 0),(0,so.__decorate)([se({type:A.Boolean,context:1,defaultValue:sX.ONLY,implicit:!0})],sX.prototype,"onlyContainsUserCerts",void 0),(0,so.__decorate)([se({type:A.Boolean,context:2,defaultValue:sX.ONLY,implicit:!0})],sX.prototype,"onlyContainsCACerts",void 0),(0,so.__decorate)([se({type:sq,context:3,optional:!0,implicit:!0})],sX.prototype,"onlySomeReasons",void 0),(0,so.__decorate)([se({type:A.Boolean,context:4,defaultValue:sX.ONLY,implicit:!0})],sX.prototype,"indirectCRL",void 0),(0,so.__decorate)([se({type:A.Boolean,context:5,defaultValue:sX.ONLY,implicit:!0})],sX.prototype,"onlyContainsAttributeCerts",void 0),(a=D||(D={}))[a.unspecified=0]="unspecified",a[a.keyCompromise=1]="keyCompromise",a[a.cACompromise=2]="cACompromise",a[a.affiliationChanged=3]="affiliationChanged",a[a.superseded=4]="superseded",a[a.cessationOfOperation=5]="cessationOfOperation",a[a.certificateHold=6]="certificateHold",a[a.removeFromCRL=8]="removeFromCRL",a[a.privilegeWithdrawn=9]="privilegeWithdrawn",a[a.aACompromise=10]="aACompromise";let sQ=class{constructor(e=D.unspecified){this.reason=D.unspecified,this.reason=e}toJSON(){return D[this.reason]}toString(){return this.toJSON()}};(0,so.__decorate)([se({type:A.Enumerated})],sQ.prototype,"reason",void 0),sQ=(0,so.__decorate)([i7({type:_.Choice})],sQ);let s0=`${sC}.37`,s1=U=class extends ss{constructor(e){super(e),Object.setPrototypeOf(this,U.prototype)}};s1=U=(0,so.__decorate)([i7({type:_.Sequence,itemType:A.ObjectIdentifier})],s1);let s2=`${sb}.1`,s4=`${sb}.2`,s8=`${sb}.3`,s5=`${sb}.4`,s6=`${sb}.8`,s3=`${sb}.9`,s9=class{constructor(e=new ArrayBuffer(0)){this.value=e}};(0,so.__decorate)([se({type:A.Integer,converter:iV})],s9.prototype,"value",void 0),s9=(0,so.__decorate)([i7({type:_.Choice})],s9);let s7=class{constructor(e){this.value=new Date,e&&(this.value=e)}};(0,so.__decorate)([se({type:A.GeneralizedTime})],s7.prototype,"value",void 0),s7=(0,so.__decorate)([i7({type:_.Choice})],s7);let ne=`${sC}.18`,nt=R=class extends sP{constructor(e){super(e),Object.setPrototypeOf(this,R.prototype)}};nt=R=(0,so.__decorate)([i7({type:_.Sequence})],nt);let nr=`${sC}.15`;(l=V||(V={}))[l.digitalSignature=1]="digitalSignature",l[l.nonRepudiation=2]="nonRepudiation",l[l.keyEncipherment=4]="keyEncipherment",l[l.dataEncipherment=8]="dataEncipherment",l[l.keyAgreement=16]="keyAgreement",l[l.keyCertSign=32]="keyCertSign",l[l.cRLSign=64]="cRLSign",l[l.encipherOnly=128]="encipherOnly",l[l.decipherOnly=256]="decipherOnly";class ni extends iT{toJSON(){let e=this.toNumber(),t=[];return e&V.cRLSign&&t.push("crlSign"),e&V.dataEncipherment&&t.push("dataEncipherment"),e&V.decipherOnly&&t.push("decipherOnly"),e&V.digitalSignature&&t.push("digitalSignature"),e&V.encipherOnly&&t.push("encipherOnly"),e&V.keyAgreement&&t.push("keyAgreement"),e&V.keyCertSign&&t.push("keyCertSign"),e&V.keyEncipherment&&t.push("keyEncipherment"),e&V.nonRepudiation&&t.push("nonRepudiation"),t}toString(){return`[${this.toJSON().join(", ")}]`}}class ns{constructor(e={}){this.base=new sg,this.minimum=0,Object.assign(this,e)}}(0,so.__decorate)([se({type:sg})],ns.prototype,"base",void 0),(0,so.__decorate)([se({type:A.Integer,context:0,defaultValue:0,implicit:!0})],ns.prototype,"minimum",void 0),(0,so.__decorate)([se({type:A.Integer,context:1,optional:!0,implicit:!0})],ns.prototype,"maximum",void 0);let nn=L=class extends ss{constructor(e){super(e),Object.setPrototypeOf(this,L.prototype)}};nn=L=(0,so.__decorate)([i7({type:_.Sequence,itemType:ns})],nn);class no{constructor(e={}){Object.assign(this,e)}}(0,so.__decorate)([se({type:nn,context:0,optional:!0,implicit:!0})],no.prototype,"permittedSubtrees",void 0),(0,so.__decorate)([se({type:nn,context:1,optional:!0,implicit:!0})],no.prototype,"excludedSubtrees",void 0);class na{constructor(e={}){Object.assign(this,e)}}(0,so.__decorate)([se({type:A.Integer,context:0,implicit:!0,optional:!0,converter:iV})],na.prototype,"requireExplicitPolicy",void 0),(0,so.__decorate)([se({type:A.Integer,context:1,implicit:!0,optional:!0,converter:iV})],na.prototype,"inhibitPolicyMapping",void 0);class nl{constructor(e={}){this.issuerDomainPolicy="",this.subjectDomainPolicy="",Object.assign(this,e)}}(0,so.__decorate)([se({type:A.ObjectIdentifier})],nl.prototype,"issuerDomainPolicy",void 0),(0,so.__decorate)([se({type:A.ObjectIdentifier})],nl.prototype,"subjectDomainPolicy",void 0);let nc=M=class extends ss{constructor(e){super(e),Object.setPrototypeOf(this,M.prototype)}};nc=M=(0,so.__decorate)([i7({type:_.Sequence,itemType:nl})],nc);let nu=`${sC}.17`,np=H=class extends sP{constructor(e){super(e),Object.setPrototypeOf(this,H.prototype)}};np=H=(0,so.__decorate)([i7({type:_.Sequence})],np);class nd{constructor(e={}){this.type="",this.values=[],Object.assign(this,e)}}(0,so.__decorate)([se({type:A.ObjectIdentifier})],nd.prototype,"type",void 0),(0,so.__decorate)([se({type:A.Any,repeated:"set"})],nd.prototype,"values",void 0);let nh=F=class extends ss{constructor(e){super(e),Object.setPrototypeOf(this,F.prototype)}};nh=F=(0,so.__decorate)([i7({type:_.Sequence,itemType:nd})],nh);let nf=`${sC}.14`;class ny extends sE{}class ng{constructor(e={}){Object.assign(this,e)}}(0,so.__decorate)([se({type:A.GeneralizedTime,context:0,implicit:!0,optional:!0})],ng.prototype,"notBefore",void 0),(0,so.__decorate)([se({type:A.GeneralizedTime,context:1,implicit:!0,optional:!0})],ng.prototype,"notAfter",void 0),(c=$||($={}))[c.keyUpdateAllowed=1]="keyUpdateAllowed",c[c.newExtensions=2]="newExtensions",c[c.pKIXCertificate=4]="pKIXCertificate";class nm extends iT{toJSON(){let e=[],t=this.toNumber();return t&$.pKIXCertificate&&e.push("pKIXCertificate"),t&$.newExtensions&&e.push("newExtensions"),t&$.keyUpdateAllowed&&e.push("keyUpdateAllowed"),e}toString(){return`[${this.toJSON().join(", ")}]`}}class nv{constructor(e={}){this.entrustVers="",this.entrustInfoFlags=new nm,Object.assign(this,e)}}(0,so.__decorate)([se({type:A.GeneralString})],nv.prototype,"entrustVers",void 0),(0,so.__decorate)([se({type:nm})],nv.prototype,"entrustInfoFlags",void 0);let nb=z=class extends ss{constructor(e){super(e),Object.setPrototypeOf(this,z.prototype)}};nb=z=(0,so.__decorate)([i7({type:_.Sequence,itemType:sB})],nb);class nx{constructor(e={}){this.algorithm="",Object.assign(this,e)}isEqual(e){return e instanceof nx&&e.algorithm==this.algorithm&&(e.parameters&&this.parameters&&ru.isEqual(e.parameters,this.parameters)||e.parameters===this.parameters)}}(0,so.__decorate)([se({type:A.ObjectIdentifier})],nx.prototype,"algorithm",void 0),(0,so.__decorate)([se({type:A.Any,optional:!0})],nx.prototype,"parameters",void 0);class nS{constructor(e={}){this.algorithm=new nx,this.subjectPublicKey=new ArrayBuffer(0),Object.assign(this,e)}}(0,so.__decorate)([se({type:nx})],nS.prototype,"algorithm",void 0),(0,so.__decorate)([se({type:A.BitString})],nS.prototype,"subjectPublicKey",void 0);let nw=class{constructor(e){if(e)if("string"==typeof e||"number"==typeof e||e instanceof Date){const t=new Date(e);t.getUTCFullYear()>2049?this.generalTime=t:this.utcTime=t}else Object.assign(this,e)}getTime(){let e=this.utcTime||this.generalTime;if(!e)throw Error("Cannot get time from CHOICE object");return e}};(0,so.__decorate)([se({type:A.UTCTime})],nw.prototype,"utcTime",void 0),(0,so.__decorate)([se({type:A.GeneralizedTime})],nw.prototype,"generalTime",void 0),nw=(0,so.__decorate)([i7({type:_.Choice})],nw);class n_{constructor(e){this.notBefore=new nw(new Date),this.notAfter=new nw(new Date),e&&(this.notBefore=new nw(e.notBefore),this.notAfter=new nw(e.notAfter))}}(0,so.__decorate)([se({type:nw})],n_.prototype,"notBefore",void 0),(0,so.__decorate)([se({type:nw})],n_.prototype,"notAfter",void 0);class nA{constructor(e={}){this.extnID="",this.critical=nA.CRITICAL,this.extnValue=new iP,Object.assign(this,e)}}nA.CRITICAL=!1,(0,so.__decorate)([se({type:A.ObjectIdentifier})],nA.prototype,"extnID",void 0),(0,so.__decorate)([se({type:A.Boolean,defaultValue:nA.CRITICAL})],nA.prototype,"critical",void 0),(0,so.__decorate)([se({type:iP})],nA.prototype,"extnValue",void 0);let nC=K=class extends ss{constructor(e){super(e),Object.setPrototypeOf(this,K.prototype)}};nC=K=(0,so.__decorate)([i7({type:_.Sequence,itemType:nA})],nC),(u=W||(W={}))[u.v1=0]="v1",u[u.v2=1]="v2",u[u.v3=2]="v3";class nk{constructor(e={}){this.version=W.v1,this.serialNumber=new ArrayBuffer(0),this.signature=new nx,this.issuer=new sh,this.validity=new n_,this.subject=new sh,this.subjectPublicKeyInfo=new nS,Object.assign(this,e)}}(0,so.__decorate)([se({type:A.Integer,context:0,defaultValue:W.v1})],nk.prototype,"version",void 0),(0,so.__decorate)([se({type:A.Integer,converter:iV})],nk.prototype,"serialNumber",void 0),(0,so.__decorate)([se({type:nx})],nk.prototype,"signature",void 0),(0,so.__decorate)([se({type:sh})],nk.prototype,"issuer",void 0),(0,so.__decorate)([se({type:n_})],nk.prototype,"validity",void 0),(0,so.__decorate)([se({type:sh})],nk.prototype,"subject",void 0),(0,so.__decorate)([se({type:nS})],nk.prototype,"subjectPublicKeyInfo",void 0),(0,so.__decorate)([se({type:A.BitString,context:1,implicit:!0,optional:!0})],nk.prototype,"issuerUniqueID",void 0),(0,so.__decorate)([se({type:A.BitString,context:2,implicit:!0,optional:!0})],nk.prototype,"subjectUniqueID",void 0),(0,so.__decorate)([se({type:nC,context:3,optional:!0})],nk.prototype,"extensions",void 0);class nB{constructor(e={}){this.tbsCertificate=new nk,this.signatureAlgorithm=new nx,this.signatureValue=new ArrayBuffer(0),Object.assign(this,e)}}(0,so.__decorate)([se({type:nk,raw:!0})],nB.prototype,"tbsCertificate",void 0),(0,so.__decorate)([se({type:nx})],nB.prototype,"signatureAlgorithm",void 0),(0,so.__decorate)([se({type:A.BitString})],nB.prototype,"signatureValue",void 0);class nN{constructor(e={}){this.userCertificate=new ArrayBuffer(0),this.revocationDate=new nw,Object.assign(this,e)}}(0,so.__decorate)([se({type:A.Integer,converter:iV})],nN.prototype,"userCertificate",void 0),(0,so.__decorate)([se({type:nw})],nN.prototype,"revocationDate",void 0),(0,so.__decorate)([se({type:nA,optional:!0,repeated:"sequence"})],nN.prototype,"crlEntryExtensions",void 0);class nj{constructor(e={}){this.signature=new nx,this.issuer=new sh,this.thisUpdate=new nw,Object.assign(this,e)}}(0,so.__decorate)([se({type:A.Integer,optional:!0})],nj.prototype,"version",void 0),(0,so.__decorate)([se({type:nx})],nj.prototype,"signature",void 0),(0,so.__decorate)([se({type:sh})],nj.prototype,"issuer",void 0),(0,so.__decorate)([se({type:nw})],nj.prototype,"thisUpdate",void 0),(0,so.__decorate)([se({type:nw,optional:!0})],nj.prototype,"nextUpdate",void 0),(0,so.__decorate)([se({type:nN,repeated:"sequence",optional:!0})],nj.prototype,"revokedCertificates",void 0),(0,so.__decorate)([se({type:nA,optional:!0,context:0,repeated:"sequence"})],nj.prototype,"crlExtensions",void 0);class nE{constructor(e={}){this.tbsCertList=new nj,this.signatureAlgorithm=new nx,this.signature=new ArrayBuffer(0),Object.assign(this,e)}}(0,so.__decorate)([se({type:nj,raw:!0})],nE.prototype,"tbsCertList",void 0),(0,so.__decorate)([se({type:nx})],nE.prototype,"signatureAlgorithm",void 0),(0,so.__decorate)([se({type:A.BitString})],nE.prototype,"signature",void 0);class nO{constructor(e={}){this.issuer=new sh,this.serialNumber=new ArrayBuffer(0),Object.assign(this,e)}}(0,so.__decorate)([se({type:sh})],nO.prototype,"issuer",void 0),(0,so.__decorate)([se({type:A.Integer,converter:iV})],nO.prototype,"serialNumber",void 0);let nI=class{constructor(e={}){Object.assign(this,e)}};(0,so.__decorate)([se({type:ny,context:0,implicit:!0})],nI.prototype,"subjectKeyIdentifier",void 0),(0,so.__decorate)([se({type:nO})],nI.prototype,"issuerAndSerialNumber",void 0),nI=(0,so.__decorate)([i7({type:_.Choice})],nI),(p=q||(q={}))[p.v0=0]="v0",p[p.v1=1]="v1",p[p.v2=2]="v2",p[p.v3=3]="v3",p[p.v4=4]="v4",p[p.v5=5]="v5";let nT=class extends nx{};nT=(0,so.__decorate)([i7({type:_.Sequence})],nT);let nP=class extends nx{};nP=(0,so.__decorate)([i7({type:_.Sequence})],nP);let nD=class extends nx{};nD=(0,so.__decorate)([i7({type:_.Sequence})],nD);let nU=class extends nx{};nU=(0,so.__decorate)([i7({type:_.Sequence})],nU);let nR=class extends nx{};nR=(0,so.__decorate)([i7({type:_.Sequence})],nR);let nV=class extends nx{};nV=(0,so.__decorate)([i7({type:_.Sequence})],nV);class nL{constructor(e={}){this.attrType="",this.attrValues=[],Object.assign(this,e)}}(0,so.__decorate)([se({type:A.ObjectIdentifier})],nL.prototype,"attrType",void 0),(0,so.__decorate)([se({type:A.Any,repeated:"set"})],nL.prototype,"attrValues",void 0);class nM{constructor(e={}){this.version=q.v0,this.sid=new nI,this.digestAlgorithm=new nT,this.signatureAlgorithm=new nP,this.signature=new iP,Object.assign(this,e)}}(0,so.__decorate)([se({type:A.Integer})],nM.prototype,"version",void 0),(0,so.__decorate)([se({type:nI})],nM.prototype,"sid",void 0),(0,so.__decorate)([se({type:nT})],nM.prototype,"digestAlgorithm",void 0),(0,so.__decorate)([se({type:nL,repeated:"set",context:0,implicit:!0,optional:!0,raw:!0})],nM.prototype,"signedAttrs",void 0),(0,so.__decorate)([se({type:nP})],nM.prototype,"signatureAlgorithm",void 0),(0,so.__decorate)([se({type:iP})],nM.prototype,"signature",void 0),(0,so.__decorate)([se({type:nL,repeated:"set",context:1,implicit:!0,optional:!0})],nM.prototype,"unsignedAttrs",void 0);let nH=G=class extends ss{constructor(e){super(e),Object.setPrototypeOf(this,G.prototype)}};nH=G=(0,so.__decorate)([i7({type:_.Set,itemType:nM})],nH);let nF=class extends nM{};nF=(0,so.__decorate)([i7({type:_.Sequence})],nF);let n$=class extends nw{};n$=(0,so.__decorate)([i7({type:_.Choice})],n$);class nz{constructor(e={}){this.acIssuer=new sg,this.acSerial=0,this.attrs=[],Object.assign(this,e)}}(0,so.__decorate)([se({type:sg})],nz.prototype,"acIssuer",void 0),(0,so.__decorate)([se({type:A.Integer})],nz.prototype,"acSerial",void 0),(0,so.__decorate)([se({type:nd,repeated:"sequence"})],nz.prototype,"attrs",void 0);let nK=J=class extends ss{constructor(e){super(e),Object.setPrototypeOf(this,J.prototype)}};nK=J=(0,so.__decorate)([i7({type:_.Sequence,itemType:A.ObjectIdentifier})],nK);class nW{constructor(e={}){this.permitUnSpecified=!0,Object.assign(this,e)}}(0,so.__decorate)([se({type:A.Integer,optional:!0})],nW.prototype,"pathLenConstraint",void 0),(0,so.__decorate)([se({type:nK,implicit:!0,context:0,optional:!0})],nW.prototype,"permittedAttrs",void 0),(0,so.__decorate)([se({type:nK,implicit:!0,context:1,optional:!0})],nW.prototype,"excludedAttrs",void 0),(0,so.__decorate)([se({type:A.Boolean,defaultValue:!0})],nW.prototype,"permitUnSpecified",void 0);class nq{constructor(e={}){this.issuer=new sP,this.serial=new ArrayBuffer(0),this.issuerUID=new ArrayBuffer(0),Object.assign(this,e)}}(0,so.__decorate)([se({type:sP})],nq.prototype,"issuer",void 0),(0,so.__decorate)([se({type:A.Integer,converter:iV})],nq.prototype,"serial",void 0),(0,so.__decorate)([se({type:A.BitString,optional:!0})],nq.prototype,"issuerUID",void 0),(d=Y||(Y={}))[d.publicKey=0]="publicKey",d[d.publicKeyCert=1]="publicKeyCert",d[d.otherObjectTypes=2]="otherObjectTypes";class nG{constructor(e={}){this.digestedObjectType=Y.publicKey,this.digestAlgorithm=new nx,this.objectDigest=new ArrayBuffer(0),Object.assign(this,e)}}(0,so.__decorate)([se({type:A.Enumerated})],nG.prototype,"digestedObjectType",void 0),(0,so.__decorate)([se({type:A.ObjectIdentifier,optional:!0})],nG.prototype,"otherObjectTypeID",void 0),(0,so.__decorate)([se({type:nx})],nG.prototype,"digestAlgorithm",void 0),(0,so.__decorate)([se({type:A.BitString})],nG.prototype,"objectDigest",void 0);class nJ{constructor(e={}){Object.assign(this,e)}}(0,so.__decorate)([se({type:sP,optional:!0})],nJ.prototype,"issuerName",void 0),(0,so.__decorate)([se({type:nq,context:0,implicit:!0,optional:!0})],nJ.prototype,"baseCertificateID",void 0),(0,so.__decorate)([se({type:nG,context:1,implicit:!0,optional:!0})],nJ.prototype,"objectDigestInfo",void 0);let nY=class{constructor(e={}){Object.assign(this,e)}};(0,so.__decorate)([se({type:sg,repeated:"sequence"})],nY.prototype,"v1Form",void 0),(0,so.__decorate)([se({type:nJ,context:0,implicit:!0})],nY.prototype,"v2Form",void 0),nY=(0,so.__decorate)([i7({type:_.Choice})],nY);class nZ{constructor(e={}){this.notBeforeTime=new Date,this.notAfterTime=new Date,Object.assign(this,e)}}(0,so.__decorate)([se({type:A.GeneralizedTime})],nZ.prototype,"notBeforeTime",void 0),(0,so.__decorate)([se({type:A.GeneralizedTime})],nZ.prototype,"notAfterTime",void 0);class nX{constructor(e={}){Object.assign(this,e)}}(0,so.__decorate)([se({type:nq,implicit:!0,context:0,optional:!0})],nX.prototype,"baseCertificateID",void 0),(0,so.__decorate)([se({type:sP,implicit:!0,context:1,optional:!0})],nX.prototype,"entityName",void 0),(0,so.__decorate)([se({type:nG,implicit:!0,context:2,optional:!0})],nX.prototype,"objectDigestInfo",void 0),(h=Z||(Z={}))[h.v2=1]="v2";class nQ{constructor(e={}){this.version=Z.v2,this.holder=new nX,this.issuer=new nY,this.signature=new nx,this.serialNumber=new ArrayBuffer(0),this.attrCertValidityPeriod=new nZ,this.attributes=[],Object.assign(this,e)}}(0,so.__decorate)([se({type:A.Integer})],nQ.prototype,"version",void 0),(0,so.__decorate)([se({type:nX})],nQ.prototype,"holder",void 0),(0,so.__decorate)([se({type:nY})],nQ.prototype,"issuer",void 0),(0,so.__decorate)([se({type:nx})],nQ.prototype,"signature",void 0),(0,so.__decorate)([se({type:A.Integer,converter:iV})],nQ.prototype,"serialNumber",void 0),(0,so.__decorate)([se({type:nZ})],nQ.prototype,"attrCertValidityPeriod",void 0),(0,so.__decorate)([se({type:nd,repeated:"sequence"})],nQ.prototype,"attributes",void 0),(0,so.__decorate)([se({type:A.BitString,optional:!0})],nQ.prototype,"issuerUniqueID",void 0),(0,so.__decorate)([se({type:nC,optional:!0})],nQ.prototype,"extensions",void 0);class n0{constructor(e={}){this.acinfo=new nQ,this.signatureAlgorithm=new nx,this.signatureValue=new ArrayBuffer(0),Object.assign(this,e)}}(0,so.__decorate)([se({type:nQ})],n0.prototype,"acinfo",void 0),(0,so.__decorate)([se({type:nx})],n0.prototype,"signatureAlgorithm",void 0),(0,so.__decorate)([se({type:A.BitString})],n0.prototype,"signatureValue",void 0),(f=X||(X={}))[f.unmarked=1]="unmarked",f[f.unclassified=2]="unclassified",f[f.restricted=4]="restricted",f[f.confidential=8]="confidential",f[f.secret=16]="secret",f[f.topSecret=32]="topSecret";class n1 extends iT{}class n2{constructor(e={}){this.type="",this.value=new ArrayBuffer(0),Object.assign(this,e)}}(0,so.__decorate)([se({type:A.ObjectIdentifier,implicit:!0,context:0})],n2.prototype,"type",void 0),(0,so.__decorate)([se({type:A.Any,implicit:!0,context:1})],n2.prototype,"value",void 0);class n4{constructor(e={}){this.policyId="",this.classList=new n1(X.unclassified),Object.assign(this,e)}}(0,so.__decorate)([se({type:A.ObjectIdentifier})],n4.prototype,"policyId",void 0),(0,so.__decorate)([se({type:n1,defaultValue:new n1(X.unclassified)})],n4.prototype,"classList",void 0),(0,so.__decorate)([se({type:n2,repeated:"set"})],n4.prototype,"securityCategories",void 0);class n8{constructor(e={}){Object.assign(this,e)}}(0,so.__decorate)([se({type:iP})],n8.prototype,"cotets",void 0),(0,so.__decorate)([se({type:A.ObjectIdentifier})],n8.prototype,"oid",void 0),(0,so.__decorate)([se({type:A.Utf8String})],n8.prototype,"string",void 0);class n5{constructor(e={}){this.values=[],Object.assign(this,e)}}(0,so.__decorate)([se({type:sP,implicit:!0,context:0,optional:!0})],n5.prototype,"policyAuthority",void 0),(0,so.__decorate)([se({type:n8,repeated:"sequence"})],n5.prototype,"values",void 0);class n6{constructor(e={}){this.targetCertificate=new nq,Object.assign(this,e)}}(0,so.__decorate)([se({type:nq})],n6.prototype,"targetCertificate",void 0),(0,so.__decorate)([se({type:sg,optional:!0})],n6.prototype,"targetName",void 0),(0,so.__decorate)([se({type:nG,optional:!0})],n6.prototype,"certDigestInfo",void 0);let n3=class{constructor(e={}){Object.assign(this,e)}};(0,so.__decorate)([se({type:sg,context:0,implicit:!0})],n3.prototype,"targetName",void 0),(0,so.__decorate)([se({type:sg,context:1,implicit:!0})],n3.prototype,"targetGroup",void 0),(0,so.__decorate)([se({type:n6,context:2,implicit:!0})],n3.prototype,"targetCert",void 0),n3=(0,so.__decorate)([i7({type:_.Choice})],n3);let n9=Q=class extends ss{constructor(e){super(e),Object.setPrototypeOf(this,Q.prototype)}};n9=Q=(0,so.__decorate)([i7({type:_.Sequence,itemType:n3})],n9);let n7=ee=class extends ss{constructor(e){super(e),Object.setPrototypeOf(this,ee.prototype)}};n7=ee=(0,so.__decorate)([i7({type:_.Sequence,itemType:n9})],n7);class oe{constructor(e={}){Object.assign(this,e)}}(0,so.__decorate)([se({type:sP,implicit:!0,context:0,optional:!0})],oe.prototype,"roleAuthority",void 0),(0,so.__decorate)([se({type:sg,implicit:!0,context:1})],oe.prototype,"roleName",void 0);class ot{constructor(e={}){this.service=new sg,this.ident=new sg,Object.assign(this,e)}}(0,so.__decorate)([se({type:sg})],ot.prototype,"service",void 0),(0,so.__decorate)([se({type:sg})],ot.prototype,"ident",void 0),(0,so.__decorate)([se({type:iP,optional:!0})],ot.prototype,"authInfo",void 0);class or{constructor(e={}){this.otherCertFormat="",this.otherCert=new ArrayBuffer(0),Object.assign(this,e)}}(0,so.__decorate)([se({type:A.ObjectIdentifier})],or.prototype,"otherCertFormat",void 0),(0,so.__decorate)([se({type:A.Any})],or.prototype,"otherCert",void 0);let oi=class{constructor(e={}){Object.assign(this,e)}};(0,so.__decorate)([se({type:nB})],oi.prototype,"certificate",void 0),(0,so.__decorate)([se({type:n0,context:2,implicit:!0})],oi.prototype,"v2AttrCert",void 0),(0,so.__decorate)([se({type:or,context:3,implicit:!0})],oi.prototype,"other",void 0),oi=(0,so.__decorate)([i7({type:_.Choice})],oi);let os=et=class extends ss{constructor(e){super(e),Object.setPrototypeOf(this,et.prototype)}};os=et=(0,so.__decorate)([i7({type:_.Set,itemType:oi})],os);class on{constructor(e={}){this.contentType="",this.content=new ArrayBuffer(0),Object.assign(this,e)}}(0,so.__decorate)([se({type:A.ObjectIdentifier})],on.prototype,"contentType",void 0),(0,so.__decorate)([se({type:A.Any,context:0})],on.prototype,"content",void 0);let oo=class{constructor(e={}){Object.assign(this,e)}};(0,so.__decorate)([se({type:iP})],oo.prototype,"single",void 0),(0,so.__decorate)([se({type:A.Any})],oo.prototype,"any",void 0),oo=(0,so.__decorate)([i7({type:_.Choice})],oo);class oa{constructor(e={}){this.eContentType="",Object.assign(this,e)}}(0,so.__decorate)([se({type:A.ObjectIdentifier})],oa.prototype,"eContentType",void 0),(0,so.__decorate)([se({type:oo,context:0,optional:!0})],oa.prototype,"eContent",void 0);let ol=class{constructor(e={}){Object.assign(this,e)}};(0,so.__decorate)([se({type:iP,context:0,implicit:!0,optional:!0})],ol.prototype,"value",void 0),(0,so.__decorate)([se({type:iP,converter:{fromASN:e=>new iP(e.getValue()),toASN:e=>e.toASN()},context:0,implicit:!0,optional:!0,repeated:"sequence"})],ol.prototype,"constructedValue",void 0),ol=(0,so.__decorate)([i7({type:_.Choice})],ol);class oc{constructor(e={}){this.contentType="",this.contentEncryptionAlgorithm=new nU,Object.assign(this,e)}}(0,so.__decorate)([se({type:A.ObjectIdentifier})],oc.prototype,"contentType",void 0),(0,so.__decorate)([se({type:nU})],oc.prototype,"contentEncryptionAlgorithm",void 0),(0,so.__decorate)([se({type:ol,optional:!0})],oc.prototype,"encryptedContent",void 0);class ou{constructor(e={}){this.keyAttrId="",Object.assign(this,e)}}(0,so.__decorate)([se({type:A.ObjectIdentifier})],ou.prototype,"keyAttrId",void 0),(0,so.__decorate)([se({type:A.Any,optional:!0})],ou.prototype,"keyAttr",void 0);class op{constructor(e={}){this.subjectKeyIdentifier=new ny,Object.assign(this,e)}}(0,so.__decorate)([se({type:ny})],op.prototype,"subjectKeyIdentifier",void 0),(0,so.__decorate)([se({type:A.GeneralizedTime,optional:!0})],op.prototype,"date",void 0),(0,so.__decorate)([se({type:ou,optional:!0})],op.prototype,"other",void 0);let od=class{constructor(e={}){Object.assign(this,e)}};(0,so.__decorate)([se({type:op,context:0,implicit:!0,optional:!0})],od.prototype,"rKeyId",void 0),(0,so.__decorate)([se({type:nO,optional:!0})],od.prototype,"issuerAndSerialNumber",void 0),od=(0,so.__decorate)([i7({type:_.Choice})],od);class oh{constructor(e={}){this.rid=new od,this.encryptedKey=new iP,Object.assign(this,e)}}(0,so.__decorate)([se({type:od})],oh.prototype,"rid",void 0),(0,so.__decorate)([se({type:iP})],oh.prototype,"encryptedKey",void 0);let of=er=class extends ss{constructor(e){super(e),Object.setPrototypeOf(this,er.prototype)}};of=er=(0,so.__decorate)([i7({type:_.Sequence,itemType:oh})],of);class oy{constructor(e={}){this.algorithm=new nx,this.publicKey=new ArrayBuffer(0),Object.assign(this,e)}}(0,so.__decorate)([se({type:nx})],oy.prototype,"algorithm",void 0),(0,so.__decorate)([se({type:A.BitString})],oy.prototype,"publicKey",void 0);let og=class{constructor(e={}){Object.assign(this,e)}};(0,so.__decorate)([se({type:ny,context:0,implicit:!0,optional:!0})],og.prototype,"subjectKeyIdentifier",void 0),(0,so.__decorate)([se({type:oy,context:1,implicit:!0,optional:!0})],og.prototype,"originatorKey",void 0),(0,so.__decorate)([se({type:nO,optional:!0})],og.prototype,"issuerAndSerialNumber",void 0),og=(0,so.__decorate)([i7({type:_.Choice})],og);class om{constructor(e={}){this.version=q.v3,this.originator=new og,this.keyEncryptionAlgorithm=new nD,this.recipientEncryptedKeys=new of,Object.assign(this,e)}}(0,so.__decorate)([se({type:A.Integer})],om.prototype,"version",void 0),(0,so.__decorate)([se({type:og,context:0})],om.prototype,"originator",void 0),(0,so.__decorate)([se({type:iP,context:1,optional:!0})],om.prototype,"ukm",void 0),(0,so.__decorate)([se({type:nD})],om.prototype,"keyEncryptionAlgorithm",void 0),(0,so.__decorate)([se({type:of})],om.prototype,"recipientEncryptedKeys",void 0);let ov=class{constructor(e={}){Object.assign(this,e)}};(0,so.__decorate)([se({type:ny,context:0,implicit:!0})],ov.prototype,"subjectKeyIdentifier",void 0),(0,so.__decorate)([se({type:nO})],ov.prototype,"issuerAndSerialNumber",void 0),ov=(0,so.__decorate)([i7({type:_.Choice})],ov);class ob{constructor(e={}){this.version=q.v0,this.rid=new ov,this.keyEncryptionAlgorithm=new nD,this.encryptedKey=new iP,Object.assign(this,e)}}(0,so.__decorate)([se({type:A.Integer})],ob.prototype,"version",void 0),(0,so.__decorate)([se({type:ov})],ob.prototype,"rid",void 0),(0,so.__decorate)([se({type:nD})],ob.prototype,"keyEncryptionAlgorithm",void 0),(0,so.__decorate)([se({type:iP})],ob.prototype,"encryptedKey",void 0);class ox{constructor(e={}){this.keyIdentifier=new iP,Object.assign(this,e)}}(0,so.__decorate)([se({type:iP})],ox.prototype,"keyIdentifier",void 0),(0,so.__decorate)([se({type:A.GeneralizedTime,optional:!0})],ox.prototype,"date",void 0),(0,so.__decorate)([se({type:ou,optional:!0})],ox.prototype,"other",void 0);class oS{constructor(e={}){this.version=q.v4,this.kekid=new ox,this.keyEncryptionAlgorithm=new nD,this.encryptedKey=new iP,Object.assign(this,e)}}(0,so.__decorate)([se({type:A.Integer})],oS.prototype,"version",void 0),(0,so.__decorate)([se({type:ox})],oS.prototype,"kekid",void 0),(0,so.__decorate)([se({type:nD})],oS.prototype,"keyEncryptionAlgorithm",void 0),(0,so.__decorate)([se({type:iP})],oS.prototype,"encryptedKey",void 0);class ow{constructor(e={}){this.version=q.v0,this.keyEncryptionAlgorithm=new nD,this.encryptedKey=new iP,Object.assign(this,e)}}(0,so.__decorate)([se({type:A.Integer})],ow.prototype,"version",void 0),(0,so.__decorate)([se({type:nV,context:0,optional:!0})],ow.prototype,"keyDerivationAlgorithm",void 0),(0,so.__decorate)([se({type:nD})],ow.prototype,"keyEncryptionAlgorithm",void 0),(0,so.__decorate)([se({type:iP})],ow.prototype,"encryptedKey",void 0);class o_{constructor(e={}){this.oriType="",this.oriValue=new ArrayBuffer(0),Object.assign(this,e)}}(0,so.__decorate)([se({type:A.ObjectIdentifier})],o_.prototype,"oriType",void 0),(0,so.__decorate)([se({type:A.Any})],o_.prototype,"oriValue",void 0);let oA=class{constructor(e={}){Object.assign(this,e)}};(0,so.__decorate)([se({type:ob,optional:!0})],oA.prototype,"ktri",void 0),(0,so.__decorate)([se({type:om,context:1,implicit:!0,optional:!0})],oA.prototype,"kari",void 0),(0,so.__decorate)([se({type:oS,context:2,implicit:!0,optional:!0})],oA.prototype,"kekri",void 0),(0,so.__decorate)([se({type:ow,context:3,implicit:!0,optional:!0})],oA.prototype,"pwri",void 0),(0,so.__decorate)([se({type:o_,context:4,implicit:!0,optional:!0})],oA.prototype,"ori",void 0),oA=(0,so.__decorate)([i7({type:_.Choice})],oA);let oC=ei=class extends ss{constructor(e){super(e),Object.setPrototypeOf(this,ei.prototype)}};oC=ei=(0,so.__decorate)([i7({type:_.Set,itemType:oA})],oC);class ok{constructor(e={}){this.otherRevInfoFormat="",this.otherRevInfo=new ArrayBuffer(0),Object.assign(this,e)}}(0,so.__decorate)([se({type:A.ObjectIdentifier})],ok.prototype,"otherRevInfoFormat",void 0),(0,so.__decorate)([se({type:A.Any})],ok.prototype,"otherRevInfo",void 0);let oB=class{constructor(e={}){this.other=new ok,Object.assign(this,e)}};(0,so.__decorate)([se({type:ok,context:1,implicit:!0})],oB.prototype,"other",void 0),oB=(0,so.__decorate)([i7({type:_.Choice})],oB);let oN=es=class extends ss{constructor(e){super(e),Object.setPrototypeOf(this,es.prototype)}};oN=es=(0,so.__decorate)([i7({type:_.Set,itemType:oB})],oN);class oj{constructor(e={}){Object.assign(this,e)}}(0,so.__decorate)([se({type:os,context:0,implicit:!0,optional:!0})],oj.prototype,"certs",void 0),(0,so.__decorate)([se({type:oN,context:1,implicit:!0,optional:!0})],oj.prototype,"crls",void 0);let oE=en=class extends ss{constructor(e){super(e),Object.setPrototypeOf(this,en.prototype)}};oE=en=(0,so.__decorate)([i7({type:_.Set,itemType:nL})],oE);class oO{constructor(e={}){this.version=q.v0,this.recipientInfos=new oC,this.encryptedContentInfo=new oc,Object.assign(this,e)}}(0,so.__decorate)([se({type:A.Integer})],oO.prototype,"version",void 0),(0,so.__decorate)([se({type:oj,context:0,implicit:!0,optional:!0})],oO.prototype,"originatorInfo",void 0),(0,so.__decorate)([se({type:oC})],oO.prototype,"recipientInfos",void 0),(0,so.__decorate)([se({type:oc})],oO.prototype,"encryptedContentInfo",void 0),(0,so.__decorate)([se({type:oE,context:1,implicit:!0,optional:!0})],oO.prototype,"unprotectedAttrs",void 0);let oI=eo=class extends ss{constructor(e){super(e),Object.setPrototypeOf(this,eo.prototype)}};oI=eo=(0,so.__decorate)([i7({type:_.Set,itemType:nT})],oI);class oT{constructor(e={}){this.version=q.v0,this.digestAlgorithms=new oI,this.encapContentInfo=new oa,this.signerInfos=new nH,Object.assign(this,e)}}(0,so.__decorate)([se({type:A.Integer})],oT.prototype,"version",void 0),(0,so.__decorate)([se({type:oI})],oT.prototype,"digestAlgorithms",void 0),(0,so.__decorate)([se({type:oa})],oT.prototype,"encapContentInfo",void 0),(0,so.__decorate)([se({type:os,context:0,implicit:!0,optional:!0})],oT.prototype,"certificates",void 0),(0,so.__decorate)([se({type:oN,context:1,implicit:!0,optional:!0})],oT.prototype,"crls",void 0),(0,so.__decorate)([se({type:nH})],oT.prototype,"signerInfos",void 0);let oP="1.2.840.10045.2.1",oD="1.2.840.10045.4.1",oU="1.2.840.10045.4.3.1",oR="1.2.840.10045.4.3.2",oV="1.2.840.10045.4.3.3",oL="1.2.840.10045.4.3.4",oM="1.2.840.10045.3.1.7",oH="1.3.132.0.34",oF="1.3.132.0.35";function o$(e){return new nx({algorithm:e})}let oz=o$(oD);o$(oU);let oK=o$(oR),oW=o$(oV),oq=o$(oL),oG=class{constructor(e={}){Object.assign(this,e)}};(0,so.__decorate)([se({type:A.ObjectIdentifier})],oG.prototype,"fieldType",void 0),(0,so.__decorate)([se({type:A.Any})],oG.prototype,"parameters",void 0),oG=(0,so.__decorate)([i7({type:_.Sequence})],oG);let oJ=class{constructor(e={}){Object.assign(this,e)}};(0,so.__decorate)([se({type:A.OctetString})],oJ.prototype,"a",void 0),(0,so.__decorate)([se({type:A.OctetString})],oJ.prototype,"b",void 0),(0,so.__decorate)([se({type:A.BitString,optional:!0})],oJ.prototype,"seed",void 0),oJ=(0,so.__decorate)([i7({type:_.Sequence})],oJ),(y=ea||(ea={}))[y.ecpVer1=1]="ecpVer1";let oY=class{constructor(e={}){this.version=ea.ecpVer1,Object.assign(this,e)}};(0,so.__decorate)([se({type:A.Integer})],oY.prototype,"version",void 0),(0,so.__decorate)([se({type:oG})],oY.prototype,"fieldID",void 0),(0,so.__decorate)([se({type:oJ})],oY.prototype,"curve",void 0),(0,so.__decorate)([se({type:class extends iP{}})],oY.prototype,"base",void 0),(0,so.__decorate)([se({type:A.Integer,converter:iV})],oY.prototype,"order",void 0),(0,so.__decorate)([se({type:A.Integer,optional:!0})],oY.prototype,"cofactor",void 0),oY=(0,so.__decorate)([i7({type:_.Sequence})],oY);let oZ=class{constructor(e={}){Object.assign(this,e)}};(0,so.__decorate)([se({type:A.ObjectIdentifier})],oZ.prototype,"namedCurve",void 0),(0,so.__decorate)([se({type:A.Null})],oZ.prototype,"implicitCurve",void 0),(0,so.__decorate)([se({type:oY})],oZ.prototype,"specifiedCurve",void 0),oZ=(0,so.__decorate)([i7({type:_.Choice})],oZ);class oX{constructor(e={}){this.version=1,this.privateKey=new iP,Object.assign(this,e)}}(0,so.__decorate)([se({type:A.Integer})],oX.prototype,"version",void 0),(0,so.__decorate)([se({type:iP})],oX.prototype,"privateKey",void 0),(0,so.__decorate)([se({type:oZ,context:0,optional:!0})],oX.prototype,"parameters",void 0),(0,so.__decorate)([se({type:A.BitString,context:1,optional:!0})],oX.prototype,"publicKey",void 0);class oQ{constructor(e={}){this.r=new ArrayBuffer(0),this.s=new ArrayBuffer(0),Object.assign(this,e)}}(0,so.__decorate)([se({type:A.Integer,converter:iV})],oQ.prototype,"r",void 0),(0,so.__decorate)([se({type:A.Integer,converter:iV})],oQ.prototype,"s",void 0);let o0="1.2.840.113549.1.1",o1=`${o0}.1`,o2=`${o0}.7`,o4=`${o0}.9`,o8=`${o0}.10`,o5=`${o0}.2`,o6=`${o0}.4`,o3=`${o0}.5`,o9=`${o0}.14`,o7=`${o0}.11`,ae=`${o0}.12`,at=`${o0}.13`,ar=`${o0}.15`,ai=`${o0}.16`,as="1.3.14.3.2.26",an="2.16.840.1.101.3.4.2.4",ao="2.16.840.1.101.3.4.2.1",aa="2.16.840.1.101.3.4.2.2",al="2.16.840.1.101.3.4.2.3",ac=`${o0}.8`;function au(e){return new nx({algorithm:e,parameters:null})}au("1.2.840.113549.2.2"),au("1.2.840.113549.2.5");let ap=au(as);au(an),au(ao),au(aa),au(al),au("2.16.840.1.101.3.4.2.5"),au("2.16.840.1.101.3.4.2.6");let ad=new nx({algorithm:ac,parameters:sn.serialize(ap)}),ah=new nx({algorithm:o4,parameters:sn.serialize(iF.toASN(new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]).buffer))});au(o1),au(o5),au(o6),au(o3),au(ar),au(ai),au(ae),au(at),au(ar),au(ai);class af{constructor(e={}){this.hashAlgorithm=new nx(ap),this.maskGenAlgorithm=new nx({algorithm:ac,parameters:sn.serialize(ap)}),this.pSourceAlgorithm=new nx(ah),Object.assign(this,e)}}(0,so.__decorate)([se({type:nx,context:0,defaultValue:ap})],af.prototype,"hashAlgorithm",void 0),(0,so.__decorate)([se({type:nx,context:1,defaultValue:ad})],af.prototype,"maskGenAlgorithm",void 0),(0,so.__decorate)([se({type:nx,context:2,defaultValue:ah})],af.prototype,"pSourceAlgorithm",void 0),new nx({algorithm:o2,parameters:sn.serialize(new af)});class ay{constructor(e={}){this.hashAlgorithm=new nx(ap),this.maskGenAlgorithm=new nx({algorithm:ac,parameters:sn.serialize(ap)}),this.saltLength=20,this.trailerField=1,Object.assign(this,e)}}(0,so.__decorate)([se({type:nx,context:0,defaultValue:ap})],ay.prototype,"hashAlgorithm",void 0),(0,so.__decorate)([se({type:nx,context:1,defaultValue:ad})],ay.prototype,"maskGenAlgorithm",void 0),(0,so.__decorate)([se({type:A.Integer,context:2,defaultValue:20})],ay.prototype,"saltLength",void 0),(0,so.__decorate)([se({type:A.Integer,context:3,defaultValue:1})],ay.prototype,"trailerField",void 0),new nx({algorithm:o8,parameters:sn.serialize(new ay)});class ag{constructor(e={}){this.digestAlgorithm=new nx,this.digest=new iP,Object.assign(this,e)}}(0,so.__decorate)([se({type:nx})],ag.prototype,"digestAlgorithm",void 0),(0,so.__decorate)([se({type:iP})],ag.prototype,"digest",void 0);class am{constructor(e={}){this.prime=new ArrayBuffer(0),this.exponent=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,e)}}(0,so.__decorate)([se({type:A.Integer,converter:iV})],am.prototype,"prime",void 0),(0,so.__decorate)([se({type:A.Integer,converter:iV})],am.prototype,"exponent",void 0),(0,so.__decorate)([se({type:A.Integer,converter:iV})],am.prototype,"coefficient",void 0);let av=el=class extends ss{constructor(e){super(e),Object.setPrototypeOf(this,el.prototype)}};av=el=(0,so.__decorate)([i7({type:_.Sequence,itemType:am})],av);class ab{constructor(e={}){this.version=0,this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),this.privateExponent=new ArrayBuffer(0),this.prime1=new ArrayBuffer(0),this.prime2=new ArrayBuffer(0),this.exponent1=new ArrayBuffer(0),this.exponent2=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,e)}}(0,so.__decorate)([se({type:A.Integer})],ab.prototype,"version",void 0),(0,so.__decorate)([se({type:A.Integer,converter:iV})],ab.prototype,"modulus",void 0),(0,so.__decorate)([se({type:A.Integer,converter:iV})],ab.prototype,"publicExponent",void 0),(0,so.__decorate)([se({type:A.Integer,converter:iV})],ab.prototype,"privateExponent",void 0),(0,so.__decorate)([se({type:A.Integer,converter:iV})],ab.prototype,"prime1",void 0),(0,so.__decorate)([se({type:A.Integer,converter:iV})],ab.prototype,"prime2",void 0),(0,so.__decorate)([se({type:A.Integer,converter:iV})],ab.prototype,"exponent1",void 0),(0,so.__decorate)([se({type:A.Integer,converter:iV})],ab.prototype,"exponent2",void 0),(0,so.__decorate)([se({type:A.Integer,converter:iV})],ab.prototype,"coefficient",void 0),(0,so.__decorate)([se({type:av,optional:!0})],ab.prototype,"otherPrimeInfos",void 0);class ax{constructor(e={}){this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),Object.assign(this,e)}}(0,so.__decorate)([se({type:A.Integer,converter:iV})],ax.prototype,"modulus",void 0),(0,so.__decorate)([se({type:A.Integer,converter:iV})],ax.prototype,"publicExponent",void 0),(g=ec||(ec={}))[g.Transient=0]="Transient",g[g.Singleton=1]="Singleton",g[g.ResolutionScoped=2]="ResolutionScoped",g[g.ContainerScoped=3]="ContainerScoped";let aS=ec;var aw=function(e,t){return(aw=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function a_(e,t){function r(){this.constructor=e}aw(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function aA(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function aC(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,s,n=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(e){s={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return o}function ak(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(aC(arguments[t]));return e}function aB(e){return!!e.useClass}function aN(e){return!!e.useFactory}var aj=function(){function e(e){this.wrap=e,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}return e.prototype.createProxy=function(e){var t,r=this,i=!1;return new Proxy({},this.createHandler(function(){return i||(t=e(r.wrap()),i=!0),t}))},e.prototype.createHandler=function(e){var t={};return this.reflectMethods.forEach(function(r){t[r]=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return t[0]=e(),Reflect[r].apply(void 0,ak(t))}}),t},e}();function aE(e){return"string"==typeof e||"symbol"==typeof e}function aO(e){return"object"==typeof e&&"token"in e&&"transform"in e}function aI(e){return!!e.useToken}function aT(e){return void 0!=e.useValue}var aP=function(){function e(){this._registryMap=new Map}return e.prototype.entries=function(){return this._registryMap.entries()},e.prototype.getAll=function(e){return this.ensure(e),this._registryMap.get(e)},e.prototype.get=function(e){this.ensure(e);var t=this._registryMap.get(e);return t[t.length-1]||null},e.prototype.set=function(e,t){this.ensure(e),this._registryMap.get(e).push(t)},e.prototype.setAll=function(e,t){this._registryMap.set(e,t)},e.prototype.has=function(e){return this.ensure(e),this._registryMap.get(e).length>0},e.prototype.clear=function(){this._registryMap.clear()},e.prototype.ensure=function(e){this._registryMap.has(e)||this._registryMap.set(e,[])},e}(),aD=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a_(t,e),t}(aP);let aU=function(){this.scopedResolutions=new Map};var aR=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a_(t,e),t}(aP),aV=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a_(t,e),t}(aP);let aL=function(){this.preResolution=new aR,this.postResolution=new aV};var aM=new Map,aH=new(function(){function e(e){this.parent=e,this._registry=new aD,this.interceptors=new aL,this.disposed=!1,this.disposables=new Set}return e.prototype.register=function(e,t,r){if(void 0===r&&(r={lifecycle:aS.Transient}),this.ensureNotDisposed(),i=aB(t)||aT(t)||aI(t)||aN(t)?t:{useClass:t},aI(i))for(var i,s=[e],n=i;null!=n;){var o=n.useToken;if(s.includes(o))throw Error("Token registration cycle detected! "+ak(s,[o]).join(" -> "));s.push(o);var a=this._registry.get(o);n=a&&aI(a.provider)?a.provider:null}if((r.lifecycle===aS.Singleton||r.lifecycle==aS.ContainerScoped||r.lifecycle==aS.ResolutionScoped)&&(aT(i)||aN(i)))throw Error('Cannot use lifecycle "'+aS[r.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(e,{provider:i,options:r}),this},e.prototype.registerType=function(e,t){return(this.ensureNotDisposed(),aE(t))?this.register(e,{useToken:t}):this.register(e,{useClass:t})},e.prototype.registerInstance=function(e,t){return this.ensureNotDisposed(),this.register(e,{useValue:t})},e.prototype.registerSingleton=function(e,t){if(this.ensureNotDisposed(),aE(e)){if(aE(t))return this.register(e,{useToken:t},{lifecycle:aS.Singleton});if(t)return this.register(e,{useClass:t},{lifecycle:aS.Singleton});throw Error('Cannot register a type name as a singleton without a "to" token')}var r=e;return t&&!aE(t)&&(r=t),this.register(e,{useClass:r},{lifecycle:aS.Singleton})},e.prototype.resolve=function(e,t,r){void 0===t&&(t=new aU),void 0===r&&(r=!1),this.ensureNotDisposed();var i=this.getRegistration(e);if(!i&&aE(e)){if(r)return;throw Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"')}if(this.executePreResolutionInterceptor(e,"Single"),i){var s=this.resolveRegistration(i,t);return this.executePostResolutionInterceptor(e,s,"Single"),s}if("function"==typeof e||e instanceof aj){var s=this.construct(e,t);return this.executePostResolutionInterceptor(e,s,"Single"),s}throw Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},e.prototype.executePreResolutionInterceptor=function(e,t){var r,i;if(this.interceptors.preResolution.has(e)){var s=[];try{for(var n=aA(this.interceptors.preResolution.getAll(e)),o=n.next();!o.done;o=n.next()){var a=o.value;"Once"!=a.options.frequency&&s.push(a),a.callback(e,t)}}catch(e){r={error:e}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(r)throw r.error}}this.interceptors.preResolution.setAll(e,s)}},e.prototype.executePostResolutionInterceptor=function(e,t,r){var i,s;if(this.interceptors.postResolution.has(e)){var n=[];try{for(var o=aA(this.interceptors.postResolution.getAll(e)),a=o.next();!a.done;a=o.next()){var l=a.value;"Once"!=l.options.frequency&&n.push(l),l.callback(e,t,r)}}catch(e){i={error:e}}finally{try{a&&!a.done&&(s=o.return)&&s.call(o)}finally{if(i)throw i.error}}this.interceptors.postResolution.setAll(e,n)}},e.prototype.resolveRegistration=function(e,t){if(this.ensureNotDisposed(),e.options.lifecycle===aS.ResolutionScoped&&t.scopedResolutions.has(e))return t.scopedResolutions.get(e);var r,i=e.options.lifecycle===aS.Singleton,s=e.options.lifecycle===aS.ContainerScoped,n=i||s;return r=aT(e.provider)?e.provider.useValue:aI(e.provider)?n?e.instance||(e.instance=this.resolve(e.provider.useToken,t)):this.resolve(e.provider.useToken,t):aB(e.provider)?n?e.instance||(e.instance=this.construct(e.provider.useClass,t)):this.construct(e.provider.useClass,t):aN(e.provider)?e.provider.useFactory(this):this.construct(e.provider,t),e.options.lifecycle===aS.ResolutionScoped&&t.scopedResolutions.set(e,r),r},e.prototype.resolveAll=function(e,t,r){var i=this;void 0===t&&(t=new aU),void 0===r&&(r=!1),this.ensureNotDisposed();var s=this.getAllRegistrations(e);if(!s&&aE(e)){if(r)return[];throw Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"')}if(this.executePreResolutionInterceptor(e,"All"),s){var n=s.map(function(e){return i.resolveRegistration(e,t)});return this.executePostResolutionInterceptor(e,n,"All"),n}var o=[this.construct(e,t)];return this.executePostResolutionInterceptor(e,o,"All"),o},e.prototype.isRegistered=function(e,t){return void 0===t&&(t=!1),this.ensureNotDisposed(),this._registry.has(e)||t&&(this.parent||!1)&&this.parent.isRegistered(e,!0)},e.prototype.reset=function(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},e.prototype.clearInstances=function(){var e,t;this.ensureNotDisposed();try{for(var r=aA(this._registry.entries()),i=r.next();!i.done;i=r.next()){var s=aC(i.value,2),n=s[0],o=s[1];this._registry.setAll(n,o.filter(function(e){return!aT(e.provider)}).map(function(e){return e.instance=void 0,e}))}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},e.prototype.createChildContainer=function(){this.ensureNotDisposed();var t,r,i=new e(this);try{for(var s=aA(this._registry.entries()),n=s.next();!n.done;n=s.next()){var o=aC(n.value,2),a=o[0],l=o[1];l.some(function(e){return e.options.lifecycle===aS.ContainerScoped})&&i._registry.setAll(a,l.map(function(e){return e.options.lifecycle===aS.ContainerScoped?{provider:e.provider,options:e.options}:e}))}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}return i},e.prototype.beforeResolution=function(e,t,r){void 0===r&&(r={frequency:"Always"}),this.interceptors.preResolution.set(e,{callback:t,options:r})},e.prototype.afterResolution=function(e,t,r){void 0===r&&(r={frequency:"Always"}),this.interceptors.postResolution.set(e,{callback:t,options:r})},e.prototype.dispose=function(){var e,t,r,i;return e=this,t=void 0,r=void 0,i=function(){var e;return function(e,t){var r,i,s,n,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){var l=[n,a];if(r)throw TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(s=2&l[0]?i.return:l[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,l[1])).done)return s;switch(i=0,s&&(l=[2&l[0],s.value]),l[0]){case 0:case 1:s=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,i=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!s||l[1]>s[0]&&l[1]<s[3])){o.label=l[1];break}if(6===l[0]&&o.label<s[1]){o.label=s[1],s=l;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(l);break}s[2]&&o.ops.pop(),o.trys.pop();continue}l=t.call(e,o)}catch(e){l=[6,e],i=0}finally{r=s=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}(this,function(t){switch(t.label){case 0:return this.disposed=!0,e=[],this.disposables.forEach(function(t){var r=t.dispose();r&&e.push(r)}),[4,Promise.all(e)];case 1:return t.sent(),[2]}})},new(r||(r=Promise))(function(s,n){function o(e){try{l(i.next(e))}catch(e){n(e)}}function a(e){try{l(i.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?s(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(o,a)}l((i=i.apply(e,t||[])).next())})},e.prototype.getRegistration=function(e){return this.isRegistered(e)?this._registry.get(e):this.parent?this.parent.getRegistration(e):null},e.prototype.getAllRegistrations=function(e){return this.isRegistered(e)?this._registry.getAll(e):this.parent?this.parent.getAllRegistrations(e):null},e.prototype.construct=function(e,t){var r=this;if(e instanceof aj)return e.createProxy(function(e){return r.resolve(e,t)});var i=function(){var i=aM.get(e);if(!i||0===i.length)if(0===e.length)return new e;else throw Error('TypeInfo not known for "'+e.name+'"');var s=i.map(r.resolveParams(t,e));return new(e.bind.apply(e,ak([void 0],s)))}();return"function"!=typeof i.dispose||i.dispose.length>0||this.disposables.add(i),i},e.prototype.resolveParams=function(e,t){var r=this;return function(i,s){var n,o,a,l,c,u,p;try{if("object"==typeof i&&"token"in i&&"multiple"in i)if(aO(i))return i.multiple?(n=r.resolve(i.transform)).transform.apply(n,ak([r.resolveAll(i.token,new aU,i.isOptional)],i.transformArgs)):(o=r.resolve(i.transform)).transform.apply(o,ak([r.resolve(i.token,e,i.isOptional)],i.transformArgs));else return i.multiple?r.resolveAll(i.token,new aU,i.isOptional):r.resolve(i.token,e,i.isOptional);if(aO(i))return(a=r.resolve(i.transform,e)).transform.apply(a,ak([r.resolve(i.token,e)],i.transformArgs));return r.resolve(i,e)}catch(e){throw Error((u="Cannot inject the dependency "+(c=void 0===(l=aC(t.toString().match(/constructor\(([\w, ]+)\)/)||[],2)[1])?null:l,null===c?"at position #"+s:'"'+c.split(",")[s].trim()+'" at position #'+s)+' of "'+t.name+'" constructor. Reason:',void 0===p&&(p="    "),ak([u],e.message.split("\n").map(function(e){return p+e})).join("\n")))}}},e.prototype.ensureNotDisposed=function(){if(this.disposed)throw Error("This container has been disposed, you cannot interact with a disposed container")},e}());let aF=function(e){return function(t){var r,i;aM.set(t,(r=Reflect.getMetadata("design:paramtypes",t)||[],Object.keys(i=Reflect.getOwnMetadata("injectionTokens",t)||{}).forEach(function(e){r[+e]=i[e]}),r)),e&&e.token&&(Array.isArray(e.token)?e.token.forEach(function(e){aH.register(e,t)}):aH.register(e.token,t))}};if(e.s([],68370),"undefined"==typeof Reflect||!Reflect.getMetadata)throw Error("tsyringe requires a reflect polyfill. Please add 'import \"reflect-metadata\"' to the top of your entry point.");e.i(68370);class a${constructor(e={}){this.attrId="",this.attrValues=[],Object.assign(e)}}(0,so.__decorate)([se({type:A.ObjectIdentifier})],a$.prototype,"attrId",void 0),(0,so.__decorate)([se({type:A.Any,repeated:"set"})],a$.prototype,"attrValues",void 0);let az=eu=class extends ss{constructor(e){super(e),Object.setPrototypeOf(this,eu.prototype)}};az=eu=(0,so.__decorate)([i7({type:_.Sequence,itemType:a$})],az);let aK=ep=class extends ss{constructor(e){super(e),Object.setPrototypeOf(this,ep.prototype)}};aK=ep=(0,so.__decorate)([i7({type:_.Sequence,itemType:on})],aK);class aW{constructor(e={}){this.certId="",this.certValue=new ArrayBuffer(0),Object.assign(this,e)}}(0,so.__decorate)([se({type:A.ObjectIdentifier})],aW.prototype,"certId",void 0),(0,so.__decorate)([se({type:A.Any,context:0})],aW.prototype,"certValue",void 0);class aq{constructor(e={}){this.crlId="",this.crltValue=new ArrayBuffer(0),Object.assign(this,e)}}(0,so.__decorate)([se({type:A.ObjectIdentifier})],aq.prototype,"crlId",void 0),(0,so.__decorate)([se({type:A.Any,context:0})],aq.prototype,"crltValue",void 0);class aG extends iP{}class aJ{constructor(e={}){this.encryptionAlgorithm=new nx,this.encryptedData=new aG,Object.assign(this,e)}}(0,so.__decorate)([se({type:nx})],aJ.prototype,"encryptionAlgorithm",void 0),(0,so.__decorate)([se({type:aG})],aJ.prototype,"encryptedData",void 0),(m=eh||(eh={}))[m.v1=0]="v1";class aY extends iP{}let aZ=ed=class extends ss{constructor(e){super(e),Object.setPrototypeOf(this,ed.prototype)}};aZ=ed=(0,so.__decorate)([i7({type:_.Sequence,itemType:nd})],aZ);class aX{constructor(e={}){this.version=eh.v1,this.privateKeyAlgorithm=new nx,this.privateKey=new aY,Object.assign(this,e)}}(0,so.__decorate)([se({type:A.Integer})],aX.prototype,"version",void 0),(0,so.__decorate)([se({type:nx})],aX.prototype,"privateKeyAlgorithm",void 0),(0,so.__decorate)([se({type:aY})],aX.prototype,"privateKey",void 0),(0,so.__decorate)([se({type:aZ,implicit:!0,context:0,optional:!0})],aX.prototype,"attributes",void 0);let aQ=class extends aX{};aQ=(0,so.__decorate)([i7({type:_.Sequence})],aQ);let a0=class extends aJ{};a0=(0,so.__decorate)([i7({type:_.Sequence})],a0);class a1{constructor(e={}){this.secretTypeId="",this.secretValue=new ArrayBuffer(0),Object.assign(this,e)}}(0,so.__decorate)([se({type:A.ObjectIdentifier})],a1.prototype,"secretTypeId",void 0),(0,so.__decorate)([se({type:A.Any,context:0})],a1.prototype,"secretValue",void 0);class a2{constructor(e={}){this.mac=new ag,this.macSalt=new iP,this.iterations=1,Object.assign(this,e)}}(0,so.__decorate)([se({type:ag})],a2.prototype,"mac",void 0),(0,so.__decorate)([se({type:iP})],a2.prototype,"macSalt",void 0),(0,so.__decorate)([se({type:A.Integer,defaultValue:1})],a2.prototype,"iterations",void 0);class a4{constructor(e={}){this.version=3,this.authSafe=new on,this.macData=new a2,Object.assign(this,e)}}(0,so.__decorate)([se({type:A.Integer})],a4.prototype,"version",void 0),(0,so.__decorate)([se({type:on})],a4.prototype,"authSafe",void 0),(0,so.__decorate)([se({type:a2,optional:!0})],a4.prototype,"macData",void 0);class a8{constructor(e={}){this.bagId="",this.bagValue=new ArrayBuffer(0),Object.assign(this,e)}}(0,so.__decorate)([se({type:A.ObjectIdentifier})],a8.prototype,"bagId",void 0),(0,so.__decorate)([se({type:A.Any,context:0})],a8.prototype,"bagValue",void 0),(0,so.__decorate)([se({type:a$,repeated:"set",optional:!0})],a8.prototype,"bagAttributes",void 0);let a5=ef=class extends ss{constructor(e){super(e),Object.setPrototypeOf(this,ef.prototype)}};a5=ef=(0,so.__decorate)([i7({type:_.Sequence,itemType:a8})],a5);let a6="1.2.840.113549.1.9",a3=`${a6}.7`,a9=`${a6}.14`,a7=class extends sl{constructor(e={}){super(e)}toString(){return({}).toString(),this.ia5String||super.toString()}};(0,so.__decorate)([se({type:A.IA5String})],a7.prototype,"ia5String",void 0),a7=(0,so.__decorate)([i7({type:_.Choice})],a7);let le=class extends on{};le=(0,so.__decorate)([i7({type:_.Sequence})],le);let lt=class extends a4{};lt=(0,so.__decorate)([i7({type:_.Sequence})],lt);let lr=class extends aJ{};lr=(0,so.__decorate)([i7({type:_.Sequence})],lr);let li=class{constructor(e=""){this.value=e}toString(){return this.value}};(0,so.__decorate)([se({type:A.IA5String})],li.prototype,"value",void 0),li=(0,so.__decorate)([i7({type:_.Choice})],li);let ls=class extends a7{};ls=(0,so.__decorate)([i7({type:_.Choice})],ls);let ln=class extends sl{};ln=(0,so.__decorate)([i7({type:_.Choice})],ln);let lo=class{constructor(e=new Date){this.value=e}};(0,so.__decorate)([se({type:A.GeneralizedTime})],lo.prototype,"value",void 0),lo=(0,so.__decorate)([i7({type:_.Choice})],lo);let la=class extends sl{};la=(0,so.__decorate)([i7({type:_.Choice})],la);let ll=class{constructor(e="M"){this.value=e}toString(){return this.value}};(0,so.__decorate)([se({type:A.PrintableString})],ll.prototype,"value",void 0),ll=(0,so.__decorate)([i7({type:_.Choice})],ll);let lc=class{constructor(e=""){this.value=e}toString(){return this.value}};(0,so.__decorate)([se({type:A.PrintableString})],lc.prototype,"value",void 0),lc=(0,so.__decorate)([i7({type:_.Choice})],lc);let lu=class extends lc{};lu=(0,so.__decorate)([i7({type:_.Choice})],lu);let lp=class extends sl{};lp=(0,so.__decorate)([i7({type:_.Choice})],lp);let ld=class{constructor(e=""){this.value=e}toString(){return this.value}};(0,so.__decorate)([se({type:A.ObjectIdentifier})],ld.prototype,"value",void 0),ld=(0,so.__decorate)([i7({type:_.Choice})],ld);let lh=class extends nw{};lh=(0,so.__decorate)([i7({type:_.Choice})],lh);let lf=class{constructor(e=0){this.value=e}toString(){return this.value.toString()}};(0,so.__decorate)([se({type:A.Integer})],lf.prototype,"value",void 0),lf=(0,so.__decorate)([i7({type:_.Choice})],lf);let ly=class extends nM{};ly=(0,so.__decorate)([i7({type:_.Sequence})],ly);let lg=class extends sl{};lg=(0,so.__decorate)([i7({type:_.Choice})],lg);let lm=ey=class extends nC{constructor(e){super(e),Object.setPrototypeOf(this,ey.prototype)}};lm=ey=(0,so.__decorate)([i7({type:_.Sequence})],lm);let lv=eg=class extends ss{constructor(e){super(e),Object.setPrototypeOf(this,eg.prototype)}};lv=eg=(0,so.__decorate)([i7({type:_.Set,itemType:nL})],lv);let lb=class{constructor(e=""){this.value=e}toString(){return this.value}};(0,so.__decorate)([se({type:A.BmpString})],lb.prototype,"value",void 0),lb=(0,so.__decorate)([i7({type:_.Choice})],lb);let lx=class extends nx{};lx=(0,so.__decorate)([i7({type:_.Sequence})],lx);let lS=em=class extends ss{constructor(e){super(e),Object.setPrototypeOf(this,em.prototype)}};lS=em=(0,so.__decorate)([i7({type:_.Sequence,itemType:lx})],lS);let lw=ev=class extends ss{constructor(e){super(e),Object.setPrototypeOf(this,ev.prototype)}};lw=ev=(0,so.__decorate)([i7({type:_.Sequence,itemType:nd})],lw);class l_{constructor(e={}){this.version=0,this.subject=new sh,this.subjectPKInfo=new nS,this.attributes=new lw,Object.assign(this,e)}}(0,so.__decorate)([se({type:A.Integer})],l_.prototype,"version",void 0),(0,so.__decorate)([se({type:sh})],l_.prototype,"subject",void 0),(0,so.__decorate)([se({type:nS})],l_.prototype,"subjectPKInfo",void 0),(0,so.__decorate)([se({type:lw,implicit:!0,context:0,optional:!0})],l_.prototype,"attributes",void 0);class lA{constructor(e={}){this.certificationRequestInfo=new l_,this.signatureAlgorithm=new nx,this.signature=new ArrayBuffer(0),Object.assign(this,e)}}(0,so.__decorate)([se({type:l_,raw:!0})],lA.prototype,"certificationRequestInfo",void 0),(0,so.__decorate)([se({type:nx})],lA.prototype,"signatureAlgorithm",void 0),(0,so.__decorate)([se({type:A.BitString})],lA.prototype,"signature",void 0);let lC="crypto.algorithm",lk="crypto.algorithmProvider";aH.registerSingleton(lk,class{getAlgorithms(){return aH.resolveAll(lC)}toAsnAlgorithm(e){for(let t of({...e},this.getAlgorithms())){let r=t.toAsnAlgorithm(e);if(r)return r}if(/^[0-9.]+$/.test(e.name)){let t=new nx({algorithm:e.name});return"parameters"in e&&(t.parameters=e.parameters),t}throw Error("Cannot convert WebCrypto algorithm to ASN.1 algorithm")}toWebAlgorithm(e){for(let t of this.getAlgorithms()){let r=t.toWebAlgorithm(e);if(r)return r}return{name:e.algorithm,parameters:e.parameters}}});let lB="1.3.36.3.3.2.8.1.1",lN=`${lB}.1`,lj=`${lB}.2`,lE=`${lB}.3`,lO=`${lB}.4`,lI=`${lB}.5`,lT=`${lB}.6`,lP=`${lB}.7`,lD=`${lB}.8`,lU=`${lB}.9`,lR=`${lB}.10`,lV=`${lB}.11`,lL=`${lB}.12`,lM=`${lB}.13`,lH=`${lB}.14`,lF="brainpoolP160r1",l$="brainpoolP160t1",lz="brainpoolP192r1",lK="brainpoolP192t1",lW="brainpoolP224r1",lq="brainpoolP224t1",lG="brainpoolP256r1",lJ="brainpoolP256t1",lY="brainpoolP320r1",lZ="brainpoolP320t1",lX="brainpoolP384r1",lQ="brainpoolP384t1",l0="brainpoolP512r1",l1="brainpoolP512t1",l2="ECDSA",l4=eb=class{toAsnAlgorithm(e){if(e.name.toLowerCase()===l2.toLowerCase()){if("hash"in e)switch(("string"==typeof e.hash?e.hash:e.hash.name).toLowerCase()){case"sha-1":return oz;case"sha-256":return oK;case"sha-384":return oW;case"sha-512":return oq}else if("namedCurve"in e){let t="";switch(e.namedCurve){case"P-256":t=oM;break;case"K-256":t=eb.SECP256K1;break;case"P-384":t=oH;break;case"P-521":t=oF;break;case lF:t=lN;break;case l$:t=lj;break;case lz:t=lE;break;case lK:t=lO;break;case lW:t=lI;break;case lq:t=lT;break;case lG:t=lP;break;case lJ:t=lD;break;case lY:t=lU;break;case lZ:t=lR;break;case lX:t=lV;break;case lQ:t=lL;break;case l0:t=lM;break;case l1:t=lH}if(t)return new nx({algorithm:oP,parameters:sn.serialize(new oZ({namedCurve:t}))})}}return null}toWebAlgorithm(e){switch(e.algorithm){case oD:return{name:l2,hash:{name:"SHA-1"}};case oR:return{name:l2,hash:{name:"SHA-256"}};case oV:return{name:l2,hash:{name:"SHA-384"}};case oL:return{name:l2,hash:{name:"SHA-512"}};case oP:if(!e.parameters)throw TypeError("Cannot get required parameters from EC algorithm");switch(sn.parse(e.parameters,oZ).namedCurve){case oM:return{name:l2,namedCurve:"P-256"};case eb.SECP256K1:return{name:l2,namedCurve:"K-256"};case oH:return{name:l2,namedCurve:"P-384"};case oF:return{name:l2,namedCurve:"P-521"};case lN:return{name:l2,namedCurve:lF};case lj:return{name:l2,namedCurve:l$};case lE:return{name:l2,namedCurve:lz};case lO:return{name:l2,namedCurve:lK};case lI:return{name:l2,namedCurve:lW};case lT:return{name:l2,namedCurve:lq};case lP:return{name:l2,namedCurve:lG};case lD:return{name:l2,namedCurve:lJ};case lU:return{name:l2,namedCurve:lY};case lR:return{name:l2,namedCurve:lZ};case lV:return{name:l2,namedCurve:lX};case lL:return{name:l2,namedCurve:lQ};case lM:return{name:l2,namedCurve:l0};case lH:return{name:l2,namedCurve:l1}}}return null}};l4.SECP256K1="1.3.132.0.10",l4=eb=(0,so.__decorate)([aF()],l4),aH.registerSingleton(lC,l4);let l8=Symbol("name"),l5=Symbol("value");class l6{constructor(e,t={},r=""){for(const i in this[l8]=e,this[l5]=r,t)this[i]=t[i]}}l6.NAME=l8,l6.VALUE=l5;class l3{static toString(e){let t=this.items[e];return t||e}}l3.items={[as]:"sha1",[an]:"sha224",[ao]:"sha256",[aa]:"sha384",[al]:"sha512",[o1]:"rsaEncryption",[o3]:"sha1WithRSAEncryption",[o9]:"sha224WithRSAEncryption",[o7]:"sha256WithRSAEncryption",[ae]:"sha384WithRSAEncryption",[at]:"sha512WithRSAEncryption",[oP]:"ecPublicKey",[oD]:"ecdsaWithSHA1",[oU]:"ecdsaWithSHA224",[oR]:"ecdsaWithSHA256",[oV]:"ecdsaWithSHA384",[oL]:"ecdsaWithSHA512",[s2]:"TLS WWW server authentication",[s4]:"TLS WWW client authentication",[s8]:"Code Signing",[s5]:"E-mail Protection",[s6]:"Time Stamping",[s3]:"OCSP Signing","1.2.840.113549.1.7.2":"Signed Data"};class l9{static serialize(e){return this.serializeObj(e).join("\n")}static pad(e=0){return"".padStart(2*e," ")}static serializeObj(e,t=0){let r=[],i=this.pad(t++),s="",n=e[l6.VALUE];for(let o in n&&(s=` ${n}`),r.push(`${i}${e[l6.NAME]}:${s}`),i=this.pad(t),e){if("symbol"==typeof o)continue;let s=e[o],n=o?`${o}: `:"";if("string"==typeof s||"number"==typeof s||"boolean"==typeof s)r.push(`${i}${n}${s}`);else if(s instanceof Date)r.push(`${i}${n}${s.toUTCString()}`);else if(Array.isArray(s))for(let e of s)e[l6.NAME]=o,r.push(...this.serializeObj(e,t));else if(s instanceof l6)s[l6.NAME]=o,r.push(...this.serializeObj(s,t));else if(ru.BufferSourceConverter.isBufferSource(s))o?(r.push(`${i}${n}`),r.push(...this.serializeBufferSource(s,t+1))):r.push(...this.serializeBufferSource(s,t));else if("toTextObject"in s){let e=s.toTextObject();e[l6.NAME]=o,r.push(...this.serializeObj(e,t))}else throw TypeError("Cannot serialize data in text format. Unsupported type.")}return r}static serializeBufferSource(e,t=0){let r=this.pad(t),i=ru.BufferSourceConverter.toUint8Array(e),s=[];for(let e=0;e<i.length;){let t=[];for(let r=0;r<16&&e<i.length;r++){8===r&&t.push("");let s=i[e++].toString(16).padStart(2,"0");t.push(s)}s.push(`${r}${t.join(" ")}`)}return s}static serializeAlgorithm(e){return this.algorithmSerializer.toTextObject(e)}}l9.oidSerializer=l3,l9.algorithmSerializer=class{static toTextObject(e){let t=new l6("Algorithm Identifier",{},l3.toString(e.algorithm));if(e.parameters)if(e.algorithm===oP){let r=new l4().toWebAlgorithm(e);r&&"namedCurve"in r?t["Named Curve"]=r.namedCurve:t.Parameters=e.parameters}else t.Parameters=e.parameters;return t}};class l7{get rawData(){return(0,so.__classPrivateFieldGet)(this,ex,"f")||(0,so.__classPrivateFieldSet)(this,ex,sn.serialize(this.asn),"f"),(0,so.__classPrivateFieldGet)(this,ex,"f")}constructor(...e){ex.set(this,void 0),ru.BufferSourceConverter.isBufferSource(e[0])?(this.asn=sn.parse(e[0],e[1]),(0,so.__classPrivateFieldSet)(this,ex,ru.BufferSourceConverter.toArrayBuffer(e[0]),"f")):this.asn=e[0],this.onInit(this.asn)}equal(e){return e instanceof l7&&(0,ru.isEqual)(e.rawData,this.rawData)}toString(e="text"){switch(e){case"asn":return sn.toString(this.rawData);case"text":return l9.serialize(this.toTextObject());case"hex":return ru.Convert.ToHex(this.rawData);case"base64":return ru.Convert.ToBase64(this.rawData);case"base64url":return ru.Convert.ToBase64Url(this.rawData);default:throw TypeError("Argument 'format' is unsupported value")}}getTextName(){return this.constructor.NAME}toTextObject(){let e=this.toTextObjectEmpty();return e[""]=this.rawData,e}toTextObjectEmpty(e){return new l6(this.getTextName(),{},e)}}ex=new WeakMap,l7.NAME="ASN";class ce extends l7{constructor(...e){super(ru.BufferSourceConverter.isBufferSource(e[0])?ru.BufferSourceConverter.toArrayBuffer(e[0]):sn.serialize(new nA({extnID:e[0],critical:e[1],extnValue:new iP(ru.BufferSourceConverter.toArrayBuffer(e[2]))})),nA)}onInit(e){this.type=e.extnID,this.critical=e.critical,this.value=e.extnValue.buffer}toTextObject(){let e=this.toTextObjectWithoutValue();return e[""]=this.value,e}toTextObjectWithoutValue(){let e=this.toTextObjectEmpty(this.critical?"critical":void 0);return e[l6.NAME]===ce.NAME&&(e[l6.NAME]=l3.toString(this.type)),e}}class ct{static isCryptoKeyPair(e){return e&&e.privateKey&&e.publicKey}static isCryptoKey(e){return e&&e.usages&&e.type&&e.algorithm&&void 0!==e.extractable}constructor(){this.items=new Map,this[eS]="CryptoProvider","undefined"!=typeof self&&"undefined"!=typeof crypto?this.set(ct.DEFAULT,crypto):e.g.crypto&&e.g.crypto.subtle&&this.set(ct.DEFAULT,e.g.crypto)}clear(){this.items.clear()}delete(e){return this.items.delete(e)}forEach(e,t){return this.items.forEach(e,t)}has(e){return this.items.has(e)}get size(){return this.items.size}entries(){return this.items.entries()}keys(){return this.items.keys()}values(){return this.items.values()}[Symbol.iterator](){return this.items[Symbol.iterator]()}get(e=ct.DEFAULT){let t=this.items.get(e.toLowerCase());if(!t)throw Error(`Cannot get Crypto by name '${e}'`);return t}set(e,t){if("string"==typeof e){if(!t)throw TypeError("Argument 'value' is required");this.items.set(e.toLowerCase(),t)}else this.items.set(ct.DEFAULT,e);return this}}eS=Symbol.toStringTag,ct.DEFAULT="default";let cr=new ct,ci=/^[0-2](?:\.[1-9][0-9]*)+$/;class cs{constructor(e={}){for(const t in this.items={},e)this.register(t,e[t])}get(e){return this.items[e]||null}findId(e){return new RegExp(ci).test(e)?e:this.get(e)}register(e,t){this.items[e]=t,this.items[t]=e}}let cn=new cs;function co(e,t){return`\\${ru.Convert.ToHex(ru.Convert.FromUtf8String(t)).toUpperCase()}`}cn.register("CN","2.5.4.3"),cn.register("L","2.5.4.7"),cn.register("ST","2.5.4.8"),cn.register("O","2.5.4.10"),cn.register("OU","2.5.4.11"),cn.register("C","2.5.4.6"),cn.register("DC","0.9.2342.19200300.100.1.25"),cn.register("E","1.2.840.113549.1.9.1"),cn.register("G","2.5.4.42"),cn.register("I","2.5.4.43"),cn.register("SN","2.5.4.4"),cn.register("T","2.5.4.12");class ca{static isASCII(e){for(let t=0;t<e.length;t++)if(e.charCodeAt(t)>255)return!1;return!0}static isPrintableString(e){return/^[A-Za-z0-9 '()+,-./:=?]*$/g.test(e)}constructor(e,t={}){for(const e in this.extraNames=new cs,this.asn=new sh,t)if(Object.prototype.hasOwnProperty.call(t,e)){const r=t[e];this.extraNames.register(e,r)}"string"==typeof e?this.asn=this.fromString(e):e instanceof sh?this.asn=e:ru.BufferSourceConverter.isBufferSource(e)?this.asn=sn.parse(e,sh):this.asn=this.fromJSON(e)}getField(e){let t=this.extraNames.findId(e)||cn.findId(e),r=[];for(let e of this.asn)for(let i of e)i.type===t&&r.push(i.value.toString());return r}getName(e){return this.extraNames.get(e)||cn.get(e)}toString(){return this.asn.map(e=>e.map(e=>{let t=this.getName(e.type)||e.type,r=e.value.anyValue?`#${ru.Convert.ToHex(e.value.anyValue)}`:e.value.toString().replace(/([,+"\\<>;])/g,"\\$1").replace(/^([ #])/,"\\$1").replace(/([ ]$)/,"\\$1").replace(/([\r\n\t])/,co);return`${t}=${r}`}).join("+")).join(", ")}toJSON(){let e=[];for(let t of this.asn){let r={};for(let e of t){let t=this.getName(e.type)||e.type;null!=r[t]||(r[t]=[]),r[t].push(e.value.anyValue?`#${ru.Convert.ToHex(e.value.anyValue)}`:e.value.toString())}e.push(r)}return e}fromString(e){let t=new sh,r=/(\d\.[\d.]*\d|[A-Za-z]+)=((?:"")|(?:".*?[^\\]")|(?:[^,+"\\](?=[,+]|$))|(?:[^,+].*?(?:[^\\][,+]))|(?:))([,+])?/g,i=null,s=",";for(;i=r.exec(`${e},`);){let[,e,r]=i,n=r[r.length-1];(","===n||"+"===n)&&(r=r.slice(0,r.length-1),i[3]=n);let o=i[3];e=this.getTypeOid(e);let a=this.createAttribute(e,r);"+"===s?t[t.length-1].push(a):t.push(new sp([a])),s=o}return t}fromJSON(e){let t=new sh;for(let r of e){let e=new sp;for(let t in r){let i=this.getTypeOid(t);for(let s of r[t]){let t=this.createAttribute(i,s);e.push(t)}}t.push(e)}return t}getTypeOid(e){if(/[\d.]+/.test(e)||(e=this.getName(e)||""),!e)throw Error(`Cannot get OID for name type '${e}'`);return e}createAttribute(e,t){let r=new su({type:e});if("object"==typeof t)for(let e in t)switch(e){case"ia5String":r.value.ia5String=t[e];break;case"utf8String":r.value.utf8String=t[e];break;case"universalString":r.value.universalString=t[e];break;case"bmpString":r.value.bmpString=t[e];break;case"printableString":r.value.printableString=t[e]}else if("#"===t[0])r.value.anyValue=ru.Convert.FromHex(t.slice(1));else{let i=this.processStringValue(t);e===this.getName("E")||e===this.getName("DC")?r.value.ia5String=i:ca.isPrintableString(i)?r.value.printableString=i:r.value.utf8String=i}return r}processStringValue(e){let t=/"(.*?[^\\])?"/.exec(e);return t&&(e=t[1]),e.replace(/\\0a/ig,"\n").replace(/\\0d/ig,"\r").replace(/\\0g/ig,"	").replace(/\\(.)/g,"$1")}toArrayBuffer(){return sn.serialize(this.asn)}async getThumbprint(...e){var t;let r,i="SHA-1";return!(e.length>=1)||(null==(t=e[0])?void 0:t.subtle)?r=e[0]||cr.get():(i=e[0]||i,r=e[1]||cr.get()),await r.subtle.digest(i,this.toArrayBuffer())}}let cl="Cannot initialize GeneralName from ASN.1 data.",cc=`${cl} Unsupported string format in use.`,cu=`${cl} Value doesn't match to GUID regular expression.`,cp=/^([0-9a-f]{8})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{12})$/i,cd="1.3.6.1.4.1.311.25.1",ch="1.3.6.1.4.1.311.20.2.3",cf="email",cy="guid";class cg extends l7{constructor(...e){let t;if(2===e.length)switch(e[0]){case"dn":{const r=new ca(e[1]).toArrayBuffer(),i=sn.parse(r,sh);t=new sg({directoryName:i});break}case"dns":t=new sg({dNSName:e[1]});break;case cf:t=new sg({rfc822Name:e[1]});break;case cy:{const r=RegExp(cp,"i").exec(e[1]);if(!r)throw Error("Cannot parse GUID value. Value doesn't match to regular expression");const i=r.slice(1).map((e,t)=>t<3?ru.Convert.ToHex(new Uint8Array(ru.Convert.FromHex(e)).reverse()):e).join("");t=new sg({otherName:new sf({typeId:cd,value:sn.serialize(new iP(ru.Convert.FromHex(i)))})});break}case"ip":t=new sg({iPAddress:e[1]});break;case"id":t=new sg({registeredID:e[1]});break;case"upn":t=new sg({otherName:new sf({typeId:ch,value:sn.serialize(iz.toASN(e[1]))})});break;case"url":t=new sg({uniformResourceIdentifier:e[1]});break;default:throw Error("Cannot create GeneralName. Unsupported type of the name")}else t=ru.BufferSourceConverter.isBufferSource(e[0])?sn.parse(e[0],sg):e[0];super(t)}onInit(e){if(void 0!=e.dNSName)this.type="dns",this.value=e.dNSName;else if(void 0!=e.rfc822Name)this.type=cf,this.value=e.rfc822Name;else if(void 0!=e.iPAddress)this.type="ip",this.value=e.iPAddress;else if(void 0!=e.uniformResourceIdentifier)this.type="url",this.value=e.uniformResourceIdentifier;else if(void 0!=e.registeredID)this.type="id",this.value=e.registeredID;else if(void 0!=e.directoryName)this.type="dn",this.value=new ca(e.directoryName).toString();else if(void 0!=e.otherName)if(e.otherName.typeId===cd){this.type=cy;let t=sn.parse(e.otherName.value,iP),r=RegExp(cp,"i").exec(ru.Convert.ToHex(t));if(!r)throw Error(cu);this.value=r.slice(1).map((e,t)=>t<3?ru.Convert.ToHex(new Uint8Array(ru.Convert.FromHex(e)).reverse()):e).join("-")}else if(e.otherName.typeId===ch)this.type="upn",this.value=sn.parse(e.otherName.value,sl).toString();else throw Error(cc);else throw Error(cc)}toJSON(){return{type:this.type,value:this.value}}toTextObject(){let e;switch(this.type){case"dn":case"dns":case cy:case"ip":case"id":case"upn":case"url":e=this.type.toUpperCase();break;case cf:e="Email";break;default:throw Error("Unsupported GeneralName type")}let t=this.value;return"id"===this.type&&(t=l3.toString(t)),new l6(e,void 0,t)}}class cm extends l7{constructor(e){let t;if(e instanceof sP)t=e;else if(Array.isArray(e)){const r=[];for(const t of e)if(t instanceof sg)r.push(t);else{const e=sn.parse(new cg(t.type,t.value).rawData,sg);r.push(e)}t=new sP(r)}else if(ru.BufferSourceConverter.isBufferSource(e))t=sn.parse(e,sP);else throw Error("Cannot initialize GeneralNames. Incorrect incoming arguments");super(t)}onInit(e){let t=[];for(let r of e){let e=null;try{e=new cg(r)}catch{continue}t.push(e)}this.items=t}toJSON(){return this.items.map(e=>e.toJSON())}toTextObject(){let e=super.toTextObjectEmpty();for(let t of this.items){let r=t.toTextObject(),i=e[r[l6.NAME]];Array.isArray(i)||(i=[],e[r[l6.NAME]]=i),i.push(r)}return e}}cm.NAME="GeneralNames";let cv="-{5}",cb=`[^\\n]+`,cx=`${cv}BEGIN (${cb}(?=${cv}))${cv}`,cS=`${cv}END \\1${cv}`,cw=`[^:\\n]+`,c_=`(?:[^\\n]+\\n(?: +[^\\n]+\\n)*)`,cA=`(?:[a-zA-Z0-9=+/]+\\n)+`,cC=`${cx}\\n(?:((?:${cw}: ${c_})+))?\\n?(${cA})${cS}`;class ck{static isPem(e){return"string"==typeof e&&RegExp(cC,"g").test(e.replace(/\r/g,""))}static decodeWithHeaders(e){e=e.replace(/\r/g,"");let t=RegExp(cC,"g"),r=[],i=null;for(;i=t.exec(e);){let e=i[3].replace(RegExp(`[\\n]+`,"g"),""),t={type:i[1],headers:[],rawData:ru.Convert.FromBase64(e)},s=i[2];if(s){let e=s.split(RegExp("\\n","g")),r=null;for(let i of e){let[e,s]=i.split(/:(.*)/);if(void 0===s){if(!r)throw Error("Cannot parse PEM string. Incorrect header value");r.value+=e.trim()}else r&&t.headers.push(r),r={key:e,value:s.trim()}}r&&t.headers.push(r)}r.push(t)}return r}static decode(e){return this.decodeWithHeaders(e).map(e=>e.rawData)}static decodeFirst(e){let t=this.decode(e);if(!t.length)throw RangeError("PEM string doesn't contain any objects");return t[0]}static encode(e,t){if(Array.isArray(e)){let r=[];return t?e.forEach(e=>{if(!ru.BufferSourceConverter.isBufferSource(e))throw TypeError("Cannot encode array of BufferSource in PEM format. Not all items of the array are BufferSource");r.push(this.encodeStruct({type:t,rawData:ru.BufferSourceConverter.toArrayBuffer(e)}))}):e.forEach(e=>{if(!("type"in e))throw TypeError("Cannot encode array of PemStruct in PEM format. Not all items of the array are PemStrut");r.push(this.encodeStruct(e))}),r.join("\n")}if(!t)throw Error("Required argument 'tag' is missed");return this.encodeStruct({type:t,rawData:ru.BufferSourceConverter.toArrayBuffer(e)})}static encodeStruct(e){var t;let r,i=e.type.toLocaleUpperCase(),s=[];if(s.push(`-----BEGIN ${i}-----`),null==(t=e.headers)?void 0:t.length){for(let t of e.headers)s.push(`${t.key}: ${t.value}`);s.push("")}let n=ru.Convert.ToBase64(e.rawData),o=0,a=[];for(;o<n.length;)if(n.length-o<64?r=n.substring(o):(r=n.substring(o,o+64),o+=64),0!==r.length){if(a.push(r),r.length<64)break}else break;return s.push(...a),s.push(`-----END ${i}-----`),s.join("\n")}}ck.CertificateTag="CERTIFICATE",ck.CrlTag="CRL",ck.CertificateRequestTag="CERTIFICATE REQUEST",ck.PublicKeyTag="PUBLIC KEY",ck.PrivateKeyTag="PRIVATE KEY";class cB extends l7{static isAsnEncoded(e){return ru.BufferSourceConverter.isBufferSource(e)||"string"==typeof e}static toArrayBuffer(e){if("string"==typeof e)if(ck.isPem(e))return ck.decode(e)[0];else if(ru.Convert.isHex(e))return ru.Convert.FromHex(e);else if(ru.Convert.isBase64(e))return ru.Convert.FromBase64(e);else if(ru.Convert.isBase64Url(e))return ru.Convert.FromBase64Url(e);else throw TypeError("Unsupported format of 'raw' argument. Must be one of DER, PEM, HEX, Base64, or Base4Url");{let t=ru.BufferSourceConverter.toUint8Array(e);if(t.length>0&&48===t[0])return ru.BufferSourceConverter.toArrayBuffer(e);let r=ru.Convert.ToBinary(e);if(ck.isPem(r))return ck.decode(r)[0];if(ru.Convert.isHex(r))return ru.Convert.FromHex(r);if(ru.Convert.isBase64(r))return ru.Convert.FromBase64(r);else if(ru.Convert.isBase64Url(r))return ru.Convert.FromBase64Url(r);throw TypeError("Unsupported format of 'raw' argument. Must be one of DER, PEM, HEX, Base64, or Base4Url")}}constructor(...e){cB.isAsnEncoded(e[0])?super(cB.toArrayBuffer(e[0]),e[1]):super(e[0])}toString(e="pem"){return"pem"===e?ck.encode(this.rawData,this.tag):super.toString(e)}}class cN extends cB{static async create(e,t=cr.get()){if(e instanceof cN)return e;if(ct.isCryptoKey(e)){if("public"!==e.type)throw TypeError("Public key is required");return new cN(await t.subtle.exportKey("spki",e))}if(e.publicKey)return e.publicKey;if(ru.BufferSourceConverter.isBufferSource(e))return new cN(e);throw TypeError("Unsupported PublicKeyType")}constructor(e){cB.isAsnEncoded(e)?super(e,nS):super(e),this.tag=ck.PublicKeyTag}async export(...e){var t;let r,i=["verify"],s={hash:"SHA-256",...this.algorithm};e.length>1?(s=e[0]||s,i=e[1]||i,r=e[2]||cr.get()):r=e[0]||cr.get();let n=this.rawData,o=sn.parse(this.rawData,nS);return o.algorithm.algorithm===o8&&(t=o,t.algorithm=new nx({algorithm:o1,parameters:null}),n=sn.serialize(t)),r.subtle.importKey("spki",n,s,!0,i)}onInit(e){let t=aH.resolve(lk),r=this.algorithm=t.toWebAlgorithm(e.algorithm);if(e.algorithm.algorithm===o1){let t=sn.parse(e.subjectPublicKey,ax),i=ru.BufferSourceConverter.toUint8Array(t.modulus);r.publicExponent=ru.BufferSourceConverter.toUint8Array(t.publicExponent),r.modulusLength=(!i[0]?i.slice(1):i).byteLength<<3}}async getThumbprint(...e){var t;let r,i="SHA-1";return!(e.length>=1)||(null==(t=e[0])?void 0:t.subtle)?r=e[0]||cr.get():(i=e[0]||i,r=e[1]||cr.get()),await r.subtle.digest(i,this.rawData)}async getKeyIdentifier(...e){let t,r="SHA-1";1===e.length?"string"==typeof e[0]?(r=e[0],t=cr.get()):t=e[0]:2===e.length?(r=e[0],t=e[1]):t=cr.get();let i=sn.parse(this.rawData,nS);return await t.subtle.digest(r,i.subjectPublicKey)}toTextObject(){let e=this.toTextObjectEmpty(),t=sn.parse(this.rawData,nS);return e.Algorithm=l9.serializeAlgorithm(t.algorithm),t.algorithm.algorithm===oP?e["EC Point"]=t.subjectPublicKey:e["Raw Data"]=t.subjectPublicKey,e}}class cj extends ce{static async create(e,t=!1,r=cr.get()){if("name"in e&&"serialNumber"in e)return new cj(e,t);let i=await cN.create(e,r),s=await i.getKeyIdentifier(r);return new cj(ru.Convert.ToHex(s),t)}constructor(...e){if(ru.BufferSourceConverter.isBufferSource(e[0]))super(e[0]);else if("string"==typeof e[0])super(sj,e[1],sn.serialize(new sO({keyIdentifier:new sE(ru.Convert.FromHex(e[0]))})));else{const t=e[0];super(sj,e[1],sn.serialize(new sO({authorityCertIssuer:t.name instanceof cm?sn.parse(t.name.rawData,sP):t.name,authorityCertSerialNumber:ru.Convert.FromHex(t.serialNumber)})))}}onInit(e){super.onInit(e);let t=sn.parse(e.extnValue,sO);t.keyIdentifier&&(this.keyId=ru.Convert.ToHex(t.keyIdentifier)),(t.authorityCertIssuer||t.authorityCertSerialNumber)&&(this.certId={name:t.authorityCertIssuer||[],serialNumber:t.authorityCertSerialNumber?ru.Convert.ToHex(t.authorityCertSerialNumber):""})}toTextObject(){let e=this.toTextObjectWithoutValue(),t=sn.parse(this.value,sO);return t.authorityCertIssuer&&(e["Authority Issuer"]=new cm(t.authorityCertIssuer).toTextObject()),t.authorityCertSerialNumber&&(e["Authority Serial Number"]=t.authorityCertSerialNumber),t.keyIdentifier&&(e[""]=t.keyIdentifier),e}}cj.NAME="Authority Key Identifier";class cE extends ce{constructor(...e){if(ru.BufferSourceConverter.isBufferSource(e[0])){super(e[0]);const t=sn.parse(this.value,sT);this.ca=t.cA,this.pathLength=t.pathLenConstraint}else super(sI,e[2],sn.serialize(new sT({cA:e[0],pathLenConstraint:e[1]}))),this.ca=e[0],this.pathLength=e[1]}toTextObject(){let e=this.toTextObjectWithoutValue();return this.ca&&(e.CA=this.ca),void 0!==this.pathLength&&(e["Path Length"]=this.pathLength),e}}cE.NAME="Basic Constraints",(v=ew||(ew={})).serverAuth="1.3.6.1.5.5.7.3.1",v.clientAuth="1.3.6.1.5.5.7.3.2",v.codeSigning="1.3.6.1.5.5.7.3.3",v.emailProtection="1.3.6.1.5.5.7.3.4",v.timeStamping="1.3.6.1.5.5.7.3.8",v.ocspSigning="1.3.6.1.5.5.7.3.9";class cO extends ce{constructor(...e){if(ru.BufferSourceConverter.isBufferSource(e[0])){super(e[0]);const t=sn.parse(this.value,s1);this.usages=t.map(e=>e)}else super(s0,e[1],sn.serialize(new s1(e[0]))),this.usages=e[0]}toTextObject(){let e=this.toTextObjectWithoutValue();return e[""]=this.usages.map(e=>l3.toString(e)).join(", "),e}}cO.NAME="Extended Key Usages",(b=e_||(e_={}))[b.digitalSignature=1]="digitalSignature",b[b.nonRepudiation=2]="nonRepudiation",b[b.keyEncipherment=4]="keyEncipherment",b[b.dataEncipherment=8]="dataEncipherment",b[b.keyAgreement=16]="keyAgreement",b[b.keyCertSign=32]="keyCertSign",b[b.cRLSign=64]="cRLSign",b[b.encipherOnly=128]="encipherOnly",b[b.decipherOnly=256]="decipherOnly";class cI extends ce{constructor(...e){if(ru.BufferSourceConverter.isBufferSource(e[0])){super(e[0]);const t=sn.parse(this.value,ni);this.usages=t.toNumber()}else super(nr,e[1],sn.serialize(new ni(e[0]))),this.usages=e[0]}toTextObject(){let e=this.toTextObjectWithoutValue(),t=sn.parse(this.value,ni);return e[""]=t.toJSON().join(", "),e}}cI.NAME="Key Usages";class cT extends ce{static async create(e,t=!1,r=cr.get()){let i=await cN.create(e,r),s=await i.getKeyIdentifier(r);return new cT(ru.Convert.ToHex(s),t)}constructor(...e){if(ru.BufferSourceConverter.isBufferSource(e[0])){super(e[0]);const t=sn.parse(this.value,ny);this.keyId=ru.Convert.ToHex(t)}else{const t="string"==typeof e[0]?ru.Convert.FromHex(e[0]):e[0];super(nf,e[1],sn.serialize(new ny(t))),this.keyId=ru.Convert.ToHex(t)}}toTextObject(){let e=this.toTextObjectWithoutValue(),t=sn.parse(this.value,ny);return e[""]=t,e}}cT.NAME="Subject Key Identifier";class cP extends ce{constructor(...e){ru.BufferSourceConverter.isBufferSource(e[0])?super(e[0]):super(nu,e[1],new cm(e[0]||[]).rawData)}onInit(e){super.onInit(e);let t=sn.parse(e.extnValue,np);this.names=new cm(t)}toTextObject(){let e=this.toTextObjectWithoutValue(),t=this.names.toTextObject();for(let r in t)e[r]=t[r];return e}}cP.NAME="Subject Alternative Name";class cD{static register(e,t){this.items.set(e,t)}static create(e){let t=new ce(e),r=this.items.get(t.type);return r?new r(e):t}}cD.items=new Map;class cU extends ce{constructor(...e){var t;if(ru.BufferSourceConverter.isBufferSource(e[0])){super(e[0]);const t=sn.parse(this.value,s$);this.policies=t.map(e=>e.policyIdentifier)}else{const r=e[0];super(sU,null!=(t=e[1])&&t,sn.serialize(new s$(r.map(e=>new sF({policyIdentifier:e}))))),this.policies=r}}toTextObject(){let e=this.toTextObjectWithoutValue();return e.Policy=this.policies.map(e=>new l6("",{},l3.toString(e))),e}}cU.NAME="Certificate Policies",cD.register(sU,cU);class cR extends ce{constructor(...e){ru.BufferSourceConverter.isBufferSource(e[0])?super(e[0]):Array.isArray(e[0])&&"string"==typeof e[0][0]?super(sW,e[1],sn.serialize(new sY(e[0].map(e=>new sJ({distributionPoint:new sG({fullName:[new sg({uniformResourceIdentifier:e})]})}))))):super(sW,e[1],sn.serialize(new sY(e[0]))),null!=this.distributionPoints||(this.distributionPoints=[])}onInit(e){super.onInit(e);let t=sn.parse(e.extnValue,sY);this.distributionPoints=t}toTextObject(){let e=this.toTextObjectWithoutValue();return e["Distribution Point"]=this.distributionPoints.map(e=>{var t;let r={};return e.distributionPoint&&(r[""]=null==(t=e.distributionPoint.fullName)?void 0:t.map(e=>new cg(e).toString()).join(", ")),e.reasons&&(r.Reasons=e.reasons.toString()),e.cRLIssuer&&(r["CRL Issuer"]=e.cRLIssuer.map(e=>e.toString()).join(", ")),r}),e}}cR.NAME="CRL Distribution Points";class cV extends ce{constructor(...e){if(ru.BufferSourceConverter.isBufferSource(e[0]))super(e[0]);else if(e[0]instanceof sN)super(sk,e[1],sn.serialize(new sN(e[0])));else{const t=e[0],r=new sN;cM(r,t,sS,"ocsp"),cM(r,t,sw,"caIssuers"),cM(r,t,s_,"timeStamping"),cM(r,t,sA,"caRepository"),super(sk,e[1],sn.serialize(r))}null!=this.ocsp||(this.ocsp=[]),null!=this.caIssuers||(this.caIssuers=[]),null!=this.timeStamping||(this.timeStamping=[]),null!=this.caRepository||(this.caRepository=[])}onInit(e){super.onInit(e),this.ocsp=[],this.caIssuers=[],this.timeStamping=[],this.caRepository=[],sn.parse(e.extnValue,sN).forEach(e=>{switch(e.accessMethod){case sS:this.ocsp.push(new cg(e.accessLocation));break;case sw:this.caIssuers.push(new cg(e.accessLocation));break;case s_:this.timeStamping.push(new cg(e.accessLocation));break;case sA:this.caRepository.push(new cg(e.accessLocation))}})}toTextObject(){let e=this.toTextObjectWithoutValue();return this.ocsp.length&&cL(e,"OCSP",this.ocsp),this.caIssuers.length&&cL(e,"CA Issuers",this.caIssuers),this.timeStamping.length&&cL(e,"Time Stamping",this.timeStamping),this.caRepository.length&&cL(e,"CA Repository",this.caRepository),e}}function cL(e,t,r){if(1===r.length)e[t]=r[0].toTextObject();else{let i=new l6("");r.forEach((e,t)=>{let r=e.toTextObject(),s=`${r[l6.NAME]} ${t+1}`,n=i[s];Array.isArray(n)||(n=[],i[s]=n),n.push(r)}),e[t]=i}}function cM(e,t,r,i){let s=t[i];s&&(Array.isArray(s)?s:[s]).forEach(t=>{"string"==typeof t&&(t=new cg("url",t)),e.push(new sB({accessMethod:r,accessLocation:sn.parse(t.rawData,sg)}))})}cV.NAME="Authority Info Access";class cH extends ce{constructor(...e){ru.BufferSourceConverter.isBufferSource(e[0])?super(e[0]):super(ne,e[1],new cm(e[0]||[]).rawData)}onInit(e){super.onInit(e);let t=sn.parse(e.extnValue,sP);this.names=new cm(t)}toTextObject(){let e=this.toTextObjectWithoutValue(),t=this.names.toTextObject();for(let r in t)e[r]=t[r];return e}}cH.NAME="Issuer Alternative Name";class cF extends l7{constructor(...e){let t;if(ru.BufferSourceConverter.isBufferSource(e[0]))t=ru.BufferSourceConverter.toArrayBuffer(e[0]);else{const r=e[0],i=Array.isArray(e[1])?e[1].map(e=>ru.BufferSourceConverter.toArrayBuffer(e)):[];t=sn.serialize(new nd({type:r,values:i}))}super(t,nd)}onInit(e){this.type=e.type,this.values=e.values}toTextObject(){let e=this.toTextObjectWithoutValue();return e.Value=this.values.map(e=>new l6("",{"":e})),e}toTextObjectWithoutValue(){let e=this.toTextObjectEmpty();return e[l6.NAME]===cF.NAME&&(e[l6.NAME]=l3.toString(this.type)),e}}cF.NAME="Attribute";class c$ extends cF{constructor(...e){ru.BufferSourceConverter.isBufferSource(e[0])?super(e[0]):super(a3,[sn.serialize(new lg({printableString:e[0]}))]),null!=this.password||(this.password="")}onInit(e){if(super.onInit(e),this.values[0]){let e=sn.parse(this.values[0],lg);this.password=e.toString()}}toTextObject(){let e=this.toTextObjectWithoutValue();return e[l6.VALUE]=this.password,e}}c$.NAME="Challenge Password";class cz extends cF{constructor(...e){if(ru.BufferSourceConverter.isBufferSource(e[0]))super(e[0]);else{const t=e[0],r=new nC;for(const e of t)r.push(sn.parse(e.rawData,nA));super(a9,[sn.serialize(r)])}null!=this.items||(this.items=[])}onInit(e){if(super.onInit(e),this.values[0]){let e=sn.parse(this.values[0],nC);this.items=e.map(e=>cD.create(sn.serialize(e)))}}toTextObject(){let e=this.toTextObjectWithoutValue();for(let t of this.items.map(e=>e.toTextObject()))e[t[l6.NAME]]=t;return e}}cz.NAME="Extensions";class cK{static register(e,t){this.items.set(e,t)}static create(e){let t=new cF(e),r=this.items.get(t.type);return r?new r(e):t}}cK.items=new Map;let cW="crypto.signatureFormatter",cq=eA=class{static createPssParams(e,t){let r=eA.getHashAlgorithm(e);return r?new ay({hashAlgorithm:r,maskGenAlgorithm:new nx({algorithm:ac,parameters:sn.serialize(r)}),saltLength:t}):null}static getHashAlgorithm(e){let t=aH.resolve(lk);return"string"==typeof e?t.toAsnAlgorithm({name:e}):"object"==typeof e&&e&&"name"in e?t.toAsnAlgorithm(e):null}toAsnAlgorithm(e){switch(e.name.toLowerCase()){case"rsassa-pkcs1-v1_5":if(!("hash"in e))return new nx({algorithm:o1,parameters:null});{let t;if("string"==typeof e.hash)t=e.hash;else if(e.hash&&"object"==typeof e.hash&&"name"in e.hash&&"string"==typeof e.hash.name)t=e.hash.name.toUpperCase();else throw Error("Cannot get hash algorithm name");switch(t.toLowerCase()){case"sha-1":return new nx({algorithm:o3,parameters:null});case"sha-256":return new nx({algorithm:o7,parameters:null});case"sha-384":return new nx({algorithm:ae,parameters:null});case"sha-512":return new nx({algorithm:at,parameters:null})}}break;case"rsa-pss":if(!("hash"in e))return new nx({algorithm:o8,parameters:null});{if(!("saltLength"in e&&"number"==typeof e.saltLength))throw Error("Cannot get 'saltLength' from 'alg' argument");let t=eA.createPssParams(e.hash,e.saltLength);if(!t)throw Error("Cannot create PSS parameters");return new nx({algorithm:o8,parameters:sn.serialize(t)})}}return null}toWebAlgorithm(e){switch(e.algorithm){case o1:return{name:"RSASSA-PKCS1-v1_5"};case o3:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case o7:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case ae:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case at:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}};case o8:if(!e.parameters)return{name:"RSA-PSS"};{let t=sn.parse(e.parameters,ay);return{name:"RSA-PSS",hash:aH.resolve(lk).toWebAlgorithm(t.hashAlgorithm),saltLength:t.saltLength}}}return null}};cq=eA=(0,so.__decorate)([aF()],cq),aH.registerSingleton(lC,cq);let cG=class{toAsnAlgorithm(e){switch(e.name.toLowerCase()){case"sha-1":return new nx({algorithm:as});case"sha-256":return new nx({algorithm:ao});case"sha-384":return new nx({algorithm:aa});case"sha-512":return new nx({algorithm:al})}return null}toWebAlgorithm(e){switch(e.algorithm){case as:return{name:"SHA-1"};case ao:return{name:"SHA-256"};case aa:return{name:"SHA-384"};case al:return{name:"SHA-512"}}return null}};cG=(0,so.__decorate)([aF()],cG),aH.registerSingleton(lC,cG);class cJ{addPadding(e,t){let r=ru.BufferSourceConverter.toUint8Array(t),i=new Uint8Array(e);return i.set(r,e-r.length),i.buffer}removePadding(e,t=!1){let r=ru.BufferSourceConverter.toUint8Array(e);for(let e=0;e<r.length;e++)if(r[e]){r=r.slice(e);break}if(t&&r[0]>127){let e=new Uint8Array(r.length+1);return e.set(r,1),e.buffer}return r.buffer}toAsnSignature(e,t){if("ECDSA"===e.name){let r=e.namedCurve,i=cJ.namedCurveSize.get(r)||cJ.defaultNamedCurveSize,s=new oQ,n=ru.BufferSourceConverter.toUint8Array(t);return s.r=this.removePadding(n.slice(0,i),!0),s.s=this.removePadding(n.slice(i,i+i),!0),sn.serialize(s)}return null}toWebSignature(e,t){if("ECDSA"===e.name){let r=sn.parse(t,oQ),i=e.namedCurve,s=cJ.namedCurveSize.get(i)||cJ.defaultNamedCurveSize,n=this.addPadding(s,this.removePadding(r.r)),o=this.addPadding(s,this.removePadding(r.s));return(0,ru.combine)(n,o)}return null}}cJ.namedCurveSize=new Map,cJ.defaultNamedCurveSize=32;let cY="1.3.101.110",cZ="1.3.101.111",cX="1.3.101.112",cQ="1.3.101.113",c0=class{toAsnAlgorithm(e){let t=null;switch(e.name.toLowerCase()){case"ed25519":t=cX;break;case"x25519":t=cY;break;case"eddsa":switch(e.namedCurve.toLowerCase()){case"ed25519":t=cX;break;case"ed448":t=cQ}break;case"ecdh-es":switch(e.namedCurve.toLowerCase()){case"x25519":t=cY;break;case"x448":t=cZ}}return t?new nx({algorithm:t}):null}toWebAlgorithm(e){switch(e.algorithm){case cX:return{name:"Ed25519"};case cQ:return{name:"EdDSA",namedCurve:"Ed448"};case cY:return{name:"X25519"};case cZ:return{name:"ECDH-ES",namedCurve:"X448"}}return null}};c0=(0,so.__decorate)([aF()],c0),aH.registerSingleton(lC,c0),new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap;class c1 extends cB{get publicKey(){return(0,so.__classPrivateFieldGet)(this,eU,"f")||(0,so.__classPrivateFieldSet)(this,eU,new cN(this.asn.tbsCertificate.subjectPublicKeyInfo),"f"),(0,so.__classPrivateFieldGet)(this,eU,"f")}get serialNumber(){if(!(0,so.__classPrivateFieldGet)(this,ek,"f")){let e=new Uint8Array(this.asn.tbsCertificate.serialNumber);e.length>1&&0===e[0]&&e[1]>127&&(e=e.slice(1)),(0,so.__classPrivateFieldSet)(this,ek,ru.Convert.ToHex(e),"f")}return(0,so.__classPrivateFieldGet)(this,ek,"f")}get subjectName(){return(0,so.__classPrivateFieldGet)(this,eB,"f")||(0,so.__classPrivateFieldSet)(this,eB,new ca(this.asn.tbsCertificate.subject),"f"),(0,so.__classPrivateFieldGet)(this,eB,"f")}get subject(){return(0,so.__classPrivateFieldGet)(this,eN,"f")||(0,so.__classPrivateFieldSet)(this,eN,this.subjectName.toString(),"f"),(0,so.__classPrivateFieldGet)(this,eN,"f")}get issuerName(){return(0,so.__classPrivateFieldGet)(this,ej,"f")||(0,so.__classPrivateFieldSet)(this,ej,new ca(this.asn.tbsCertificate.issuer),"f"),(0,so.__classPrivateFieldGet)(this,ej,"f")}get issuer(){return(0,so.__classPrivateFieldGet)(this,eE,"f")||(0,so.__classPrivateFieldSet)(this,eE,this.issuerName.toString(),"f"),(0,so.__classPrivateFieldGet)(this,eE,"f")}get notBefore(){if(!(0,so.__classPrivateFieldGet)(this,eO,"f")){let e=this.asn.tbsCertificate.validity.notBefore.utcTime||this.asn.tbsCertificate.validity.notBefore.generalTime;if(!e)throw Error("Cannot get 'notBefore' value");(0,so.__classPrivateFieldSet)(this,eO,e,"f")}return(0,so.__classPrivateFieldGet)(this,eO,"f")}get notAfter(){if(!(0,so.__classPrivateFieldGet)(this,eI,"f")){let e=this.asn.tbsCertificate.validity.notAfter.utcTime||this.asn.tbsCertificate.validity.notAfter.generalTime;if(!e)throw Error("Cannot get 'notAfter' value");(0,so.__classPrivateFieldSet)(this,eI,e,"f")}return(0,so.__classPrivateFieldGet)(this,eI,"f")}get signatureAlgorithm(){if(!(0,so.__classPrivateFieldGet)(this,eT,"f")){let e=aH.resolve(lk);(0,so.__classPrivateFieldSet)(this,eT,e.toWebAlgorithm(this.asn.signatureAlgorithm),"f")}return(0,so.__classPrivateFieldGet)(this,eT,"f")}get signature(){return(0,so.__classPrivateFieldGet)(this,eP,"f")||(0,so.__classPrivateFieldSet)(this,eP,this.asn.signatureValue,"f"),(0,so.__classPrivateFieldGet)(this,eP,"f")}get extensions(){return!(0,so.__classPrivateFieldGet)(this,eD,"f")&&((0,so.__classPrivateFieldSet)(this,eD,[],"f"),this.asn.tbsCertificate.extensions&&(0,so.__classPrivateFieldSet)(this,eD,this.asn.tbsCertificate.extensions.map(e=>cD.create(sn.serialize(e))),"f")),(0,so.__classPrivateFieldGet)(this,eD,"f")}get tbs(){return(0,so.__classPrivateFieldGet)(this,eC,"f")||(0,so.__classPrivateFieldSet)(this,eC,this.asn.tbsCertificateRaw||sn.serialize(this.asn.tbsCertificate),"f"),(0,so.__classPrivateFieldGet)(this,eC,"f")}constructor(e){const t=cB.isAsnEncoded(e)?[e,nB]:[e];super(t[0],t[1]),eC.set(this,void 0),ek.set(this,void 0),eB.set(this,void 0),eN.set(this,void 0),ej.set(this,void 0),eE.set(this,void 0),eO.set(this,void 0),eI.set(this,void 0),eT.set(this,void 0),eP.set(this,void 0),eD.set(this,void 0),eU.set(this,void 0),this.tag=ck.CertificateTag}onInit(e){}getExtension(e){for(let t of this.extensions)if("string"==typeof e){if(t.type===e)return t}else if(t instanceof e)return t;return null}getExtensions(e){return this.extensions.filter(t=>"string"==typeof e?t.type===e:t instanceof e)}async verify(e={},t=cr.get()){let r,i,s=e.publicKey;try{if(s)if("publicKey"in s)r={...s.publicKey.algorithm,...this.signatureAlgorithm},i=await s.publicKey.export(r,["verify"],t);else if(s instanceof cN)r={...s.algorithm,...this.signatureAlgorithm},i=await s.export(r,["verify"],t);else if(ru.BufferSourceConverter.isBufferSource(s)){let e=new cN(s);r={...e.algorithm,...this.signatureAlgorithm},i=await e.export(r,["verify"],t)}else r={...s.algorithm,...this.signatureAlgorithm},i=s;else r={...this.publicKey.algorithm,...this.signatureAlgorithm},i=await this.publicKey.export(r,["verify"],t)}catch{return!1}let n=aH.resolveAll(cW).reverse(),o=null;for(let e of n)if(o=e.toWebSignature(r,this.signature))break;if(!o)throw Error("Cannot convert ASN.1 signature value to WebCrypto format");let a=await t.subtle.verify(this.signatureAlgorithm,i,o,this.tbs);if(e.signatureOnly)return a;{let t=(e.date||new Date).getTime();return a&&this.notBefore.getTime()<t&&t<this.notAfter.getTime()}}async getThumbprint(...e){let t,r="SHA-1";return e[0]&&(e[0].subtle?t=e[0]:(r=e[0]||r,t=e[1])),null!=t||(t=cr.get()),await t.subtle.digest(r,this.rawData)}async isSelfSigned(e=cr.get()){return this.subject===this.issuer&&await this.verify({signatureOnly:!0},e)}toTextObject(){let e=this.toTextObjectEmpty(),t=sn.parse(this.rawData,nB),r=t.tbsCertificate,i=new l6("",{Version:`${W[r.version]} (${r.version})`,"Serial Number":r.serialNumber,"Signature Algorithm":l9.serializeAlgorithm(r.signature),Issuer:this.issuer,Validity:new l6("",{"Not Before":r.validity.notBefore.getTime(),"Not After":r.validity.notAfter.getTime()}),Subject:this.subject,"Subject Public Key Info":this.publicKey});if(r.issuerUniqueID&&(i["Issuer Unique ID"]=r.issuerUniqueID),r.subjectUniqueID&&(i["Subject Unique ID"]=r.subjectUniqueID),this.extensions.length){let e=new l6("");for(let t of this.extensions){let r=t.toTextObject();e[r[l6.NAME]]=r}i.Extensions=e}return e.Data=i,e.Signature=new l6("",{Algorithm:l9.serializeAlgorithm(t.signatureAlgorithm),"":t.signatureValue}),e}}eC=new WeakMap,ek=new WeakMap,eB=new WeakMap,eN=new WeakMap,ej=new WeakMap,eE=new WeakMap,eO=new WeakMap,eI=new WeakMap,eT=new WeakMap,eP=new WeakMap,eD=new WeakMap,eU=new WeakMap,c1.NAME="Certificate";class c2{static async createSelfSigned(e,t=cr.get()){if(!e.keys.privateKey)throw Error("Bad field 'keys' in 'params' argument. 'privateKey' is empty");if(!e.keys.publicKey)throw Error("Bad field 'keys' in 'params' argument. 'publicKey' is empty");return this.create({serialNumber:e.serialNumber,subject:e.name,issuer:e.name,notBefore:e.notBefore,notAfter:e.notAfter,publicKey:e.keys.publicKey,signingKey:e.keys.privateKey,signingAlgorithm:e.signingAlgorithm,extensions:e.extensions},t)}static async create(e,t=cr.get()){var r;let i;i=e.publicKey instanceof cN?e.publicKey.rawData:"publicKey"in e.publicKey?e.publicKey.publicKey.rawData:ru.BufferSourceConverter.isBufferSource(e.publicKey)?e.publicKey:await t.subtle.exportKey("spki",e.publicKey);let s=function(e,t=cr.get()){let r=ru.BufferSourceConverter.toUint8Array(ru.Convert.FromHex(e||"")),i=r&&r.length&&r.some(e=>e>0)?new Uint8Array(r):void 0;i||(i=t.getRandomValues(new Uint8Array(16)));let s=0;for(;s<i.length-1&&0===i[s];)s++;if((i=i.slice(s))[0]>127){let e=new Uint8Array(i.length+1);e[0]=0,e.set(i,1),i=e}return i.buffer}(e.serialNumber,t),n=e.notBefore||new Date,o=e.notAfter||new Date(n.getTime()+31536e6),a=new nB({tbsCertificate:new nk({version:W.v3,serialNumber:s,validity:new n_({notBefore:n,notAfter:o}),extensions:new nC((null==(r=e.extensions)?void 0:r.map(e=>sn.parse(e.rawData,nA)))||[]),subjectPublicKeyInfo:sn.parse(i,nS)})});if(e.subject){let t=e.subject instanceof ca?e.subject:new ca(e.subject);a.tbsCertificate.subject=sn.parse(t.toArrayBuffer(),sh)}if(e.issuer){let t=e.issuer instanceof ca?e.issuer:new ca(e.issuer);a.tbsCertificate.issuer=sn.parse(t.toArrayBuffer(),sh)}let l={hash:"SHA-256"},c="signingKey"in e?{...l,...e.signingAlgorithm,...e.signingKey.algorithm}:{...l,...e.signingAlgorithm},u=aH.resolve(lk);a.tbsCertificate.signature=a.signatureAlgorithm=u.toAsnAlgorithm(c);let p=sn.serialize(a.tbsCertificate),d="signingKey"in e?await t.subtle.sign(c,e.signingKey,p):e.signature,h=aH.resolveAll(cW).reverse(),f=null;for(let e of h)if(f=e.toAsnSignature(c,d))break;if(!f)throw Error("Cannot convert ASN.1 signature value to WebCrypto format");return a.signatureValue=f,new c1(sn.serialize(a))}}async function c4(e){let t=ri(e);return await crypto.subtle.generateKey(t,!0,["sign","verify"])}async function c8(e){let t=await crypto.subtle.exportKey("pkcs8",e.privateKey);return{privateKeyPem:rn(rs(t),"PRIVATE KEY"),publicKeyPem:rn(rs(await crypto.subtle.exportKey("spki",e.publicKey)),"PUBLIC KEY"),privateKeyBuffer:t}}async function c5(e,t){let r=e.privateKey.trim();return{signingKey:await crypto.subtle.importKey("pkcs8",function(e){let t=atob(e.split("\n").filter(e=>!e.startsWith("-----")).join("")),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r.buffer}(r),ri(t),!0,["sign"]),issuerDn:new c1(e.certificate).subject}}async function c6(e){let t=function(e){let t=ra(e.subject);if(!t.valid)return t;let r=rl(e.sans);if(!r.valid)return r;let i=rc(e.validity);if(!i.valid)return i;if(e.useExistingCA){var s,n;let t=(s=e.rootCAInput.certificate)&&s.trim()?s.includes("-----BEGIN CERTIFICATE-----")?s.includes("-----END CERTIFICATE-----")?{valid:!0}:{valid:!1,error:"Invalid certificate format. Missing END marker."}:{valid:!1,error:"Invalid certificate format. Must be PEM encoded."}:{valid:!1,error:"Certificate is required"};if(!t.valid)return t;let r=(n=e.rootCAInput.privateKey)&&n.trim()?n.includes("-----BEGIN PRIVATE KEY-----")||n.includes("-----BEGIN RSA PRIVATE KEY-----")||n.includes("-----BEGIN EC PRIVATE KEY-----")?{valid:!0}:{valid:!1,error:"Invalid private key format. Must be PEM encoded."}:{valid:!1,error:"Private key is required"};if(!r.valid)return r}return{valid:!0}}(e);if(!t.valid)return{success:!1,error:t.error};try{var r,i,s;let t,n,o,a;cr.set(crypto);let l=await c4(e.keySettings),c=function(e,t,r,i){let s=[];s.push(new cE(r.isCA,r.pathLengthConstraint??void 0,!0));let n=0;e.digitalSignature&&(n|=e_.digitalSignature),e.keyEncipherment&&(n|=e_.keyEncipherment),e.dataEncipherment&&(n|=e_.dataEncipherment),e.keyAgreement&&(n|=e_.keyAgreement),e.keyCertSign&&(n|=e_.keyCertSign),e.crlSign&&(n|=e_.cRLSign),n>0&&s.push(new cI(n,!0));let o=[];t.serverAuth&&o.push(ew.serverAuth),t.clientAuth&&o.push(ew.clientAuth),t.codeSigning&&o.push(ew.codeSigning),t.emailProtection&&o.push(ew.emailProtection),o.length>0&&s.push(new cO(o,!1));let a=i.filter(e=>e.value&&e.value.trim());if(a.length>0){let e=new cP(a.map(e=>({type:e.type,value:e.value})),!1);s.push(e)}return s}(e.keyUsage,e.extKeyUsage,e.caSettings,e.sans),{notBefore:u,notAfter:p}=(t=(r=e.validity).useCustomDates&&r.customStartDate?new Date(r.customStartDate):new Date,n=new Date(r.useCustomDates&&r.customEndDate?r.customEndDate:t.getTime()+24*r.days*36e5),{notBefore:t,notAfter:n}),d=(i=e.subject,o=[],i.commonName&&o.push(`CN=${rr(i.commonName)}`),i.organization&&o.push(`O=${rr(i.organization)}`),i.organizationalUnit&&o.push(`OU=${rr(i.organizationalUnit)}`),i.locality&&o.push(`L=${rr(i.locality)}`),i.state&&o.push(`ST=${rr(i.state)}`),i.country&&o.push(`C=${rr(i.country)}`),i.email&&o.push(`E=${rr(i.email)}`),o.join(", ")),h=l.privateKey,f=d;if(e.useExistingCA&&e.rootCAInput.certificate&&e.rootCAInput.privateKey){let t=await c5(e.rootCAInput,e.keySettings);h=t.signingKey,f=t.issuerDn}let y=await c2.create({serialNumber:(a=new Uint8Array(16),crypto.getRandomValues(a),Array.from(a).map(e=>e.toString(16).padStart(2,"0")).join("")),subject:d,issuer:f,notBefore:u,notAfter:p,signingAlgorithm:(s=e.keySettings,"ECDSA"===s.algorithm?{name:"ECDSA",hash:s.signingAlgorithm}:{name:"RSASSA-PKCS1-v1_5",hash:s.signingAlgorithm}),publicKey:l.publicKey,signingKey:h,extensions:c}),g=y.toString("pem"),m=y.rawData,{privateKeyPem:v,publicKeyPem:b,privateKeyBuffer:x}=await c8(l);return{success:!0,certificate:{certificate:g,privateKey:v,publicKey:b,certificateDer:m,privateKeyDer:x}}}catch(e){return console.error("Certificate generation error:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error occurred"}}}function c3(){let[e,t]=(0,eH.useState)("webServer"),[r,i]=(0,eH.useState)(t2),[s,n]=(0,eH.useState)(t4),[o,a]=(0,eH.useState)(t8),[l,c]=(0,eH.useState)([]),[u,p]=(0,eH.useState)(t5),[d,h]=(0,eH.useState)(t6),[f,y]=(0,eH.useState)(t3),[g,m]=(0,eH.useState)(!1),[v,b]=(0,eH.useState)({certificate:"",privateKey:"",passphrase:""}),[x,S]=(0,eH.useState)(t9),[w,_]=(0,eH.useState)(null),[A,C]=(0,eH.useState)(!1),[k,B]=(0,eH.useState)(null),[N,j]=(0,eH.useState)(!1),[E,O]=(0,eH.useState)("subject"),[I,T]=(0,eH.useState)(!1);(0,eH.useEffect)(()=>{localStorage.getItem("cert-generator-warning-seen")||T(!0)},[]);let P=(0,eH.useCallback)(()=>{T(!1),localStorage.setItem("cert-generator-warning-seen","true")},[]),D=(0,eH.useCallback)(e=>{t(e);let r=rt[e];p(r.keyUsage),h(r.extKeyUsage),y(r.caSettings),a(e=>({...e,days:r.validityDays})),r.rsaKeySize&&n(e=>({...e,rsaKeySize:r.rsaKeySize})),"wildcard"===e&&i(e=>({...e,commonName:e.commonName&&!e.commonName.startsWith("*.")?"*."+e.commonName:e.commonName})),"custom"===e&&(i(t2),n(t4),a(t8),c([]),m(!1),S(t9))},[]),U=(0,eH.useCallback)(()=>{c(e=>[...e,{type:"dns",value:""}])},[]),R=(0,eH.useCallback)(e=>{c(t=>t.filter((t,r)=>r!==e))},[]),V=(0,eH.useCallback)((e,t,r)=>{c(i=>{let s=[...i];return s[e]={...s[e],[t]:r},s})},[]),L=(0,eH.useCallback)(async(e,t)=>{try{await navigator.clipboard.writeText(e),B(t),setTimeout(()=>B(null),2e3),t1.toast.success("Copied to clipboard")}catch{t1.toast.error("Failed to copy")}},[]),M=(0,eH.useCallback)((e,t,r)=>{let i=new Blob([e],{type:r});(0,eF.saveAs)(i,t),t1.toast.success(`Downloaded ${t}`)},[]),H=(0,eH.useCallback)(async()=>{let e=ra(r);if(!e.valid)return void t1.toast.error(e.error);let t=rl(l);if(!t.valid)return void t1.toast.error(t.error);let i=rc(o);if(!i.valid)return void t1.toast.error(i.error);C(!0),_(null);let n=await c6({subject:r,keySettings:s,validity:o,sans:l,keyUsage:u,extKeyUsage:d,caSettings:f,useExistingCA:g,rootCAInput:v});n.success&&n.certificate?(_(n.certificate),t1.toast.success("Certificate generated successfully!")):t1.toast.error(n.error||"Failed to generate certificate"),C(!1)},[r,s,o,l,u,d,f,g,v]);return(0,eV.jsxs)("div",{className:"space-y-6",children:[(0,eV.jsx)(tG,{open:I,onOpenChange:T,children:(0,eV.jsxs)(tZ,{className:"sm:max-w-md border-amber-200 dark:border-amber-900",children:[(0,eV.jsxs)(tX,{children:[(0,eV.jsxs)(tQ,{className:"flex items-center gap-2 text-amber-800 dark:text-amber-200",children:[(0,eV.jsx)(eJ.default,{className:"h-5 w-5 text-amber-600 dark:text-amber-500"}),"Development/Testing Only"]}),(0,eV.jsx)(t0,{className:"text-amber-700 dark:text-amber-300 pt-2",children:"These certificates are self-signed and should only be used for development or testing. All cryptographic operations run locally in your browser - private keys never leave your device."})]}),(0,eV.jsx)("div",{className:"flex justify-end pt-4",children:(0,eV.jsx)(e1.Button,{onClick:P,className:"bg-amber-600 hover:bg-amber-700 text-white",children:"I Understand"})})]})}),(0,eV.jsxs)(e6.Card,{children:[(0,eV.jsx)(e6.CardHeader,{className:"pb-3",children:(0,eV.jsxs)(e6.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,eV.jsx)(eY,{className:"h-4 w-4"}),"Certificate Template"]})}),(0,eV.jsx)(e6.CardContent,{children:(0,eV.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-2",children:Object.entries(t7).map(([t,r])=>(0,eV.jsxs)("button",{onClick:()=>D(t),className:`p-3 rounded-lg border text-left transition-all ${e===t?"border-violet-500 bg-violet-50 dark:bg-violet-950/30":"border-zinc-200 dark:border-zinc-800 hover:border-zinc-300 dark:hover:border-zinc-700"}`,children:[(0,eV.jsx)("p",{className:"font-medium text-sm text-zinc-900 dark:text-zinc-100",children:r.label}),(0,eV.jsx)("p",{className:"text-xs text-zinc-500 dark:text-zinc-400 mt-0.5",children:r.description})]},t))})})]}),(0,eV.jsx)(e6.Card,{children:(0,eV.jsx)(e6.CardContent,{className:"p-0",children:(0,eV.jsxs)(e5.Tabs,{value:E,onValueChange:O,children:[(0,eV.jsx)("div",{className:"border-b border-zinc-200 dark:border-zinc-800 px-4",children:(0,eV.jsxs)(e5.TabsList,{className:"bg-transparent h-12 p-0 gap-4",children:[(0,eV.jsx)(e5.TabsTrigger,{value:"subject",className:"data-[state=active]:bg-transparent data-[state=active]:shadow-none border-b-2 border-transparent data-[state=active]:border-violet-500 rounded-none px-1",children:"Subject"}),(0,eV.jsx)(e5.TabsTrigger,{value:"technical",className:"data-[state=active]:bg-transparent data-[state=active]:shadow-none border-b-2 border-transparent data-[state=active]:border-violet-500 rounded-none px-1",children:"Technical"}),(0,eV.jsx)(e5.TabsTrigger,{value:"extensions",className:"data-[state=active]:bg-transparent data-[state=active]:shadow-none border-b-2 border-transparent data-[state=active]:border-violet-500 rounded-none px-1",children:"Extensions"}),(0,eV.jsx)(e5.TabsTrigger,{value:"ca",className:"data-[state=active]:bg-transparent data-[state=active]:shadow-none border-b-2 border-transparent data-[state=active]:border-violet-500 rounded-none px-1",children:"CA Options"}),(0,eV.jsx)(e5.TabsTrigger,{value:"output",className:"data-[state=active]:bg-transparent data-[state=active]:shadow-none border-b-2 border-transparent data-[state=active]:border-violet-500 rounded-none px-1",children:"Output"})]})}),(0,eV.jsxs)(e5.TabsContent,{value:"subject",className:"p-4 space-y-4 mt-0",children:[(0,eV.jsxs)("p",{className:"text-xs text-muted-foreground mb-2",children:["Fields marked with ",(0,eV.jsx)("span",{className:"text-destructive font-medium",children:"*"})," are required"]}),(0,eV.jsx)("div",{className:"space-y-4",children:(0,eV.jsxs)("h3",{className:"text-sm font-medium flex items-center justify-between",children:[(0,eV.jsx)("span",{children:"Subject Information"}),(0,eV.jsx)(e3.Badge,{variant:"destructive",className:"text-[10px]",children:"Required"})]})}),(0,eV.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(0,eV.jsxs)("div",{className:"md:col-span-2",children:[(0,eV.jsxs)(e4.Label,{htmlFor:"cn",className:"flex items-center gap-1",children:["Common Name (CN) ",(0,eV.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,eV.jsx)(e2.Input,{id:"cn",placeholder:"example.com or *.example.com",value:r.commonName,onChange:e=>i({...r,commonName:e.target.value}),className:"mt-1.5",required:!0}),(0,eV.jsx)("p",{className:"text-xs text-zinc-500 mt-1",children:"Primary domain or wildcard domain (required)"})]})}),(0,eV.jsx)("div",{className:"space-y-4 mt-6",children:(0,eV.jsxs)("h3",{className:"text-sm font-medium flex items-center justify-between",children:[(0,eV.jsx)("span",{children:"Organization Details"}),(0,eV.jsx)(e3.Badge,{variant:"secondary",className:"text-[10px]",children:"Optional"})]})}),(0,eV.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,eV.jsxs)("div",{children:[(0,eV.jsx)(e4.Label,{htmlFor:"org",className:"text-muted-foreground",children:"Organization (O)"}),(0,eV.jsx)(e2.Input,{id:"org",placeholder:"Company Name",value:r.organization,onChange:e=>i({...r,organization:e.target.value}),className:"mt-1.5"}),(0,eV.jsx)("p",{className:"text-xs text-zinc-500 mt-1",children:"Your company or organization name"})]}),(0,eV.jsxs)("div",{children:[(0,eV.jsx)(e4.Label,{htmlFor:"ou",className:"text-muted-foreground",children:"Organizational Unit (OU)"}),(0,eV.jsx)(e2.Input,{id:"ou",placeholder:"IT Department",value:r.organizationalUnit,onChange:e=>i({...r,organizationalUnit:e.target.value}),className:"mt-1.5"}),(0,eV.jsx)("p",{className:"text-xs text-zinc-500 mt-1",children:"Department or division"})]}),(0,eV.jsxs)("div",{children:[(0,eV.jsx)(e4.Label,{htmlFor:"country",className:"text-muted-foreground",children:"Country (C)"}),(0,eV.jsxs)(e8.Select,{value:r.country,onValueChange:e=>i({...r,country:e}),children:[(0,eV.jsx)(e8.SelectTrigger,{className:"mt-1.5 w-full",children:(0,eV.jsx)(e8.SelectValue,{placeholder:"Select country"})}),(0,eV.jsx)(e8.SelectContent,{children:re.map(e=>(0,eV.jsxs)(e8.SelectItem,{value:e.code,children:[e.code," - ",e.name]},e.code))})]}),(0,eV.jsx)("p",{className:"text-xs text-zinc-500 mt-1",children:"2-letter country code"})]}),(0,eV.jsxs)("div",{children:[(0,eV.jsx)(e4.Label,{htmlFor:"state",className:"text-muted-foreground",children:"State/Province (ST)"}),(0,eV.jsx)(e2.Input,{id:"state",placeholder:"California",value:r.state,onChange:e=>i({...r,state:e.target.value}),className:"mt-1.5"}),(0,eV.jsx)("p",{className:"text-xs text-zinc-500 mt-1",children:"State or province name"})]}),(0,eV.jsxs)("div",{children:[(0,eV.jsx)(e4.Label,{htmlFor:"locality",className:"text-muted-foreground",children:"Locality (L)"}),(0,eV.jsx)(e2.Input,{id:"locality",placeholder:"San Francisco",value:r.locality,onChange:e=>i({...r,locality:e.target.value}),className:"mt-1.5"}),(0,eV.jsx)("p",{className:"text-xs text-zinc-500 mt-1",children:"City or locality name"})]}),(0,eV.jsxs)("div",{children:[(0,eV.jsx)(e4.Label,{htmlFor:"email",className:"text-muted-foreground",children:"Email Address"}),(0,eV.jsx)(e2.Input,{id:"email",type:"email",placeholder:"admin@example.com",value:r.email,onChange:e=>i({...r,email:e.target.value}),className:"mt-1.5"}),(0,eV.jsx)("p",{className:"text-xs text-zinc-500 mt-1",children:"Contact email for the certificate"})]})]}),(0,eV.jsx)(e9.Separator,{className:"my-4"}),(0,eV.jsxs)("div",{children:[(0,eV.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,eV.jsxs)("div",{className:"flex items-center gap-2",children:[(0,eV.jsx)(e4.Label,{children:"Subject Alternative Names (SANs)"}),(0,eV.jsx)(e3.Badge,{variant:"secondary",className:"text-[10px]",children:"Optional"})]}),(0,eV.jsxs)(e1.Button,{variant:"outline",size:"sm",onClick:U,children:[(0,eV.jsx)(eq,{className:"h-4 w-4 mr-1"}),"Add SAN"]})]}),(0,eV.jsx)("p",{className:"text-xs text-zinc-500 mb-3",children:"Additional domains or IP addresses (recommended for modern browsers)"}),0===l.length?(0,eV.jsx)("p",{className:"text-sm text-zinc-500 italic",children:"No SANs configured"}):(0,eV.jsx)("div",{className:"space-y-2",children:l.map((e,t)=>(0,eV.jsxs)("div",{className:"flex items-center gap-2",children:[(0,eV.jsxs)(e8.Select,{value:e.type,onValueChange:e=>V(t,"type",e),children:[(0,eV.jsx)(e8.SelectTrigger,{className:"w-24",children:(0,eV.jsx)(e8.SelectValue,{})}),(0,eV.jsxs)(e8.SelectContent,{children:[(0,eV.jsx)(e8.SelectItem,{value:"dns",children:"DNS"}),(0,eV.jsx)(e8.SelectItem,{value:"ip",children:"IP"}),(0,eV.jsx)(e8.SelectItem,{value:"email",children:"Email"})]})]}),(0,eV.jsx)(e2.Input,{placeholder:"dns"===e.type?"www.example.com":"ip"===e.type?"192.168.1.1":"user@example.com",value:e.value,onChange:e=>V(t,"value",e.target.value),className:"flex-1"}),(0,eV.jsx)(e1.Button,{variant:"ghost",size:"icon",onClick:()=>R(t),className:"text-zinc-400 hover:text-red-500",children:(0,eV.jsx)(eG,{className:"h-4 w-4"})})]},t))})]})]}),(0,eV.jsxs)(e5.TabsContent,{value:"technical",className:"p-4 space-y-4 mt-0",children:[(0,eV.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,eV.jsxs)("h3",{className:"text-sm font-medium flex items-center justify-between",children:[(0,eV.jsx)("span",{children:"Key & Validity Settings"}),(0,eV.jsx)(e3.Badge,{variant:"destructive",className:"text-[10px]",children:"Required"})]}),(0,eV.jsx)("p",{className:"text-xs text-muted-foreground",children:"Configure cryptographic algorithm and certificate validity period"})]}),(0,eV.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,eV.jsxs)("div",{children:[(0,eV.jsxs)(e4.Label,{className:"flex items-center gap-1",children:["Key Algorithm ",(0,eV.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,eV.jsxs)(e8.Select,{value:s.algorithm,onValueChange:e=>n({...s,algorithm:e}),children:[(0,eV.jsx)(e8.SelectTrigger,{className:"mt-1.5 w-full",children:(0,eV.jsx)(e8.SelectValue,{})}),(0,eV.jsxs)(e8.SelectContent,{children:[(0,eV.jsx)(e8.SelectItem,{value:"RSA",children:"RSA"}),(0,eV.jsx)(e8.SelectItem,{value:"ECDSA",children:"ECDSA"})]})]})]}),"RSA"===s.algorithm?(0,eV.jsxs)("div",{children:[(0,eV.jsx)(e4.Label,{children:"RSA Key Size"}),(0,eV.jsxs)(e8.Select,{value:s.rsaKeySize,onValueChange:e=>n({...s,rsaKeySize:e}),children:[(0,eV.jsx)(e8.SelectTrigger,{className:"mt-1.5 w-full",children:(0,eV.jsx)(e8.SelectValue,{})}),(0,eV.jsxs)(e8.SelectContent,{children:[(0,eV.jsx)(e8.SelectItem,{value:"2048",children:"2048 bits"}),(0,eV.jsx)(e8.SelectItem,{value:"3072",children:"3072 bits"}),(0,eV.jsx)(e8.SelectItem,{value:"4096",children:"4096 bits"})]})]})]}):(0,eV.jsxs)("div",{children:[(0,eV.jsx)(e4.Label,{children:"ECDSA Curve"}),(0,eV.jsxs)(e8.Select,{value:s.ecdsaCurve,onValueChange:e=>n({...s,ecdsaCurve:e}),children:[(0,eV.jsx)(e8.SelectTrigger,{className:"mt-1.5 w-full",children:(0,eV.jsx)(e8.SelectValue,{})}),(0,eV.jsxs)(e8.SelectContent,{children:[(0,eV.jsx)(e8.SelectItem,{value:"P-256",children:"P-256 (secp256r1)"}),(0,eV.jsx)(e8.SelectItem,{value:"P-384",children:"P-384 (secp384r1)"}),(0,eV.jsx)(e8.SelectItem,{value:"P-521",children:"P-521 (secp521r1)"})]})]})]}),(0,eV.jsxs)("div",{children:[(0,eV.jsx)(e4.Label,{children:"Signing Algorithm"}),(0,eV.jsxs)(e8.Select,{value:s.signingAlgorithm,onValueChange:e=>n({...s,signingAlgorithm:e}),children:[(0,eV.jsx)(e8.SelectTrigger,{className:"mt-1.5 w-full",children:(0,eV.jsx)(e8.SelectValue,{})}),(0,eV.jsxs)(e8.SelectContent,{children:[(0,eV.jsx)(e8.SelectItem,{value:"SHA-256",children:"SHA-256"}),(0,eV.jsx)(e8.SelectItem,{value:"SHA-384",children:"SHA-384"}),(0,eV.jsx)(e8.SelectItem,{value:"SHA-512",children:"SHA-512"})]})]})]}),(0,eV.jsxs)("div",{children:[(0,eV.jsxs)(e4.Label,{className:"flex items-center gap-1",children:["Validity Period ",(0,eV.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,eV.jsxs)("div",{className:"flex items-center gap-2 mt-1.5",children:[(0,eV.jsx)(e2.Input,{type:"number",min:"1",max:"7300",value:o.days,onChange:e=>a({...o,days:parseInt(e.target.value)||365}),className:"w-24",disabled:o.useCustomDates}),(0,eV.jsx)("span",{className:"text-sm text-zinc-500",children:"days"})]})]})]}),(0,eV.jsxs)("div",{className:"flex items-center gap-2 mt-4",children:[(0,eV.jsx)("input",{type:"checkbox",id:"customDates",checked:o.useCustomDates,onChange:e=>a({...o,useCustomDates:e.target.checked}),className:"rounded border-zinc-300"}),(0,eV.jsx)(e4.Label,{htmlFor:"customDates",className:"text-sm cursor-pointer",children:"Use custom date range"})]}),o.useCustomDates&&(0,eV.jsxs)("div",{className:"grid grid-cols-2 gap-4 mt-2",children:[(0,eV.jsxs)("div",{children:[(0,eV.jsx)(e4.Label,{children:"Start Date"}),(0,eV.jsx)(e2.Input,{type:"date",value:o.customStartDate,onChange:e=>a({...o,customStartDate:e.target.value}),className:"mt-1.5"})]}),(0,eV.jsxs)("div",{children:[(0,eV.jsx)(e4.Label,{children:"End Date"}),(0,eV.jsx)(e2.Input,{type:"date",value:o.customEndDate,onChange:e=>a({...o,customEndDate:e.target.value}),className:"mt-1.5"})]})]})]}),(0,eV.jsxs)(e5.TabsContent,{value:"extensions",className:"p-4 space-y-4 mt-0",children:[(0,eV.jsx)("p",{className:"text-xs text-muted-foreground mb-2",children:"Extension fields are optional but recommended for specific use cases"}),(0,eV.jsxs)("div",{children:[(0,eV.jsxs)("div",{className:"flex items-center justify-between",children:[(0,eV.jsx)(e4.Label,{className:"text-base",children:"Key Usage"}),(0,eV.jsx)(e3.Badge,{variant:"secondary",className:"text-[10px]",children:"Optional"})]}),(0,eV.jsx)("p",{className:"text-xs text-zinc-500 mb-3",children:"Define how the certificate key can be used (pre-configured based on template)"}),(0,eV.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[{key:"digitalSignature",label:"Digital Signature"},{key:"keyEncipherment",label:"Key Encipherment"},{key:"dataEncipherment",label:"Data Encipherment"},{key:"keyAgreement",label:"Key Agreement"},{key:"keyCertSign",label:"Certificate Signing"},{key:"crlSign",label:"CRL Signing"}].map(e=>(0,eV.jsxs)("label",{className:"flex items-center gap-2 p-2 rounded border border-zinc-200 dark:border-zinc-800 cursor-pointer hover:bg-zinc-50 dark:hover:bg-zinc-900",children:[(0,eV.jsx)("input",{type:"checkbox",checked:u[e.key],onChange:t=>p({...u,[e.key]:t.target.checked}),className:"rounded border-zinc-300"}),(0,eV.jsx)("span",{className:"text-sm",children:e.label})]},e.key))})]}),(0,eV.jsx)(e9.Separator,{}),(0,eV.jsxs)("div",{children:[(0,eV.jsxs)("div",{className:"flex items-center justify-between",children:[(0,eV.jsx)(e4.Label,{className:"text-base",children:"Extended Key Usage"}),(0,eV.jsx)(e3.Badge,{variant:"secondary",className:"text-[10px]",children:"Optional"})]}),(0,eV.jsx)("p",{className:"text-xs text-zinc-500 mb-3",children:"Additional purposes for certificate usage (pre-configured based on template)"}),(0,eV.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[{key:"serverAuth",label:"Server Auth"},{key:"clientAuth",label:"Client Auth"},{key:"codeSigning",label:"Code Signing"},{key:"emailProtection",label:"Email Protection"}].map(e=>(0,eV.jsxs)("label",{className:"flex items-center gap-2 p-2 rounded border border-zinc-200 dark:border-zinc-800 cursor-pointer hover:bg-zinc-50 dark:hover:bg-zinc-900",children:[(0,eV.jsx)("input",{type:"checkbox",checked:d[e.key],onChange:t=>h({...d,[e.key]:t.target.checked}),className:"rounded border-zinc-300"}),(0,eV.jsx)("span",{className:"text-sm",children:e.label})]},e.key))})]})]}),(0,eV.jsxs)(e5.TabsContent,{value:"ca",className:"p-4 space-y-4 mt-0",children:[(0,eV.jsx)("p",{className:"text-xs text-muted-foreground mb-2",children:"CA options are optional and only needed for certificate authority setups"}),(0,eV.jsxs)("div",{className:"space-y-4",children:[(0,eV.jsxs)("div",{children:[(0,eV.jsxs)("div",{className:"flex items-center justify-between",children:[(0,eV.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,eV.jsx)("input",{type:"checkbox",checked:f.isCA,onChange:e=>y({...f,isCA:e.target.checked}),className:"rounded border-zinc-300"}),(0,eV.jsx)("span",{className:"font-medium",children:"This is a CA Certificate"})]}),(0,eV.jsx)(e3.Badge,{variant:"secondary",className:"text-[10px]",children:"Optional"})]}),(0,eV.jsx)("p",{className:"text-xs text-zinc-500 mt-1 ml-6",children:"Enable if this certificate will sign other certificates"})]}),f.isCA&&(0,eV.jsxs)("div",{className:"ml-6",children:[(0,eV.jsx)(e4.Label,{children:"Path Length Constraint"}),(0,eV.jsxs)(e8.Select,{value:f.pathLengthConstraint?.toString()??"unlimited",onValueChange:e=>y({...f,pathLengthConstraint:"unlimited"===e?null:parseInt(e)}),children:[(0,eV.jsx)(e8.SelectTrigger,{className:"mt-1.5 w-48",children:(0,eV.jsx)(e8.SelectValue,{})}),(0,eV.jsxs)(e8.SelectContent,{children:[(0,eV.jsx)(e8.SelectItem,{value:"unlimited",children:"Unlimited"}),(0,eV.jsx)(e8.SelectItem,{value:"0",children:"0 (Cannot issue sub-CAs)"}),(0,eV.jsx)(e8.SelectItem,{value:"1",children:"1"}),(0,eV.jsx)(e8.SelectItem,{value:"2",children:"2"})]})]}),(0,eV.jsx)("p",{className:"text-xs text-zinc-500 mt-1",children:"How many levels of sub-CAs can be created"})]})]}),(0,eV.jsx)(e9.Separator,{}),(0,eV.jsxs)("div",{className:"space-y-4",children:[(0,eV.jsxs)("div",{children:[(0,eV.jsxs)("div",{className:"flex items-center justify-between",children:[(0,eV.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,eV.jsx)("input",{type:"checkbox",checked:g,onChange:e=>m(e.target.checked),className:"rounded border-zinc-300"}),(0,eV.jsx)("span",{className:"font-medium",children:"Sign with existing Root CA"})]}),(0,eV.jsx)(e3.Badge,{variant:"secondary",className:"text-[10px]",children:"Optional"})]}),(0,eV.jsx)("p",{className:"text-xs text-zinc-500 mt-1 ml-6",children:"Upload an existing CA certificate and key to sign this certificate (leave unchecked for self-signed)"})]}),g&&(0,eV.jsxs)("div",{className:"ml-6 space-y-4 p-4 bg-zinc-50 dark:bg-zinc-900 rounded-lg",children:[(0,eV.jsxs)("div",{children:[(0,eV.jsx)(e4.Label,{children:"CA Certificate (PEM)"}),(0,eV.jsx)("textarea",{placeholder:"-----BEGIN CERTIFICATE----- ... -----END CERTIFICATE-----",value:v.certificate,onChange:e=>b({...v,certificate:e.target.value}),className:"mt-1.5 w-full h-32 px-3 py-2 text-sm font-mono border border-zinc-200 dark:border-zinc-800 rounded-md bg-white dark:bg-zinc-950 resize-none"})]}),(0,eV.jsxs)("div",{children:[(0,eV.jsx)(e4.Label,{children:"CA Private Key (PEM)"}),(0,eV.jsx)("textarea",{placeholder:"-----BEGIN PRIVATE KEY----- ... -----END PRIVATE KEY-----",value:v.privateKey,onChange:e=>b({...v,privateKey:e.target.value}),className:"mt-1.5 w-full h-32 px-3 py-2 text-sm font-mono border border-zinc-200 dark:border-zinc-800 rounded-md bg-white dark:bg-zinc-950 resize-none"})]}),(0,eV.jsxs)("div",{children:[(0,eV.jsx)(e4.Label,{children:"Private Key Passphrase (if encrypted)"}),(0,eV.jsxs)("div",{className:"relative mt-1.5",children:[(0,eV.jsx)(e2.Input,{type:N?"text":"password",placeholder:"Leave empty if not encrypted",value:v.passphrase,onChange:e=>b({...v,passphrase:e.target.value}),className:"pr-10"}),(0,eV.jsx)("button",{type:"button",onClick:()=>j(!N),className:"absolute right-3 top-1/2 -translate-y-1/2 text-zinc-400 hover:text-zinc-600",children:N?(0,eV.jsx)(e0,{className:"h-4 w-4"}):(0,eV.jsx)(eQ,{className:"h-4 w-4"})})]})]})]})]})]}),(0,eV.jsxs)(e5.TabsContent,{value:"output",className:"p-4 space-y-4 mt-0",children:[(0,eV.jsx)("p",{className:"text-xs text-muted-foreground mb-2",children:"Output format options (defaults are recommended for most use cases)"}),(0,eV.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,eV.jsxs)("div",{children:[(0,eV.jsxs)("div",{className:"flex items-center justify-between",children:[(0,eV.jsx)(e4.Label,{children:"Certificate Format"}),(0,eV.jsx)(e3.Badge,{variant:"secondary",className:"text-[10px]",children:"Optional"})]}),(0,eV.jsxs)(e8.Select,{value:x.certFormat,onValueChange:e=>S({...x,certFormat:e}),children:[(0,eV.jsx)(e8.SelectTrigger,{className:"mt-1.5 w-full",children:(0,eV.jsx)(e8.SelectValue,{})}),(0,eV.jsxs)(e8.SelectContent,{children:[(0,eV.jsx)(e8.SelectItem,{value:"pem",children:"PEM (Base64)"}),(0,eV.jsx)(e8.SelectItem,{value:"der",children:"DER (Binary)"})]})]})]}),(0,eV.jsxs)("div",{children:[(0,eV.jsxs)("div",{className:"flex items-center justify-between",children:[(0,eV.jsx)(e4.Label,{children:"Private Key Format"}),(0,eV.jsx)(e3.Badge,{variant:"secondary",className:"text-[10px]",children:"Optional"})]}),(0,eV.jsxs)(e8.Select,{value:x.keyFormat,onValueChange:e=>S({...x,keyFormat:e}),children:[(0,eV.jsx)(e8.SelectTrigger,{className:"mt-1.5 w-full",children:(0,eV.jsx)(e8.SelectValue,{})}),(0,eV.jsxs)(e8.SelectContent,{children:[(0,eV.jsx)(e8.SelectItem,{value:"pkcs8",children:"PKCS#8 (Recommended)"}),(0,eV.jsx)(e8.SelectItem,{value:"pkcs1",children:"PKCS#1 (Traditional)"})]})]})]})]}),(0,eV.jsxs)("div",{className:"flex items-center gap-2",children:[(0,eV.jsx)("input",{type:"checkbox",id:"includeChain",checked:x.includeChain,onChange:e=>S({...x,includeChain:e.target.checked}),className:"rounded border-zinc-300",disabled:!g}),(0,eV.jsx)(e4.Label,{htmlFor:"includeChain",className:`text-sm cursor-pointer ${!g?"opacity-50":""}`,children:"Include full certificate chain in output"})]})]})]})})}),(0,eV.jsx)("div",{className:"flex justify-center",children:(0,eV.jsx)(e1.Button,{onClick:H,disabled:A||!r.commonName,size:"lg",className:"bg-gradient-to-r from-violet-500 to-indigo-600 hover:from-violet-600 hover:to-indigo-700 text-white shadow-lg shadow-violet-500/25 px-8",children:A?(0,eV.jsxs)(eV.Fragment,{children:[(0,eV.jsx)("span",{className:"animate-spin mr-2",children:""}),"Generating..."]}):(0,eV.jsxs)(eV.Fragment,{children:[(0,eV.jsx)(eZ,{className:"mr-2 h-4 w-4"}),"Generate Certificate"]})})}),w&&(0,eV.jsxs)(e6.Card,{className:"border-green-200 dark:border-green-900",children:[(0,eV.jsx)(e6.CardHeader,{children:(0,eV.jsxs)(e6.CardTitle,{className:"text-base flex items-center gap-2 text-green-700 dark:text-green-400",children:[(0,eV.jsx)(eK.Check,{className:"h-5 w-5"}),"Certificate Generated Successfully"]})}),(0,eV.jsxs)(e6.CardContent,{className:"space-y-4",children:[(0,eV.jsxs)("div",{children:[(0,eV.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,eV.jsxs)(e4.Label,{className:"flex items-center gap-2",children:[(0,eV.jsx)(eX,{className:"h-4 w-4"}),"Certificate"]}),(0,eV.jsxs)("div",{className:"flex gap-2",children:[(0,eV.jsx)(e1.Button,{variant:"outline",size:"sm",onClick:()=>L(w.certificate,"cert"),children:"cert"===k?(0,eV.jsx)(eK.Check,{className:"h-4 w-4"}):(0,eV.jsx)(ez.Copy,{className:"h-4 w-4"})}),(0,eV.jsx)(e1.Button,{variant:"outline",size:"sm",onClick:()=>M("pem"===x.certFormat?w.certificate:w.certificateDer,`certificate.${"pem"===x.certFormat?"crt":"der"}`,"pem"===x.certFormat?"application/x-pem-file":"application/x-x509-ca-cert"),children:(0,eV.jsx)(e$.Download,{className:"h-4 w-4"})})]})]}),(0,eV.jsx)("pre",{className:"p-3 bg-zinc-100 dark:bg-zinc-900 rounded-lg text-xs font-mono overflow-x-auto max-h-40",children:w.certificate})]}),(0,eV.jsxs)("div",{children:[(0,eV.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,eV.jsxs)(e4.Label,{className:"flex items-center gap-2",children:[(0,eV.jsx)(eZ,{className:"h-4 w-4"}),"Private Key",(0,eV.jsx)(e3.Badge,{variant:"destructive",className:"text-[10px]",children:"Keep Secret"})]}),(0,eV.jsxs)("div",{className:"flex gap-2",children:[(0,eV.jsx)(e1.Button,{variant:"outline",size:"sm",onClick:()=>L(w.privateKey,"key"),children:"key"===k?(0,eV.jsx)(eK.Check,{className:"h-4 w-4"}):(0,eV.jsx)(ez.Copy,{className:"h-4 w-4"})}),(0,eV.jsx)(e1.Button,{variant:"outline",size:"sm",onClick:()=>M(w.privateKey,"private.key","application/x-pem-file"),children:(0,eV.jsx)(e$.Download,{className:"h-4 w-4"})})]})]}),(0,eV.jsx)("pre",{className:"p-3 bg-zinc-100 dark:bg-zinc-900 rounded-lg text-xs font-mono overflow-x-auto max-h-40",children:w.privateKey})]}),(0,eV.jsxs)("div",{children:[(0,eV.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,eV.jsxs)(e4.Label,{className:"flex items-center gap-2",children:[(0,eV.jsx)(eY,{className:"h-4 w-4"}),"Public Key"]}),(0,eV.jsxs)("div",{className:"flex gap-2",children:[(0,eV.jsx)(e1.Button,{variant:"outline",size:"sm",onClick:()=>L(w.publicKey,"pub"),children:"pub"===k?(0,eV.jsx)(eK.Check,{className:"h-4 w-4"}):(0,eV.jsx)(ez.Copy,{className:"h-4 w-4"})}),(0,eV.jsx)(e1.Button,{variant:"outline",size:"sm",onClick:()=>M(w.publicKey,"public.pem","application/x-pem-file"),children:(0,eV.jsx)(e$.Download,{className:"h-4 w-4"})})]})]}),(0,eV.jsx)("pre",{className:"p-3 bg-zinc-100 dark:bg-zinc-900 rounded-lg text-xs font-mono overflow-x-auto max-h-40",children:w.publicKey})]}),(0,eV.jsx)("div",{className:"flex justify-center pt-2",children:(0,eV.jsxs)(e1.Button,{onClick:()=>{M(w.certificate,"certificate.crt","application/x-pem-file"),setTimeout(()=>M(w.privateKey,"private.key","application/x-pem-file"),100),setTimeout(()=>M(w.publicKey,"public.pem","application/x-pem-file"),200)},variant:"outline",children:[(0,eV.jsx)(e$.Download,{className:"mr-2 h-4 w-4"}),"Download All Files"]})})]})]})]})}function c9(){return(0,eV.jsx)(eM.PageLayout,{toolId:"cert-generator",children:(0,eV.jsxs)("main",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-12 sm:py-16",children:[(0,eV.jsxs)("div",{className:"text-center mb-12",children:[(0,eV.jsxs)("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-violet-100 dark:bg-violet-900/30 text-violet-700 dark:text-violet-300 text-sm font-medium mb-4",children:[(0,eV.jsx)(eL.Sparkles,{className:"h-4 w-4"}),"Free & Secure"]}),(0,eV.jsxs)("h1",{className:"text-4xl sm:text-5xl font-bold text-zinc-900 dark:text-zinc-100 tracking-tight mb-4",children:["Generate",(0,eV.jsxs)("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-violet-500 to-indigo-600",children:[" ","TLS Certificates"]})]}),(0,eV.jsx)("p",{className:"text-lg text-zinc-600 dark:text-zinc-400 max-w-2xl mx-auto",children:"Create self-signed certificates for development and testing. Generate root CAs, server certificates, and client certificates with full X.509v3 support."})]}),(0,eV.jsx)(c3,{}),(0,eV.jsxs)("div",{className:"mt-16 grid grid-cols-1 sm:grid-cols-3 gap-6",children:[(0,eV.jsx)(c7,{title:"Full X.509v3 Support",description:"SANs, Key Usage, Extended Key Usage, Basic Constraints, and more"}),(0,eV.jsx)(c7,{title:"RSA & ECDSA",description:"Support for RSA (2048-4096 bit) and ECDSA (P-256, P-384, P-521) keys"}),(0,eV.jsx)(c7,{title:"100% Client-Side",description:"All cryptographic operations run locally. Private keys never leave your browser."})]})]})})}function c7({title:e,description:t}){return(0,eV.jsxs)("div",{className:"rounded-xl border border-zinc-200 dark:border-zinc-800 p-6 bg-white dark:bg-zinc-900/50",children:[(0,eV.jsx)("h3",{className:"font-semibold text-zinc-900 dark:text-zinc-100 mb-2",children:e}),(0,eV.jsx)("p",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:t})]})}(x=eR||(eR={}))[x.unspecified=0]="unspecified",x[x.keyCompromise=1]="keyCompromise",x[x.cACompromise=2]="cACompromise",x[x.affiliationChanged=3]="affiliationChanged",x[x.superseded=4]="superseded",x[x.cessationOfOperation=5]="cessationOfOperation",x[x.certificateHold=6]="certificateHold",x[x.removeFromCRL=8]="removeFromCRL",x[x.privilegeWithdrawn=9]="privilegeWithdrawn",x[x.aACompromise=10]="aACompromise",new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,cD.register(sI,cE),cD.register(s0,cO),cD.register(nr,cI),cD.register(nf,cT),cD.register(sj,cj),cD.register(nu,cP),cD.register(sW,cR),cD.register(sk,cV),cD.register(ne,cH),cK.register(a3,c$),cK.register(a9,cz),aH.registerSingleton(cW,class{toAsnSignature(e,t){return ru.BufferSourceConverter.toArrayBuffer(t)}toWebSignature(e,t){return ru.BufferSourceConverter.toArrayBuffer(t)}}),aH.registerSingleton(cW,cJ),cJ.namedCurveSize.set("P-256",32),cJ.namedCurveSize.set("K-256",32),cJ.namedCurveSize.set("P-384",48),cJ.namedCurveSize.set("P-521",66),e.s(["default",()=>c9],88598)}]);